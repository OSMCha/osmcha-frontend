{"version":3,"sources":["assets/banner.png","assets/work_flow.png","config/index.js","store/history.js","utils/safe_storage.js","config/constants.js","network/aoi.js","network/auth.js","network/status.js","network/changeset.js","network/osmcha_watchlist.js","store/modal_actions.js","network/osmcha_trustedlist.js","store/trustedlist_actions.js","store/watchlist_actions.js","utils/filters.js","network/changesets_page.js","utils/query_params.js","network/reasons_tags.js","store/aoi_actions.js","store/filters_actions.js","store/changesets_page_actions.js","config/notifications.js","utils/cmap.js","utils/routing.js","store/changeset_actions.js","store/auth_actions.js","store/auth_reducer.js","store/changesets_page_reducer.js","store/changeset_reducer.js","store/modal_reducer.js","store/filters_reducer.js","store/map_controls_actions.js","store/map_controls_reducer.js","store/trustedlist_reducer.js","store/blacklist_reducer.js","store/aoi_reducer.js","store/sagas.js","store/index.js","utils/analytics.js","utils/component.js","utils/create_popup.js","utils/dispatch_event.js","utils/element_in_view.js","utils/handle_popup_callback.js","utils/promise.js","utils/isMobile.js","components/changeset/floater.js","components/create_delete_modify.js","components/assembly_anchor.js","components/changeset/translate_button.js","components/reasons.js","components/changeset/property.js","components/changeset/property_list.js","components/changeset/details.js","hooks/UseIsUserListed.js","components/changeset/header.js","components/avatar.js","components/changeset/sign_in_button.js","components/button.js","components/dropdown.js","components/changeset/trust_watch_user.js","components/changeset/user_osm_link.js","components/changeset/user.js","components/loading.js","components/sign_in.js","views/map.js","components/changeset/features.js","components/open_all.js","components/expand_item_icon.js","components/changeset/tag_changes.js","components/changeset/other_features.js","components/changeset/geometry_changes.js","components/changeset/box.js","components/changeset/comment.js","components/changeset/discussions.js","components/changeset/map_options.js","components/changeset/control.js","config/bindings.js","components/changeset/control_layout.js","components/keyboard_enhancer.js","components/fetch_data_enhancer.js","network/openstreetmap.js","network/whosthat.js","components/changeset/index.js","views/changeset.js","views/about.js","views/stats.js","components/filters/radio.js","components/filters/text.js","components/filters/multi_select.js","network/nominatim.js","components/filters/location.js","components/filters/wrapper.js","components/filters/meta.js","components/filters/date.js","components/bbox_picker.js","components/loading_enhancer.js","components/filters/filters_list.js","components/filters/filters_header.js","views/filters.js","components/list/comments.js","components/list/secondary_line.js","components/list/primary_line.js","components/list/title.js","components/list/row.js","components/list/index.js","components/list/page_range.js","components/list/footer.js","components/list/header.js","utils/number_with_commas.js","components/changeset/tags.js","views/changesets_list.js","components/navbar.js","components/changeset/verify.js","components/changeset/open_in.js","views/navbar_changeset.js","views/navbar_sidebar.js","views/modal.js","components/user/details.js","views/user.js","components/secondary_pages_header.js","components/customURL.js","components/user/block_markup.js","views/saved_filters.js","components/user/watchlist_user.js","components/user/trustedlist_user.js","components/user/save_user.js","views/trusted_users.js","views/watchlist.js","network/mapping_team.js","components/teams/new_team.js","views/teams.js","views/edit_team.js","AppMobile.js","views/home.js","AppDesktop.js","app.js","index.js","serviceworker.js","assets/thumbs-up.svg","assets/thumbs-down.svg","components/user.jpg"],"names":["module","exports","isDev","process","isStaging","isProd","isLocal","url","window","debug_info","toString","API_URL","historyConfig","basename","history","createBrowserHistory","getItem","key","localStorage","err","console","warn","setItem","value","removeItem","mapboxAccessToken","enableRealChangesets","Boolean","osmchaSocialTokenUrl","osmchaUrl","replace","osmUrl","osmAuthUrl","apiOSM","nominatimUrl","REACT_APP_NOMINATIM_URL","getString","input","JSON","stringify","handleErrors","response","ok","json","then","r","status","Error","detail","statusText","Promise","reject","createAOI","token","name","filters","serverFilters","forEach","v","k","Iterable","isIterable","filter","x","get","map","join","fetch","method","headers","Authorization","body","res","fetchAOI","aoiId","fetchAllAOIs","resolve","updateAOI","deleteAOI","postFinalTokensOSMCha","oauth_token","oauth_token_secret","oauth_verifier","request","post","type","send","catch","e","error","postTokensOSMCha","fetchUserDetails","updateUserDetails","message_good","message_bad","comment_feature","getStatus","fetchChangeset","id","setHarmful","harmful","createForm","obj","formData","FormData","Object","keys","append","setTag","tag","remove","Number","isNaN","parseInt","tag_pk","postComment","comment","fetchWatchList","deleteFromWatchList","uid","postUserToWatchList","data","username","watchlist_user","watchModal","handleModal","modal","kind","title","dismiss","autoDismiss","position","description","callback","callbackArgs","callbackLabel","message","payload","action","takeEvery","uidOriginal","Date","getTime","Math","random","put","take","call","delay","deleteFromTrustedList","postUserToTrustedList","whitelist_user","watchTrustedlist","addToTrustedlistSaga","removeFromTrustedlistSaga","TRUSTEDLIST","tokenSelector","state","auth","addToTrustedlist","trustedlist_user","removeFromTrustedlist","all","select","watchWatchlist","addToWatchlistSaga","removeFromWatchlistSaga","WATCHLIST","addToWatchlist","removeFromWatchlist","validateFilters","Map","isMap","valid","List","isList","vv","has","test","getDefaultFromDate","extraDays","defaultDate","format","sub","days","fromJS","date__gte","label","appendDefaultDate","count","merge","now","getTimezoneOffset","minutes","date__lte","getDefaultToDate","fetchChangesetsPage","pageIndex","nocache","flatFilters","filterJoined","encodeURIComponent","getSearchObj","searchParam","result","parse","getObjAsQueryParam","length","fetchReasons","fetchTags","watchAOI","fetchAOISaga","createAOISaga","updateAOISaga","AOI","takeLatest","loading","reasons","tags","aoi","getIn","split","o","i","hasOwnProperty","SyntaxError","options","locationSelector","location","push","pathname","search","FILTERS","set","CHANGESETS_PAGE","routing","watchFilters","watchLocationChange","applyFilterSaga","filtersSaga","fetched","modify","checkNew","updateNewCount","checkNewLoading","apply","applyFilters","LOCATION_CHANGE","lastSearchString","lastTask","cancel","fork","toJS","toObject","filtersSelector","watchChangesetsPage","fetchChangesetsPageSaga","modifyChangesetPageSaga","checkForNewChangesetsSaga","getChangesetsPage","checkForNewChangesets","pageIndexSelector","changesetsPage","aoiIdSelector","oldPageIndex","thisPage","currentPageAndIndexSelector","changesetId","changeset","currentPage","features","index","findIndex","f","setIn","newData","oldData","diff","toSet","subtract","size","cmap","importChangesetMap","m","log","getParam","param","path","match","matchPath","params","getChangesetIdFromLocation","checkForLegacyURL","watchChangeset","shouldUpdateSaga","watchModifyChangeset","fetchChangesetAction","fetchChangesetMapAction","setHarmfulAction","setTagActions","CHANGESET","CHANGESET_MODIFY","CHANGESET_MAP","changesetTask","changesetMapTask","legacy","modifyAction","notifications","oldChangeset","newChangeset","changesetsSelector","changesets","changesetMapModule","getCMapData","osmApiBase","osmBase","overpassBase","isOSMApp","osmchaBase","changesetMapSelector","changesetMaps","changesetMap","existingTags","t","delete","watchUserDetails","watchAuth","logoutFlow","authTokenFlow","updateUserDetailsSaga","AUTH","getFinalToken","logUserOut","changesetIdSelector","delayPromise","delayBy","userDetails","trustedlist","watchlist","undefined","initialState","oAuthToken","oAuthTokenSecret","changesetsInitial","diffLoading","initial","errorChangeset","loadingChangesetMap","errorChangesetMap","duration","filtersInitial","MAPCONTROLS","updateStyle","style","mapControlsInitial","aoiInitial","rootSaga","reducers","combineReducers","mapControls","routerReducer","concat","item","sagaMiddleware","createSagaMiddleware","middlewares","routerMiddleware","appliedMiddlewares","applyMiddleware","persistedState","safeStorage","store","createStore","run","sagas","gaPageView","page","ReactGA","gaSendEvent","event","getDisplayName","WrappedComponent","displayName","createPopup","width","height","settings","innerWidth","innerHeight","popup","open","dispatchEvent","messageId","payLoad","target","CustomEvent","document","elementInViewport","element","rect","getBoundingClientRect","top","left","bottom","right","handlePopupCallback","rej","authComplete","creds","queryString","query","pair","decodeURIComponent","parseQueryString","cancelablePromise","promise","hasCanceled_","val","isCanceled","interval","setTimeout","isMobile","Floater","className","this","props","children","React","PureComponent","CreateDeleteModify","showZero","create","AssemblyAnchor","href","rel","TranslateButton","text","xlinkHref","Reasons","userFlag","underline","color","extraClass","Reason","Property","property","imageryMatch","sourceMatch","Array","isArray","PropertyList","limit","properties","entries","slice","Details","source","imagery","editor","metadata","urlRegex","RegExp","indexOf","propertiesObj","from","p","startsWith","useState","leftLimit","setLeftLimit","onClick","useIsUserListed","isInTrustedlist","setIsInTrustedlist","isInWatchlist","setIsInWatchlist","useEffect","user","Header","connect","watchlisted","userEditCount","toggleUser","date","destroy","dir","formatDistanceToNow","addSuffix","Avatar","loaded","setState","nextProps","Placeholder","background","alt","src","onLoad","handleImageLoaded","bind","onError","handleImageErrored","SignInButton","handleLoginClick","oAuthObj","extraClasses","getChangeset","Button","iconName","disabled","DropdownContent","isActive","handleClick","onChange","ourObj","isRemove","onRemove","newArray","multi","onAdd","toggleDropdown","styles","data-label","data-payload","checked","deletable","preventDefault","stopPropagation","_Dropdown","display","handleClickOutside","eventTypes","Dropdown","onClickOutside","TrustWatchUser","handleVerify","arr","handleVerifyClear","is_in_trustedlist","includes","UserOSMLink","userName","linkClasses","UserLink","Link","to","uids","getHarmfulObject","getLinkContent","User","UserDescriptionHTML","showdown","Converter","noHeaderId","simplifiedAutoLink","makeHtml","registrationDate","renderUidFilterLink","users","whosThat","dangerouslySetInnerHTML","__html","Loading","SignIn","currentChangesetMap","cMapRender","getMapInstance","selectFeature","emit","minDebounce","debounce","container","getElementById","render","max","disableSidebar","CMap","visible","ref","setRef","setDimensions","parentNode","instance","resize","mobile","onresize","prevProp","content","timeOut","visibility","transitionName","transitionAppearTimeout","transitionAppear","transitionEnterTimeout","transitionLeaveTimeout","Feature","changesetReasons","reason","contains","role","tabIndex","onFocus","charAt","Features","reviewedFeatures","feature","user_flag","osm_id","reviewedIds","featuresIds","find","OpenAll","setOpenAll","aria-checked","ExpandItemIcon","isOpen","verticalAlign","getFeatures","processFeatures","finalReport","analyzedFeatures","newVersion","oldVersion","oldVersionKeys","newVersionKeys","addedTags","deletedTags","changedValues","analyzeFeature","FeatureListItem","ChangeTitle","oldValue","newValue","ChangeItem","opened","setIsOpen","values","OrderedSet","last_space","lastIndexOf","aria-pressed","n","ChangeItemList","changes","openAll","change","TagChanges","changeReport","setChangeReport","newChangeReport","featureIDs","sort","ActionItem","OtherFeatures","changeType","GeometryChangesItem","node","way","relation","GeometryChanges","geometry","Box","pullDown","pullUp","bg","minHeight","CommentForm","success","postCommentPromise","handleSubmit","updateValue","userCommentedBefore","discussions","changesetIsHarmful","placeholder","clicked","Discussions","changesetAuthor","renderComments","MapOptions","actions","mapStyle","layerOptions","function","toggleSatellite","toggleStreet","toggleDark","toggleBing","toggleOsm","getLayerDropdownDisplay","filteredLayer","l","onLayerChange","layer","filterLayers","renderMap","bingStyle","version","sources","tiles","attribution","layers","minzoom","maxzoom","osmStyle","tileSize","defaultChecked","Control","active","FILTER_BINDING","bindings","HELP_BINDING","NEXT_CHANGESET","PREV_CHANGESET","REFRESH_CHANGESETS","CHANGESET_DETAILS_DETAILS","CHANGESET_DETAILS_SUSPICIOUS","CHANGESET_DETAILS_TAGS","CHANGESET_DETAILS_GEOMETRY_CHANGES","CHANGESET_DETAILS_OTHER_FEATURES","CHANGESET_DETAILS_DISCUSSIONS","CHANGESET_DETAILS_USER","CHANGESET_DETAILS_MAP","VERIFY_GOOD","VERIFY_BAD","VERIFY_CLEAR","OPEN_IN_JOSM","OPEN_IN_ID","OPEN_IN_OSM","OPEN_IN_LEVEL0","OPEN_IN_ACHAVI","OPEN_IN_HDYC","FILTER_BY_USER","ControlLayout","bindingsState","toggleDetails","toggleFeatures","toggleOtherFeatures","toggleGeometryChanges","toggleTags","toggleDiscussions","toggleMapOptions","marginTop","marginLeft","keyboardToggleEnhancer","exclusive","lastKeyStroke","toggleKey","prev","exclusiveKeyToggle","newBindingState","prevBindingValue","Mousetrap","b","unbind","withFetchDataSilent","dataToFetch","onUpdate","_initFetching","fetchedData","reloadData","initFetching","getUserDetails","fromOSM","u","accountCreated","account_created","img","display_name","fromOSMCha","r1","r2","getUsers","_Changeset","showFloaters","currentChangeset","osmInfo","changesetUsername","prevProps","getUserDetailsPromise","getWhosThatPromise","names","defaultProps","Changeset","filterChangesetsByUser","showChangeset","converter","ghCompatibleHeaderId","extensions","regex","setFlavor","setOption","About","about","cancellablePromise","markdown","DOMPurify","sanitize","Stats","Radio","onChangeLocal","Text","isValid","handleFormChange","validity","min","Component","MultiSelect","allToggle","getAsyncOptions","dataURL","d","for_changeset","sendData","processed","renderSelect","promptTextCreator","loadOptions","handleToggle","showAllToggle","MappingTeamMultiSelect","trusted","nominatimSearch","LocationSelect","queryType","lastSearch","queryTypeOptions","draw","clearBeforeDraw","mode","clearMap","changeMode","deleteAll","getSource","setData","getLayer","removeLayer","drawingUpdate","drawingData","getAll","updateMap","truncate","precision","coordinates","cb","geojson","tolerance","area","simplified_bounds","simplify","highQuality","handleQueryTypeChange","addSource","addLayer","paint","geom_bbox","bbox","fitBounds","padding","getGL","mapboxgl","accessToken","MapboxDraw","displayControlsDefault","controls","polygon","addControl","on","TypeError","simpleValue","zIndex","Wrapper","handleFocus","hasValue","Meta","handleChange","activeFilters","metaOf","replaceFiltersState","findCurrentValue","option","DateField","handleDateChange","isClearable","selected","placeholderText","dateFormat","minDate","maxDate","BBoxPicker","update","bounds","getBounds","s","getSouth","toFixed","w","getWest","getNorth","wsen","getEast","clearBbox","loadingEnhancer","filtersData","ignore","FiltersList","renderFilters","propsToSend","data_url","wrapperProps","range","gteValue","lteValue","today","fi","handleToggleAll","endsWith","SaveAOI","editing","onKeyDown","keyCode","aoiList","FiltersHeader","onAoiSelect","getAois","getAoisPromise","navigator","clipboard","writeText","dropdown","save_aoi","aoiName","renderFilterInfo","renderAoiLink","renderRssLink","handleClear","handleApply","noDateGte","Filters","toJSON","is","sendToAnalytics","category","loadAoiId","getAOIName","getAOIId","removeAOI","applyCreateAOI","applyUpdateAOI","NumberOfComments","SecondaryLine","thumbsDown","thumbsUp","PrimaryLine","Title","wasOpen","Row","inputRef","other","borderClass","backgroundClass","handleScroll","scrollIntoView","block","behavior","activeChangesetId","PageRange","_onClick","Footer","start","end","base","maxPageCount","ceil","Range","handleFilterOrderBy","reloadCurrentPage","valueData","filtersConfig","NavLink","activeStyle","fontWeight","cacheTagsData","ChangesetsList","checkUpdate","Infinity","goUpDownToChangeset","direction","nextFeature","mergedFilters","keySeq","first","toggleFilters","toggleHelp","Tags","allTags","tagsData","selectData","is_visible","handleChangesetModifyTag","defaultValue","Navbar","titleClassName","buttons","buttonsClassName","Verify","onClear","checkUser","isHarmful","maxWidth","flex","whiteSpace","overflow","textOverflow","openEditor","baseUrl","center","getCenter","zoom","getZoom","lat","lng","OpenIn","unshift","NavbarChangeset","handleChangesetModifyHarmful","isChecked","fontSize","NavbarSidebar","onUserMenuSelect","renderUserMenuOptions","disable","getOAuthToken","Modal","sendNotification","addNotification","level","dismissible","activateModalCallback","dismissModalCallback","addRef","EditUserDetails","onChangeMessageGood","onChangeMessageBad","applyUpdateUserDetails","isGood","renderGoodBadImg","userValues","onUserChange","avatar","alignSelf","SecondaryPagesHeader","CustomURL","BlockMarkup","SaveButton","onCreate","onSave","AOIsBlock","activeAoiId","removeAoi","class","ListFortified","TargetBlock","propsToPass","SaveComp","SavedFilters","addToWatchList","removeFromWatchList","addToTrustedList","removeFromTrustedList","createAOIPromise","WatchListUser","isValidUsername","isValidUid","verified","setUsername","setUid","fetchUsername","fetchUid","verifyInput","resp","alert","marginRight","TrustedListUser","SaveUser","showInput","forWatchlist","TrustedListBlock","TrustedUsers","trustedUsers","trustedList","sortBy","a","localeCompare","WatchListBlock","Watchlist","watchList","blacklist","createMappingTeam","deleteMappingTeam","updateMappingTeam","NewTeam","teamName","setTeamName","teamUsers","setTeamUsers","setEditing","validationErrorMessage","setValidationErrorMessage","activeTeam","joined","cleanedUsers","fromEntries","onChangeInput","idx","teamUsersToUpdate","required","userIsOwner","splice","onClickRemoveUser","validation","validateData","TeamsBlock","removeTeam","editTeam","MappingTeams","addingTeam","createTeam","createTeamPromise","teamId","teams","owner","EditMappingTeam","updateTeamPromise","team","AppMobile","Route","exact","component","Home","banner","work_flow","AppDesktop","App","hitType","initialize","trackingId","gaOptions","anonymizeIp","screenResolution","screen","availWidth","availHeight","appName","Raven","config","release","environment","debug","install","ReactDOM","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.09102ef8.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/banner.ed2bb0d2.png\";","module.exports = __webpack_public_path__ + \"static/media/work_flow.195ff4f9.png\";","// @flow\nexport const isDev = process.env.REACT_APP_STACK === 'DEV';\nexport const isStaging = process.env.REACT_APP_STACK === 'STAGING';\nexport const isProd = process.env.REACT_APP_STACK === 'PRODUCTION';\nexport const isLocal = process.env.NODE_ENV === 'development';\nexport const stack = process.env.REACT_APP_STACK;\nexport const appVersion = process.env.REACT_APP_VERSION;\n\nlet url =\n  process.env.REACT_APP_STAGING_API_URL || 'https://staging.osmcha.org/api/v1';\n\nif (isProd) {\n  url = process.env.REACT_APP_PRODUCTION_API_URL || 'https://osmcha.org/api/v1';\n}\n\nwindow.debug_info = () =>\n  `isDev=${isDev.toString()} isStaging=${isStaging.toString()} isProd=${isProd.toString()} isLocal=${isLocal.toString()} stack=${stack ||\n    'null'} appVersion=${appVersion || 'null'} url=${url}`;\n\nexport const API_URL = url;\n","import { createBrowserHistory } from 'history';\nimport { isDev } from '../config';\nlet historyConfig = {};\nif (isDev) {\n  historyConfig.basename = '/osmcha-frontend';\n}\n\nconst history = createBrowserHistory(historyConfig);\nexport { history };\n","// @flow\n\n// Transparent wrapper over Window.localStorage\n// Adheres to the Web Storage API:\n// https://developer.mozilla.org/en-US/docs/Web/API/Storage\n\n/**\n * Wraps localStorage.getItem in a try/catch. Return null\n * if the key does not exist or localStorage fails.\n */\nfunction getItem(key: string): ?string {\n  try {\n    return localStorage.getItem(key) || null;\n  } catch (err) {\n    console.warn('Could not read from localStorage.');\n    return null;\n  }\n}\n\n/**\n * Wraps localStorage.setItem in a try/catch.\n */\nfunction setItem(key: string, value: string): void {\n  try {\n    localStorage.setItem(key, value);\n  } catch (err) {\n    console.warn('Could not write to localStorage.');\n  }\n}\n\n/**\n * Wraps localStorage.removeItem in a try/catch.\n */\nfunction removeItem(key: string): void {\n  try {\n    localStorage.removeItem(key);\n  } catch (err) {\n    console.warn('Could not delete from localStorage.');\n  }\n}\n\nexport { getItem, setItem, removeItem };\n","//@flow\nimport { API_URL } from './';\n\nexport const PAGE_SIZE = process.env.REACT_APP_PAGE_SIZE || 25;\nexport const overpassBase =\n  process.env.REACT_APP_OVERPASS_BASE ||\n  '//overpass.osmcha.org/api/interpreter';\nexport const mapboxAccessToken =\n  process.env.REACT_APP_MAPBOX_ACCESS_TOKEN ||\n  'pk.eyJ1Ijoib3BlbnN0cmVldG1hcCIsImEiOiJjam10OXpmc2YwMXI5M3BqeTRiMDBqMHVyIn0.LIcIDe3TZLSDdTWDoojzNg';\nexport const statusUrl =\n  'https://raw.githubusercontent.com/mapbox/osmcha-frontend/status/status.json';\nexport const enableRealChangesets = process.env.REACT_APP_ENABLE_REAL_CHANGESETS\n  ? Boolean(process.env.REACT_APP_ENABLE_REAL_CHANGESETS)\n  : true;\n\nexport const osmchaSocialTokenUrl = `${API_URL}/social-auth/`;\nexport const osmchaUrl = API_URL.replace('api/v1', '');\n\nexport const osmUrl =\n  process.env.REACT_APP_OSM_URL || 'https://www.openstreetmap.org';\nexport const osmAuthUrl = `${osmUrl}/oauth/authorize`;\nexport const isOfficialOSM = osmUrl === 'https://www.openstreetmap.org';\nexport const apiOSM =\n  process.env.REACT_APP_OSM_API || 'https://api.openstreetmap.org/api/0.6';\n\nexport const whosThat =\n  'https://rksbsqdel4.execute-api.us-east-1.amazonaws.com/testing?action=names&id=';\n\nexport const nominatimUrl =\n  process.env.REACT_APP_NOMINATIM_URL ||\n  'https://nominatim.openstreetmap.org/search.php';\n\n// set a default from date x days before today\nexport const DEFAULT_FROM_DATE = process.env.REACT_APP_DEFAULT_FROM_DATE || 2;\n// exclude changesets newer than x minutes. It's needed because of the difference\n// between the time a changeset is processed by OSMCha and the time its map\n// visualization is available\nexport const DEFAULT_TO_DATE = process.env.REACT_APP_DEFAULT_TO_DATE || 5;\n","// @flow\nimport { Iterable } from 'immutable';\n\nimport { API_URL } from '../config';\nimport type { filtersType, filterType } from '../components/filters';\n\nexport function getString(input) {\n  if (typeof input === 'object') {\n    return JSON.stringify(input);\n  } else {\n    return input;\n  }\n}\n\nexport function handleErrors(response: Object) {\n  if (!response.ok) {\n    return response.json().then(r => {\n      if (response.status === 401) {\n        throw new Error(\n          'Authentication error. Sign in again and repeat the operation.'\n        );\n      }\n      if (response.status === 401) {\n        throw new Error('Operation not allowed.');\n      }\n      if (response.status === 404) {\n        throw new Error('Resource not found.');\n      }\n      if (r && r.detail) throw new Error(r.detail);\n      if (response.statusText) throw new Error(response.statusText);\n      return Promise.reject('network request failed');\n    });\n  }\n  return response;\n}\n\nexport function createAOI(\n  token: string,\n  name: string,\n  filters: filtersType\n): Promise<*> {\n  let serverFilters = {};\n  filters.forEach((v: filterType, k: string) => {\n    if (!Iterable.isIterable(v)) return;\n    let filter = v;\n    serverFilters[k] = filter\n      .filter(x => Iterable.isIterable(x) && x.get('value') !== '')\n      .map(x => getString(x.get('value')))\n      .join(',');\n  });\n  return fetch(`${API_URL}/aoi/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      name,\n      filters: serverFilters\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function fetchAOI(token: string, aoiId: number): Promise<*> {\n  return fetch(`${API_URL}/aoi/${aoiId}/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function fetchAllAOIs(token?: string): Promise<*> {\n  if (token == null) return Promise.resolve();\n  return fetch(`${API_URL}/aoi/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function updateAOI(\n  token: string,\n  aoiId: number,\n  name: string,\n  filters: filtersType\n): Promise<*> {\n  let serverFilters = {};\n  filters.forEach((v: filterType, k: string) => {\n    if (!Iterable.isIterable(v)) return;\n    let filter = v;\n    serverFilters[k] = filter\n      .filter(x => Iterable.isIterable(x) && x.get('value') !== '')\n      .map(x => getString(x.get('value')))\n      .join(',');\n  });\n  return fetch(`${API_URL}/aoi/${aoiId}/`, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      name,\n      filters: serverFilters\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function deleteAOI(token: string, aoiId: string): Promise<*> {\n  return fetch(`${API_URL}/aoi/${aoiId}/`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  }).then(handleErrors);\n}\n","// @flow\nimport request from 'superagent';\nimport { osmchaSocialTokenUrl } from '../config/constants';\nimport { API_URL } from '../config';\nimport { handleErrors } from './aoi';\n\nexport function postFinalTokensOSMCha(\n  oauth_token: string,\n  oauth_token_secret: string,\n  oauth_verifier: string\n) {\n  return request\n    .post(osmchaSocialTokenUrl)\n    .type('form')\n    .send({ oauth_token: oauth_token })\n    .send({ oauth_verifier: oauth_verifier })\n    .send({ oauth_token_secret: oauth_token_secret })\n    .then(r => {\n      return r.body;\n    })\n    .catch(e => {\n      console.error(e);\n      return Promise.reject(e);\n    });\n}\nexport function postTokensOSMCha() {\n  return request\n    .post(osmchaSocialTokenUrl)\n    .type('form')\n    .then(r => r.body)\n    .catch(e => {\n      console.error(e);\n      return Promise.reject(e);\n    });\n}\n\nexport function fetchUserDetails(token: string) {\n  return fetch(`${API_URL}/users/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function updateUserDetails(\n  token: string,\n  message_good: string,\n  message_bad: string,\n  comment_feature: boolean\n) {\n  return fetch(`${API_URL}/users/`, {\n    method: 'PATCH',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      message_good,\n      message_bad,\n      comment_feature\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import { statusUrl } from '../config/constants';\nimport { handleErrors } from './aoi';\n\nexport function getStatus(input, type): Promise<*> {\n  return fetch(`${statusUrl}`, {\n    method: 'GET'\n  })\n    .then(handleErrors)\n    .then(response => {\n      return response.json();\n    });\n}\n","// @flow\nimport { API_URL } from '../config';\nimport { handleErrors } from './aoi';\n\nexport function fetchChangeset(id: number, token: ?string) {\n  return fetch(`${API_URL}/changesets/${id}/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function setHarmful(id: number, token: string, harmful: boolean | -1) {\n  // -1 is for unsetting\n  let url;\n  if (harmful === -1) {\n    url = `${API_URL}/changesets/${id}/uncheck/`;\n  } else {\n    url = `${API_URL}/changesets/${id}/${\n      harmful ? 'set-harmful' : 'set-good'\n    }/`;\n  }\n\n  return fetch(url, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport const createForm = (obj: Object) => {\n  var formData = new FormData();\n  Object.keys(obj).forEach(k => {\n    formData.append(k, obj[k]);\n  });\n  return formData;\n};\n\nexport function setTag(\n  id: number,\n  token: string,\n  tag: Object,\n  remove: boolean = false\n) {\n  if (Number.isNaN(parseInt(tag.value, 10))) {\n    throw new Error('tag is not a valid number');\n  }\n  return fetch(`${API_URL}/changesets/${id}/tags/${tag.value}/`, {\n    method: remove ? 'DELETE' : 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: createForm({\n      tag_pk: tag,\n      id\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function postComment(id: number, token: string, comment: string) {\n  return fetch(`${API_URL}/changesets/${id}/comment/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      comment: comment\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","// @flow\nimport { handleErrors } from './aoi';\nimport { API_URL } from '../config';\n\nexport function fetchWatchList(token: string): Promise<*> {\n  return fetch(`${API_URL}/blacklisted-users/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function deleteFromWatchList(token: string, uid: string): Promise<*> {\n  return fetch(`${API_URL}/blacklisted-users/${uid}/`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  }).then(handleErrors);\n}\n\nexport function postUserToWatchList(token: string, data: object): Promise<*> {\n  return fetch(`${API_URL}/blacklisted-users/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      username: data.watchlist_user.username,\n      uid: data.watchlist_user.uid\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","// @flow\nimport { put, call, take, takeEvery } from 'redux-saga/effects';\nimport { delay } from 'redux-saga';\n\nexport const SHOW_MODAL = 'SHOW_MODAL';\nexport const INIT_MODAL = 'INIT_MODAL';\nexport const ACTIVATE_MODAL_CALLBACK = 'ACTIVATE_MODAL_CALLBACK';\nexport const DISMISS_MODAL = 'DISMISS_MODAL';\n\n// public\n// starting point for react component to start fetch\n\nexport function modal({\n  kind = 'error',\n  error,\n  title,\n  dismiss = true,\n  autoDismiss = 5,\n  position = 'tr',\n  description = 'Please reload the application. If it still doesnt work please refer to usage guide.',\n  callback,\n  callbackArgs,\n  callbackLabel\n}: {\n  kind?: string,\n  error?: Error,\n  title?: string,\n  dismiss?: boolean,\n  autoDismiss?: number,\n  position?: string,\n  description?: string,\n  callback?: Function,\n  callbackArgs?: Array<any>,\n  callbackLabel?: string\n}) {\n  if (error && error.message) {\n    description = error.message;\n  }\n  if (error && error.name) {\n    title = error.name;\n  }\n  if (kind === 'error') {\n    autoDismiss = 10;\n  }\n  return {\n    type: 'INIT_MODAL',\n    payload: {\n      kind,\n      error,\n      callbackLabel,\n      title,\n      dismiss,\n      autoDismiss,\n      position,\n      description\n    },\n    callback,\n    callbackArgs\n  };\n}\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const activateModalCallback = (uid: number) =>\n  action(ACTIVATE_MODAL_CALLBACK, { uid });\n\nexport const dismissModalCallback = (uid: number) =>\n  action(DISMISS_MODAL, { uid });\n\nexport function* watchModal(): any {\n  yield takeEvery('INIT_MODAL', handleModal);\n}\n\nfunction* handleModal({ payload, callback, callbackArgs }: Object): any {\n  var uidOriginal = new Date().getTime() + parseInt(1000 * Math.random(), 10);\n  payload.uid = uidOriginal;\n  yield put(action(SHOW_MODAL, payload));\n  if (!callback) return;\n  while (true) {\n    const { type, uid } = yield take([ACTIVATE_MODAL_CALLBACK, DISMISS_MODAL]);\n    if (type === DISMISS_MODAL && uidOriginal === uid) {\n      return;\n    }\n    if (type === ACTIVATE_MODAL_CALLBACK && uidOriginal === uid) {\n      yield call(delay, 500);\n      yield put(callback(...callbackArgs));\n      return;\n    }\n  }\n}\n","// @flow\nimport { handleErrors } from './aoi';\nimport { API_URL } from '../config';\n\nexport function fetchTrustedList(token: string): Promise<*> {\n  return fetch(`${API_URL}/whitelist-user/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function deleteFromTrustedList(\n  token: string,\n  username: string\n): Promise<*> {\n  return fetch(`${API_URL}/whitelist-user/${username}/`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  }).then(handleErrors);\n}\n\nexport function postUserToTrustedList(\n  token: string,\n  whitelist_user: string\n): Promise<*> {\n  return fetch(`${API_URL}/whitelist-user/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      whitelist_user\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import { all, put, call, takeEvery, select } from 'redux-saga/effects';\n\nimport {\n  postUserToTrustedList,\n  deleteFromTrustedList\n} from '../network/osmcha_trustedlist.js';\nimport { modal } from './modal_actions';\n\nimport type { RootStateType } from './';\n\nexport const TRUSTEDLIST = {\n  define: 'TRUSTEDLIST.define',\n  add: 'TRUSTEDLIST.add',\n  remove: 'TRUSTEDLIST.remove',\n  clear: 'TRUSTEDLIST.clear'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const tokenSelector = (state: RootStateType) => state.auth.get('token');\n\nexport const addToTrustedlist = (trustedlist_user: string) =>\n  action(TRUSTEDLIST.add, { trustedlist_user });\n\nexport const removeFromTrustedlist = (trustedlist_user: string) =>\n  action(TRUSTEDLIST.remove, { trustedlist_user });\n\nexport function* watchTrustedlist(): any {\n  yield all([\n    takeEvery(TRUSTEDLIST.add, addToTrustedlistSaga),\n    takeEvery(TRUSTEDLIST.remove, removeFromTrustedlistSaga)\n  ]);\n}\n\nexport function* addToTrustedlistSaga(trustedlist_user: string): any {\n  try {\n    const token = yield select(tokenSelector);\n    yield call(postUserToTrustedList, token, trustedlist_user.trustedlist_user);\n    yield put(\n      modal({\n        title: 'Success',\n        description: `User ${trustedlist_user.trustedlist_user} added to your Trusted Users list.`,\n        kind: 'success'\n      })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\nexport function* removeFromTrustedlistSaga(trustedlist_user: string): any {\n  try {\n    const token = yield select(tokenSelector);\n    yield call(deleteFromTrustedList, token, trustedlist_user.trustedlist_user);\n    yield put(\n      modal({\n        title: 'Success',\n        description: `User ${trustedlist_user.trustedlist_user} removed from your Trusted Users list.`,\n        kind: 'success'\n      })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\n","import { all, put, call, takeEvery, select } from 'redux-saga/effects';\n\nimport {\n  postUserToWatchList,\n  deleteFromWatchList\n} from '../network/osmcha_watchlist';\nimport { modal } from './modal_actions';\n\nimport type { RootStateType } from './';\n\nexport const WATCHLIST = {\n  define: 'WATCHLIST.define',\n  add: 'WATCHLIST.add',\n  remove: 'WATCHLIST.remove',\n  clear: 'WATCHLIST.clear'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const tokenSelector = (state: RootStateType) => state.auth.get('token');\n\nexport const addToWatchlist = (watchlist_user: string, uid: string) =>\n  action(WATCHLIST.add, { watchlist_user, uid });\n\nexport const removeFromWatchlist = (watchlist_user: string) =>\n  action(WATCHLIST.remove, { watchlist_user });\n\nexport function* watchWatchlist(): any {\n  yield all([\n    takeEvery(WATCHLIST.add, addToWatchlistSaga),\n    takeEvery(WATCHLIST.remove, removeFromWatchlistSaga)\n  ]);\n}\n\nexport function* addToWatchlistSaga(watchlist_user: object): any {\n  try {\n    const token = yield select(tokenSelector);\n    yield call(postUserToWatchList, token, watchlist_user);\n    yield put(\n      modal({\n        title: 'Success',\n        description: `User ${watchlist_user.watchlist_user.username} (${watchlist_user.watchlist_user.uid}) added to your watchlist.`,\n        kind: 'success'\n      })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\nexport function* removeFromWatchlistSaga(watchlist_user: string): any {\n  try {\n    const token = yield select(tokenSelector);\n    yield call(deleteFromWatchList, token, watchlist_user.watchlist_user);\n    yield put(\n      modal({\n        title: 'Success',\n        description: `User ${watchlist_user.watchlist_user} removed from your watchlist.`,\n        kind: 'success'\n      })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\n","// @flow\nimport { List, Map, fromJS } from 'immutable';\nimport { sub, format } from 'date-fns';\n\nimport { DEFAULT_FROM_DATE, DEFAULT_TO_DATE } from '../config/constants';\nimport type { filtersType } from '../components/filters';\n\nexport function validateFilters(filters: filtersType): boolean {\n  var test = function() {\n    if (!Map.isMap(filters)) return false;\n    let valid = true;\n    filters.forEach((v, k) => {\n      if (!List.isList(v)) {\n        // check for list\n        valid = false;\n      } else {\n        v.forEach(vv => {\n          if (!(Map.isMap(vv) && vv.has('label') && vv.has('value'))) {\n            valid = false;\n          }\n          if (!Map.isMap(vv)) {\n            valid = false;\n          }\n        });\n      }\n    });\n    return valid;\n  };\n  if (!test()) {\n    throw new Error('The filters that you applied were not correct.');\n  } else {\n    return true;\n  }\n}\n\nexport function getDefaultFromDate(extraDays = 0): filtersType {\n  const defaultDate = format(\n    sub(new Date(), { days: DEFAULT_FROM_DATE + extraDays }),\n    'yyyy-MM-dd'\n  );\n  return fromJS({\n    date__gte: [\n      {\n        label: defaultDate,\n        value: defaultDate\n      }\n    ]\n  });\n}\n\nexport function getDefaultToDate(): filtersType {\n  const now = new Date();\n  const defaultDate = format(\n    sub(new Date(now.getTime() + now.getTimezoneOffset() * 60 * 1000), {\n      minutes: DEFAULT_TO_DATE\n    }),\n    'yyyy-MM-dd HH:mm'\n  );\n  return fromJS({\n    date__lte: [\n      {\n        label: '',\n        value: defaultDate\n      }\n    ]\n  });\n}\n\nexport function appendDefaultDate(filters: filtersType) {\n  // Set From date to 2 days behind if there isn't a date query.\n  // In case of a users or uids query, set the From date to 30 days behind\n  if (filters && !filters.has('date__gte') && !filters.has('date__lte')) {\n    if (\n      filters.count() === 1 &&\n      (filters.has('users') || filters.has('uids'))\n    ) {\n      filters = filters.merge(getDefaultFromDate(28));\n    } else {\n      filters = filters.merge(getDefaultFromDate());\n    }\n  }\n  if (filters && !filters.has('date__lte')) {\n    filters = filters.merge(getDefaultToDate());\n  }\n  return filters;\n}\n","// @flow\nimport { Iterable, List, Map } from 'immutable';\nimport { API_URL } from '../config';\nimport { PAGE_SIZE } from '../config/constants';\nimport { appendDefaultDate } from '../utils/filters';\nimport { handleErrors, getString } from './aoi';\nimport type { filtersType } from '../components/filters';\n\nexport function fetchChangesetsPage(\n  pageIndex: number,\n  filters: filtersType = Map(),\n  token: ?string,\n  nocache: boolean,\n  aoiId: ?string\n) {\n  let flatFilters = '';\n  filters = appendDefaultDate(filters);\n  filters.forEach((v: List<Object>, k: string) => {\n    if (!Iterable.isIterable(v)) return;\n    let filter = v;\n    let filterJoined = filter\n      .filter(x => Iterable.isIterable(x) && x.get('value') !== '')\n      .map(x => getString(x.get('value')))\n      .join(',');\n\n    if (filterJoined === '') return;\n    flatFilters += `&${k}=${encodeURIComponent(filterJoined)}`;\n  });\n  let url = `${API_URL}/changesets/?${\n    nocache // for cache busting of this pattern /\\/changesets\\/#nocache\\?page=/\n      ? `page_size=${PAGE_SIZE}&page=${pageIndex + 1}`\n      : `page=${pageIndex + 1}&page_size=${PAGE_SIZE}`\n  }${flatFilters}`;\n  if (aoiId) {\n    url = `${API_URL}/aoi/${aoiId}/changesets/?${\n      nocache\n        ? `page_size=${PAGE_SIZE}&page=${pageIndex + 1}`\n        : `page=${pageIndex + 1}&page_size=${PAGE_SIZE}`\n    }`;\n  }\n  return fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  }).then(res => {\n    if (res.status === 401) {\n      return Promise.reject(\n        Error('Authentication error. Sign in again and repeat the operation.')\n      );\n    }\n    if (res.status === 403) {\n      return Promise.reject(Error('Operation not allowed.'));\n    }\n    if (res.status >= 400 && res.status < 600) {\n      return Promise.reject(\n        Error(\n          'Bad request. Please check your filters or your network connection.'\n        )\n      );\n    }\n    return res.json();\n  });\n}\n\nexport function fetchAOIChangesetPage(\n  pageIndex: number,\n  aoiId: string,\n  token: string\n) {\n  return fetch(\n    `${API_URL}/aoi/${aoiId}/changesets/?page_size=${PAGE_SIZE}&page=${pageIndex +\n      1}`,\n    {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: token ? `Token ${token}` : ''\n      }\n    }\n  )\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","// @flow\nimport { parse, stringify } from 'query-string';\nimport { fromJS, Map } from 'immutable';\n\nexport function getSearchObj(searchParam: string = ''): Map<string, *> {\n  let result = {};\n  try {\n    result = parse(searchParam);\n    if (result.filters) {\n      result.filters = JSON.parse(result.filters);\n    }\n  } catch (e) {\n    console.error(e);\n  } finally {\n    return fromJS(result);\n  }\n}\n\nexport function getObjAsQueryParam(key: string, obj: Object) {\n  if (!obj || Object.keys(obj).length === 0) {\n    return '';\n  }\n  return stringify({\n    [key]: JSON.stringify(obj)\n  });\n}\n","// @flow\nimport { API_URL } from '../config';\nimport { handleErrors } from './aoi';\n\nexport function fetchReasons(token: ?string) {\n  return fetch(`${API_URL}/suspicion-reasons/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function fetchTags(token: ?string) {\n  return fetch(`${API_URL}/tags/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","// @flow\nimport { put, call, select, all, takeLatest } from 'redux-saga/effects';\nimport { fromJS, Map } from 'immutable';\nimport { push } from 'react-router-redux';\n\nimport { fetchAOI, createAOI, updateAOI } from '../network/aoi';\nimport { fetchReasons, fetchTags } from '../network/reasons_tags';\nimport { validateFilters } from '../utils/filters';\nimport { CHANGESETS_PAGE, FILTERS } from './filters_actions';\nimport { tokenSelector } from './auth_actions';\nimport { modal } from './modal_actions';\nimport type { filtersType } from '../components/filters';\nimport type { RootStateType } from './';\n\nexport const AOI = {\n  fetch: 'AOI.fetch',\n  clear: 'AOI.clear',\n  fetched: 'AOI.fetched',\n  create: 'AOI.create',\n  update: 'AOI.update',\n  loading: 'AOI.loading',\n  error: 'AOI.error'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const applyUpdateAOI = (\n  aoiId: string,\n  name: string,\n  filters: filtersType\n) => action(AOI.update, { aoiId, name, filters });\n\nexport const applyCreateAOI = (name: string, filters: filtersType) =>\n  action(AOI.create, { name, filters });\n\nexport function* watchAOI(): any {\n  yield all([\n    takeLatest(AOI.update, updateAOISaga),\n    takeLatest(AOI.create, createAOISaga)\n  ]);\n}\n\nexport function* fetchAOISaga(aoiId: string): any {\n  yield put(action(AOI.loading, { loading: true }));\n  const token = yield select(tokenSelector);\n  const data = yield call(fetchAOI, token, aoiId);\n  const reasons = yield call(fetchReasons, token);\n  const tags = yield call(fetchTags, token);\n  const aoi = fromJS(data);\n  yield put(action(AOI.fetched, { aoi }));\n  let filters = aoi.getIn(['properties', 'filters'], Map());\n  filters = filters.map((v, k) => {\n    if (k === 'reasons') {\n      return fromJS(\n        v.split(',').map(o => ({\n          value: o,\n          label: reasons.filter(i => i.id === Number(o))[0]['name']\n        }))\n      );\n    }\n    if (k === 'tags') {\n      return fromJS(\n        v.split(',').map(o => ({\n          value: o,\n          label: tags.filter(i => i.id === Number(o))[0]['name']\n        }))\n      );\n    }\n    try {\n      if (JSON.parse(v) && JSON.parse(v).hasOwnProperty('coordinates')) {\n        return fromJS([\n          {\n            value: JSON.parse(v),\n            label: JSON.parse(v)\n          }\n        ]);\n      } else {\n        throw SyntaxError;\n      }\n    } catch (e) {\n      const options = v.split(',');\n      return fromJS(\n        options.map(o => ({\n          value: o,\n          label: o\n        }))\n      );\n    }\n  });\n  return filters;\n}\n\nexport function* createAOISaga({\n  name,\n  filters\n}: {\n  name: string,\n  filters: filtersType\n}): any {\n  try {\n    yield put(action(AOI.loading, { loading: true }));\n    const token = yield select(tokenSelector);\n    const data = yield call(createAOI, token, name, filters);\n    const aoi = fromJS(data);\n    yield put(action(AOI.fetched, { aoi }));\n    let location = yield select(locationSelector);\n    yield put(\n      push({\n        ...location,\n        pathname: location.pathname,\n        search: `aoi=${data.id}`\n      })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\n\nexport function* updateAOISaga({\n  aoiId,\n  name,\n  filters\n}: {\n  aoiId: string,\n  name: string,\n  filters: filtersType\n}): any {\n  try {\n    yield put(action(AOI.loading, { loading: true }));\n    const token = yield select(tokenSelector);\n    const data = yield call(updateAOI, token, aoiId, name, filters);\n    const aoi = fromJS(data);\n    yield put(action(AOI.fetched, { aoi }));\n    yield call(validateFilters, filters);\n    yield put(\n      action(FILTERS.set, {\n        filters\n      })\n    );\n    yield put(\n      action(CHANGESETS_PAGE.fetch, { pageIndex: 0, aoiId: aoiId, filters })\n    );\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\n\nexport const locationSelector = (state: RootStateType) =>\n  state.routing.location;\n","// @flow\nimport {\n  put,\n  call,\n  take,\n  fork,\n  select,\n  cancel,\n  all,\n  takeLatest\n} from 'redux-saga/effects';\nimport { LOCATION_CHANGE } from 'react-router-redux';\nimport { Map } from 'immutable';\nimport { push } from 'react-router-redux';\n\nimport { getSearchObj, getObjAsQueryParam } from '../utils/query_params';\nimport { validateFilters } from '../utils/filters';\nimport { fetchAOISaga, AOI } from './aoi_actions';\n\nimport { modal } from './modal_actions';\n\nimport type { RootStateType } from './';\nimport type { filtersType } from '../components/filters';\n\nexport const CHANGESETS_PAGE = {\n  fetch: 'CHANGESETS_PAGE_FETCH',\n  fetched: 'CHANGESETS_PAGE_FETCHED',\n  modify: 'CHANGESETS_PAGE_MODIFY_CHANGESET',\n  loading: 'CHANGESETS_PAGE_LOADING',\n  error: 'CHANGESETS_PAGE_ERROR',\n  checkNew: 'CHANGESETS_PAGE_CHECK_NEW_CHANGESETS',\n  updateNewCount: 'CHANGESETS_PAGE_UPDATE_NEW_COUNT',\n  checkNewLoading: 'CHANGESETS_PAGE_CHECK_NEW_LOADING'\n};\n\nexport const FILTERS = {\n  set: 'FILTERS_SET',\n  apply: 'FILTERS_APPLY'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const applyFilters = (filters: filtersType, pathname: ?string) =>\n  action(FILTERS.apply, { filters, pathname });\n\nexport function* watchFilters(): any {\n  yield all([\n    watchLocationChange(),\n    takeLatest(FILTERS.apply, applyFilterSaga)\n  ]);\n}\n\nexport function* watchLocationChange(): any {\n  let lastTask;\n  let lastSearchString;\n  while (true) {\n    const action = yield take(LOCATION_CHANGE);\n    const location = action.payload;\n\n    if (lastSearchString === location.search) {\n      continue;\n    }\n    lastSearchString = location.search;\n\n    if (lastTask) {\n      yield cancel(lastTask);\n    }\n    lastTask = yield fork(filtersSaga, location);\n  }\n}\n\nexport function* applyFilterSaga({\n  filters,\n  pathname\n}: {\n  filters: filtersType,\n  pathname: string\n}): any {\n  const search = getObjAsQueryParam('filters', filters.toJS());\n  let location = yield select(locationSelector);\n  // I could find one comment on `push(location)` in the readme\n  // ref: https://github.com/ReactTraining/react-router/tree/master/packages/react-router-redux\n  yield put(\n    push({\n      ...location,\n      pathname: pathname || location.pathname,\n      search // update the search\n    })\n  );\n}\n\nexport function* filtersSaga(location: Object): any {\n  try {\n    // the url can only contain two things `filters` or `aoiId`\n    let { filters, aoi: aoiId } = getSearchObj(location.search).toObject();\n\n    if (!filters) filters = Map();\n\n    if (aoiId) {\n      filters = yield call(fetchAOISaga, aoiId);\n    } else {\n      // if there is no active AOI in use\n      // we might want to clear so that other\n      // sagas continue using regular filters.\n      yield put(action(AOI.clear));\n    }\n    // NOTE! `validateFilters` will throw an Error if invalid\n    yield call(validateFilters, filters);\n    yield put(\n      action(FILTERS.set, {\n        filters\n      })\n    );\n    if (aoiId) {\n      yield put(\n        action(CHANGESETS_PAGE.fetch, { pageIndex: 0, filters, aoiId })\n      );\n    } else {\n      yield put(action(CHANGESETS_PAGE.fetch, { pageIndex: 0, filters }));\n    }\n  } catch (e) {\n    console.error(e);\n    const location = yield select(locationSelector);\n    location.search = '';\n    yield all([\n      put(\n        modal({\n          error: e\n        })\n      ),\n      put(push(location))\n    ]);\n  }\n}\n\nexport const locationSelector = (state: RootStateType) =>\n  state.routing.location;\n\n/** Sagas **/\n\nexport const filtersSelector = (state: RootStateType) =>\n  state.filters.get('filters');\n","// @flow\nimport { put, call, takeLatest, select, all } from 'redux-saga/effects';\nimport { delay } from 'redux-saga';\n\nimport { fromJS, List, Map } from 'immutable';\nimport { fetchChangesetsPage } from '../network/changesets_page';\nimport { filtersSelector } from './filters_actions';\n\nimport { modal } from './modal_actions';\n\nimport type { RootStateType } from './';\nimport type { filtersType } from '../components/filters';\n\nexport const CHANGESETS_PAGE = {\n  fetch: 'CHANGESETS_PAGE_FETCH',\n  fetched: 'CHANGESETS_PAGE_FETCHED',\n  modify: 'CHANGESETS_PAGE_MODIFY_CHANGESET',\n  loading: 'CHANGESETS_PAGE_LOADING',\n  error: 'CHANGESETS_PAGE_ERROR',\n  checkNew: 'CHANGESETS_PAGE_CHECK_NEW_CHANGESETS',\n  updateNewCount: 'CHANGESETS_PAGE_UPDATE_NEW_COUNT',\n  checkNewLoading: 'CHANGESETS_PAGE_CHECK_NEW_LOADING'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\n// public\n// starting point for react component to start fetch\nexport const getChangesetsPage = (pageIndex: number, nocache: boolean) =>\n  action(CHANGESETS_PAGE.fetch, { pageIndex, nocache });\n\n// this just checks for new changesets and updates the\n// `changesetsPage/diff` in the store.\n// @param nocache - to avoid cache busting.\nexport const checkForNewChangesets = (nocache: boolean) =>\n  action(CHANGESETS_PAGE.checkNew, { nocache });\n\nexport function* watchChangesetsPage(): any {\n  yield all([\n    takeLatest(CHANGESETS_PAGE.fetch, fetchChangesetsPageSaga),\n    takeLatest(CHANGESETS_PAGE.modify, modifyChangesetPageSaga),\n    takeLatest(CHANGESETS_PAGE.checkNew, checkForNewChangesetsSaga)\n  ]);\n}\n\nexport const locationSelector = (state: RootStateType) =>\n  state.routing.location;\n\n/** Sagas **/\n\nexport const pageIndexSelector = (state: RootStateType) => [\n  state.changesetsPage.getIn(['pageIndex'], 0)\n];\nexport const tokenSelector = (state: RootStateType) => state.auth.get('token');\n\nexport const aoiIdSelector = (state: RootStateType) =>\n  state.aoi.getIn(['aoi', 'id']);\n\nexport function* fetchChangesetsPageSaga({\n  pageIndex,\n  nocache,\n  filters,\n  aoiId\n}: {\n  pageIndex?: number,\n  nocache: boolean,\n  filters?: filtersType,\n  aoiId?: string\n}): Object {\n  if (!filters) {\n    filters = yield select(filtersSelector);\n  }\n  if (!aoiId) {\n    aoiId = yield select(aoiIdSelector);\n  }\n  let oldPageIndex: number = yield select(pageIndexSelector);\n\n  // checks both undefined and null\n  if (pageIndex == null) {\n    pageIndex = oldPageIndex;\n  }\n  yield put(\n    action(CHANGESETS_PAGE.loading, {\n      pageIndex\n    })\n  );\n  try {\n    let token = yield select(tokenSelector);\n    let thisPage;\n    if (aoiId) {\n      thisPage = yield call(\n        fetchChangesetsPage,\n        pageIndex,\n        filters,\n        token,\n        nocache,\n        aoiId\n      );\n    } else {\n      thisPage = yield call(\n        fetchChangesetsPage,\n        pageIndex,\n        filters,\n        token,\n        nocache\n      );\n    }\n    yield put(\n      action(CHANGESETS_PAGE.fetched, {\n        data: fromJS(thisPage),\n        pageIndex\n      })\n    );\n  } catch (error) {\n    yield put(\n      action(CHANGESETS_PAGE.error, {\n        pageIndex: oldPageIndex,\n        error\n      })\n    );\n    error.name = `Failed to load page ${pageIndex}`;\n    yield put(\n      modal({\n        error,\n        callback: action,\n        callbackLabel: 'Retry',\n        callbackArgs: [CHANGESETS_PAGE.fetch, { pageIndex }]\n      })\n    );\n  }\n}\n\nexport const currentPageAndIndexSelector = (state: RootStateType) => [\n  state.changesetsPage.getIn(['currentPage'], Map()),\n  state.changesetsPage.getIn(['pageIndex'], 0)\n];\n\nexport function* modifyChangesetPageSaga({\n  changesetId,\n  changeset\n}: Object): any {\n  try {\n    // try to modify the changeset inside the page\n    // to reflect any kind of changes in the changesetList\n    let [currentPage, pageIndex] = yield select(currentPageAndIndexSelector);\n\n    let features: List<Map<string, *>> = currentPage.get('features');\n\n    const index = features.findIndex(f => f.get('id') === changesetId);\n    if (index > -1) {\n      currentPage = currentPage.setIn(['features', index], changeset);\n      yield put(\n        action(CHANGESETS_PAGE.fetched, {\n          data: currentPage,\n          pageIndex\n        })\n      );\n      // check for new changesets\n      yield put(action(CHANGESETS_PAGE.checkNew));\n    }\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nexport function* checkForNewChangesetsSaga({\n  nocache\n}: {\n  nocache: boolean\n}): any {\n  try {\n    yield put(action(CHANGESETS_PAGE.checkNewLoading));\n    yield call(delay, 3000 + Math.random() * 2000);\n    const [\n      filters: filtersType,\n      pageIndex: number,\n      token,\n      aoiId\n    ] = yield select((state: RootStateType) => [\n      state.filters.get('filters'),\n      state.changesetsPage.get('pageIndex'),\n      state.auth.get('token'),\n      state.aoi.get('aoi').get('id')\n    ]);\n    let newData = yield call(\n      fetchChangesetsPage,\n      pageIndex,\n      filters,\n      token,\n      nocache,\n      aoiId\n    );\n    let oldData = yield select((state: RootStateType) =>\n      state.changesetsPage.get('currentPage')\n    );\n    let diff = 0;\n    if (oldData) {\n      newData = fromJS(newData.features.map(f => f.id)).toSet();\n      oldData = oldData\n        .get('features')\n        .map(f => f.get('id'))\n        .toSet();\n      diff = newData.subtract(oldData).size;\n    }\n    yield put(\n      action(CHANGESETS_PAGE.updateNewCount, {\n        diff\n      })\n    );\n  } catch (e) {\n    console.error(e);\n  }\n}\n","export default {\n  NOT_LOGGED_IN: {\n    kind: 'error',\n    title: 'Sign in required',\n    description: 'This action requires you to sign in first.'\n  },\n  MODIFY_SUCCESS: {\n    kind: 'success',\n    title: 'Successful',\n    autoDismiss: 2,\n    description: changesetId =>\n      `The changeset ${changesetId} was successfully modified.`\n  }\n};\n","// @flow\nlet cmap;\nexport function importChangesetMap(module: string): Promise<*> {\n  if (cmap) return Promise.resolve(cmap[module]);\n  return import('changeset-map')\n    .then(function(m) {\n      cmap = m;\n      return cmap[module];\n    })\n    .catch(function(err) {\n      console.error(err);\n      console.log('Failed to load module changeset-map');\n    });\n}\n","// @flow\nimport { matchPath } from 'react-router';\n\nexport function getParam(param: string, location: Object, path: string) {\n  const match = matchPath(location.pathname, path);\n  if (!match) return null;\n  return match.params[param];\n}\n\nexport function getChangesetIdFromLocation(location: Object) {\n  const changesetId = parseInt(getParam('id', location, '/changesets/:id'), 10);\n  if (!changesetId || Number.isNaN(changesetId)) {\n    return null;\n  }\n  return changesetId;\n}\n\nexport function checkForLegacyURL(location: Object) {\n  const changesetId = parseInt(getParam('id', location, '/:id'), 10);\n  if (!changesetId || Number.isNaN(changesetId)) {\n    return null;\n  }\n  return changesetId;\n}\n","// @flow\nimport { put, call, take, fork, select, cancel } from 'redux-saga/effects';\n\nimport { fromJS, Map, List } from 'immutable';\nimport { LOCATION_CHANGE, replace, push } from 'react-router-redux';\nimport notifications from '../config/notifications';\n\nimport { fetchChangeset, setHarmful, setTag } from '../network/changeset';\nimport { importChangesetMap } from '../utils/cmap';\nimport {\n  apiOSM,\n  osmUrl,\n  isOfficialOSM,\n  osmchaUrl,\n  overpassBase,\n  enableRealChangesets,\n  mapboxAccessToken\n} from '../config/constants';\n\nimport {\n  getChangesetIdFromLocation,\n  checkForLegacyURL\n} from '../utils/routing';\n\nimport type { RootStateType } from './';\nimport { modal } from './modal_actions';\n\nimport { CHANGESETS_PAGE } from './changesets_page_actions';\n\nexport const CHANGESET = {\n  fetch: 'CHANGESET.fetch',\n  fetched: 'CHANGESET.fetched',\n  change: 'CHANGESET.change',\n  loading: 'CHANGESET.loading',\n  error: 'CHANGESET.error'\n};\nexport const CHANGESET_MODIFY = {\n  modify: 'CHANGESET_MODIFY.modify',\n  harmful: 'CHANGESET_MODIFY.harmful',\n  revert: 'CHANGESET_MODIFY.revert',\n  tag: 'CHANGESET_MODIFY.tag'\n};\nexport const CHANGESET_MAP = {\n  fetched: 'CHANGESET_MAP.fetched',\n  loading: 'CHANGESET_MAP.loading',\n  change: 'CHANGESET_MAP.change',\n  error: 'CHANGESET_MAP.error'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\n// public\n// starting point for react component to start fetch\nexport const getChangeset = (changesetId: number) =>\n  action(CHANGESET.fetch, { changesetId });\n\nexport const handleChangesetModifyHarmful = (\n  changesetId: number,\n  changeset: Map<string, *>,\n  harmful: boolean | -1\n) =>\n  action(CHANGESET_MODIFY.harmful, {\n    oldChangeset: changeset,\n    changesetId,\n    harmful\n  });\n\nexport const handleChangesetModifyTag = (\n  changesetId: number,\n  changeset: Map<string, *>,\n  tag: Object,\n  remove: boolean\n) =>\n  action(CHANGESET_MODIFY.tag, {\n    oldChangeset: changeset,\n    changesetId,\n    tag,\n    remove\n  });\n\n// watches for LOCATION_CHANGE and only\n// dispatches the latest one to get changeset\n// and cMap details. It cancels the ongoign tasks\n// if route changes in between.\nexport function* watchChangeset(): any {\n  let changesetTask;\n  let changesetMapTask;\n  while (true) {\n    const { payload: location } = yield take(LOCATION_CHANGE);\n    const changesetId = yield call(shouldUpdateSaga, location);\n    if (changesetId) {\n      /**\n       *  cancel any existing changeset tasks,\n       *  even if it doesnt change to `changesets/:id`\n       *  we anway would like to suspend the ongoing task\n       *  to save resouces\n       */\n      if (changesetTask) yield cancel(changesetTask);\n      if (changesetMapTask) yield cancel(changesetMapTask);\n\n      changesetTask = yield fork(fetchChangesetAction, changesetId);\n      changesetMapTask = yield fork(fetchChangesetMapAction, changesetId);\n    }\n  }\n}\n\nexport function* shouldUpdateSaga(location: Object): any {\n  // checks for the old osmcha style urls\n  // eg osmcha.org/34354242 and redirects them\n  // to osmcha.org/changesets/3432434\n  const legacy = checkForLegacyURL(location);\n  if (legacy) {\n    yield put(\n      replace({\n        ...location,\n        pathname: '/changesets/' + legacy\n      })\n    );\n    return false;\n  }\n  let changesetId = getChangesetIdFromLocation(location);\n\n  if (!changesetId) return false;\n\n  let oldChangesetId = yield select(\n    (state: RootStateType) =>\n      !state.changeset.get('errorChangeset') &&\n      !state.changeset.get('errorChangesetMap') &&\n      state.changeset.get('changesetId')\n  );\n\n  if (oldChangesetId !== changesetId) {\n    return changesetId;\n  }\n}\n\nexport function* watchModifyChangeset(): any {\n  while (true) {\n    const modifyAction = yield take([\n      CHANGESET_MODIFY.harmful,\n      CHANGESET_MODIFY.tag\n    ]); // scope for multiple modify actions in future\n    const { token, username } = yield select((state: RootStateType) => ({\n      token: state.auth.get('token'),\n      username: state.auth.getIn(['userDetails', 'username'])\n    }));\n    if (!token) {\n      yield put(\n        modal({\n          ...notifications.NOT_LOGGED_IN\n        })\n      );\n      continue;\n    }\n    // all modify actions should have changesetId, oldChangeset\n    const { changesetId, oldChangeset } = modifyAction;\n\n    if (!oldChangeset) {\n      continue;\n    }\n    let newChangeset;\n    try {\n      switch (modifyAction.type) {\n        case CHANGESET_MODIFY.harmful: {\n          const harmful = modifyAction.harmful;\n          newChangeset = yield call(setHarmfulAction, {\n            changesetId,\n            oldChangeset,\n            token,\n            harmful,\n            username\n          });\n          break;\n        }\n        case CHANGESET_MODIFY.tag: {\n          const { tag, remove } = modifyAction;\n          newChangeset = yield call(setTagActions, {\n            changesetId,\n            oldChangeset,\n            token,\n            tag,\n            remove\n          });\n          break;\n        }\n        default: {\n          continue;\n        }\n      }\n    } catch (error) {\n      yield put(\n        action(CHANGESET_MODIFY.revert, {\n          changesetId,\n          changeset: oldChangeset\n        })\n      );\n      yield put(\n        modal({\n          error\n        })\n      );\n    }\n    // update the change in changeset list also aka changesetP\n    if (newChangeset) {\n      yield put(\n        action(CHANGESETS_PAGE.modify, {\n          changesetId,\n          changeset: newChangeset\n        })\n      );\n    }\n  }\n}\n\nexport const changesetsSelector = (state: RootStateType) => {\n  return state.changeset.getIn(['changesets'], Map());\n};\nexport const tokenSelector = (state: RootStateType) => state.auth.get('token');\nexport const locationSelector = (state: RootStateType) =>\n  state.routing.location;\n\n/** Sagas **/\nexport function* fetchChangesetAction(changesetId: number): Object {\n  let changesets = yield select(changesetsSelector);\n  let changeset = changesets.get(changesetId);\n  // check if the changeset already exists\n  // if it does! make it active and exit\n  if (changeset) {\n    yield put(\n      action(CHANGESET.change, {\n        changesetId\n      })\n    );\n    return;\n  }\n\n  yield put(\n    action(CHANGESET.loading, {\n      changesetId\n    })\n  );\n\n  try {\n    let token = yield select(tokenSelector);\n    changeset = yield call(fetchChangeset, changesetId, token);\n    yield put(\n      action(CHANGESET.fetched, {\n        data: fromJS(changeset),\n        changesetId\n      })\n    );\n  } catch (error) {\n    yield put(\n      action(CHANGESET.error, {\n        changesetId,\n        error\n      })\n    );\n    const location = yield select(locationSelector);\n    error.name = `Changeset:${changesetId} failed`;\n    yield put(\n      modal({\n        error,\n        callback: push,\n        callbackArgs: [location],\n        callbackLabel: 'Retry'\n      })\n    );\n  }\n}\n\nexport function changesetMapModule(changesetId: number): any {\n  return importChangesetMap('getChangeset').then((getCMapData: any) =>\n    getCMapData(changesetId, {\n      osmApiBase: apiOSM,\n      osmBase: osmUrl,\n      enableRealChangesets,\n      overpassBase,\n      mapboxAccessToken,\n      isOSMApp: isOfficialOSM,\n      osmchaBase: osmchaUrl\n    })\n  );\n}\nexport const changesetMapSelector = (state: RootStateType) =>\n  state.changeset.getIn(['changesetMap'], Map());\n\nexport function* fetchChangesetMapAction(changesetId: number): Object {\n  const changesetMaps = yield select(changesetMapSelector);\n  let changesetMap = changesetMaps.get(changesetId);\n\n  if (changesetMap) {\n    yield put(\n      action(CHANGESET_MAP.change, {\n        changesetId\n      })\n    );\n    return;\n  }\n  yield put(\n    action(CHANGESET_MAP.loading, {\n      changesetId\n    })\n  );\n  try {\n    changesetMap = yield call(changesetMapModule, changesetId);\n    yield put(\n      action(CHANGESET_MAP.fetched, {\n        data: changesetMap,\n        changesetId\n      })\n    );\n  } catch (error) {\n    yield put(\n      action(CHANGESET_MAP.error, {\n        changesetId,\n        error\n      })\n    );\n    const location = yield select(locationSelector);\n    error.name = `Changeset:${changesetId} Map failed`;\n    yield put(\n      modal({\n        error,\n        callback: push,\n        callbackArgs: [location],\n        callbackLabel: 'Retry'\n      })\n    );\n  }\n}\n\nexport function* setHarmfulAction({\n  changesetId,\n  oldChangeset,\n  token,\n  harmful,\n  username\n}: Object): any {\n  const newChangeset = oldChangeset\n    .setIn(['properties', 'check_user'], harmful === -1 ? null : username)\n    // .setIn(\n    //   ['properties', 'tags'],\n    //   harmful === -1 ? List() : oldChangeset.getIn(['properties', 'tags'])\n    // )\n    .setIn(['properties', 'checked'], harmful === -1 ? false : true)\n    .setIn(['properties', 'harmful'], harmful === -1 ? null : harmful);\n\n  // update changeset list\n  yield put(\n    action(CHANGESET_MODIFY.modify, {\n      changesetId,\n      changeset: newChangeset\n    })\n  );\n  yield call(setHarmful, changesetId, token, harmful);\n  return newChangeset;\n}\n\nexport function* setTagActions({\n  changesetId,\n  oldChangeset,\n  token,\n  tag,\n  remove\n}: Object): any {\n  if (oldChangeset.getIn(['properties', 'checked'])) {\n    // TOFIX also check for user\n    let newChangeset = oldChangeset;\n    let existingTags: List<*>;\n    if (remove) {\n      existingTags = oldChangeset.getIn(['properties', 'tags']);\n      let key;\n      existingTags.forEach((t, i) => {\n        if (t.get('id') === tag.value) {\n          key = i;\n        }\n      });\n      newChangeset = oldChangeset.setIn(\n        ['properties', 'tags'],\n        existingTags.delete(key)\n      );\n    } else {\n      // TOFIX consolidate the convention of backend using id and name\n      // and I using label and value.\n      existingTags = oldChangeset.getIn(['properties', 'tags']);\n      newChangeset = oldChangeset.setIn(\n        ['properties', 'tags'],\n        existingTags.push(new Map().set('id', tag.value).set('name', tag.label))\n      );\n    }\n\n    yield put(\n      action(CHANGESET_MODIFY.modify, {\n        changesetId,\n        changeset: newChangeset\n      })\n    );\n    yield call(setTag, changesetId, token, tag, remove);\n    return newChangeset;\n  } else {\n    throw new Error('Only allowed on checked changesets');\n  }\n}\n","// @flow\nimport { put, call, take, select, all, takeLatest } from 'redux-saga/effects';\nimport { delay as delayPromise } from 'redux-saga';\nimport { push } from 'react-router-redux';\nimport { fromJS } from 'immutable';\n\nimport {\n  postTokensOSMCha,\n  postFinalTokensOSMCha,\n  fetchUserDetails,\n  updateUserDetails\n} from '../network/auth';\nimport { getStatus } from '../network/status';\nimport { fetchChangeset } from '../network/changeset';\nimport { fetchWatchList } from '../network/osmcha_watchlist';\nimport { setItem, removeItem } from '../utils/safe_storage';\nimport { modal } from './modal_actions';\nimport { TRUSTEDLIST } from './trustedlist_actions';\nimport { WATCHLIST } from './watchlist_actions';\nimport { pageIndexSelector, CHANGESETS_PAGE } from './changesets_page_actions';\nimport { CHANGESET } from './changeset_actions';\n\nimport type { RootStateType } from './';\n\nexport const AUTH = {\n  postSocialToken: 'AUTH_POST_SOCIAL_TOKEN',\n  saveOAuth: 'AUTH_SAVE_OAUTH_OBJ',\n  getFinalToken: 'AUTH_GET_FINAL_TOKEN',\n  saveToken: 'AUTH_SAVE_TOKEN',\n  logout: 'AUTH_LOGOUT',\n  clearSession: 'AUTH_CLEAR_SESSION',\n  loginError: 'AUTH_LOGIN_ERROR',\n  userDetails: 'AUTH_USER_DETAILS',\n  clearUserDetails: 'AUTH_CLEAR_USER_DETAILS',\n  updateUserDetails: 'UPDATE_USER_DETAILS'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\n// public\n// starting point for react component to start fetch\nexport const getOAuthToken = () => action(AUTH.postSocialToken);\n\nexport const getFinalToken = (oauth_verifier: string) =>\n  action(AUTH.getFinalToken, { oauth_verifier });\n\nexport const logUserOut = () => action(AUTH.logout);\n\nexport const tokenSelector = (state: RootStateType) => state.auth.get('token');\n\nexport const locationSelector = (state: RootStateType) =>\n  state.routing.location;\n\nexport const changesetIdSelector = (state: RootStateType) =>\n  state.changeset.get('changesetId');\n\nconst delay = process.env.NODE_ENV === 'test' ? () => {} : delayPromise;\nconst DELAY = 1000;\n\nexport const applyUpdateUserDetails = (\n  message_good: string,\n  message_bad: string,\n  comment_feature: boolean\n) =>\n  action(AUTH.updateUserDetails, {\n    message_good,\n    message_bad,\n    comment_feature\n  });\n\nexport function* watchUserDetails(): any {\n  yield all([takeLatest(AUTH.updateUserDetails, updateUserDetailsSaga)]);\n}\n\nexport function* watchAuth(): any {\n  // get the token from localStorage.\n  // if it exists we just need to wait for\n  // logout action.\n  let delayBy = 1000;\n  let token = yield select(tokenSelector);\n\n  // wrapping it in a for loop allows us to\n  // pause or resume our auth workflow\n  // info: https://redux-saga.js.org/docs/advanced/NonBlockingCalls.html\n  while (true) {\n    try {\n      if (!token) {\n        token = yield call(authTokenFlow);\n      }\n      const userDetails = fromJS(yield call(fetchUserDetails, token));\n      const trustedlist = userDetails.get('whitelists');\n      const watchlist = fromJS(yield call(fetchWatchList, token));\n      const status = fromJS(yield call(getStatus));\n      yield put(action(TRUSTEDLIST.define, { trustedlist }));\n      yield put(action(WATCHLIST.define, { watchlist }));\n      yield put(action(AUTH.userDetails, { userDetails }));\n      let pageIndex = yield select(pageIndexSelector);\n      if (pageIndex) {\n        yield put(action(CHANGESETS_PAGE.fetch, { pageIndex }));\n      }\n      let changesetId = yield select(changesetIdSelector);\n      if (changesetId) {\n        let changeset = yield call(fetchChangeset, changesetId, token);\n        yield put(\n          action(CHANGESET.fetched, {\n            data: fromJS(changeset),\n            changesetId\n          })\n        );\n      }\n      // show status notification\n      if (status.get('status') !== 'success') {\n        yield put(\n          modal({\n            title: 'OSMCha Status',\n            description: status.get('message'),\n            kind: status.get('status'),\n            autoDismiss: 20,\n            position: 'bc'\n          })\n        );\n      }\n\n      yield take(AUTH.logout);\n      delayBy = DELAY;\n      token = undefined;\n      yield call(logoutFlow);\n      yield call(delay, delayBy);\n    } catch (error) {\n      console.log(error);\n      yield put(action(AUTH.loginError, error));\n      yield call(delay, delayBy / 2);\n      error.name = 'Error';\n      yield put(\n        modal({\n          error,\n          kind: 'warning'\n        })\n      );\n      yield take(AUTH.logout);\n      delayBy = 4 * delayBy;\n      token = undefined;\n      yield call(logoutFlow);\n      yield call(delay, delayBy);\n    }\n  }\n}\n\nexport function* logoutFlow(): any {\n  yield call(removeItem, 'token');\n  yield call(removeItem, 'oauth_token');\n  yield call(removeItem, 'oauth_token_secret');\n  yield put(action(AUTH.clearSession));\n  yield put(action(TRUSTEDLIST.clear));\n  // get CHANGESET_PAGE without user metadata\n  let pageIndex = yield select(pageIndexSelector);\n  if (pageIndex) {\n    yield put(action(CHANGESETS_PAGE.fetch, { pageIndex }));\n  }\n  yield put(action(AUTH.clearUserDetails));\n  let location = yield select(locationSelector);\n  yield put(\n    push({\n      ...location,\n      pathname: '/'\n    })\n  );\n}\n\nexport function* authTokenFlow(): any {\n  const { oauth_token, oauth_token_secret } = yield call(postTokensOSMCha);\n  yield put(\n    action(AUTH.saveOAuth, {\n      oauth_token,\n      oauth_token_secret\n    })\n  );\n  // yield take(ACTION) waits for the particular action\n  // to emit and resume the flow. next in action would\n  // be to wait for the action `GET_FINAL_TOKEN`\n  // and resume the flow\n  const { oauth_verifier } = yield take(AUTH.getFinalToken);\n  const { token } = yield call(\n    postFinalTokensOSMCha,\n    oauth_token,\n    oauth_token_secret,\n    oauth_verifier\n  );\n  if (!token || token === '') {\n    throw new Error('invalid token');\n  }\n  yield call(setItem, 'token', token);\n  yield call(setItem, 'oauth_token', oauth_token);\n  yield call(setItem, 'oauth_token_secret', oauth_token_secret);\n  yield put(\n    action(AUTH.saveToken, {\n      token,\n      oauth_verifier\n    })\n  );\n  return token;\n}\n\nexport function* updateUserDetailsSaga({\n  message_good,\n  message_bad,\n  comment_feature\n}: {\n  message_good: string,\n  message_bad: string,\n  comment_feature: boolean\n}): any {\n  try {\n    let token = yield select(tokenSelector);\n    if (token) {\n      const userDetails = fromJS(\n        yield call(\n          updateUserDetails,\n          token,\n          message_good,\n          message_bad,\n          comment_feature\n        )\n      );\n      yield put(action(AUTH.userDetails, { userDetails }));\n      yield put(\n        modal({\n          kind: 'success',\n          title: 'User updated',\n          description: 'Your user preferences were updated successfully'\n        })\n      );\n    }\n  } catch (e) {\n    console.error(e);\n    yield put(\n      modal({\n        error: e\n      })\n    );\n  }\n}\n","// @flow\nimport { Map, fromJS } from 'immutable';\nimport { AUTH } from './auth_actions';\n\nexport type AuthType = Map<\n  'oAuthToken' | 'oAuthTokenSecret' | 'error' | 'token' | 'userDetails',\n  any\n>;\n\nconst initialState: AuthType = fromJS({\n  oAuthToken: null,\n  oAuthTokenSecret: null,\n  error: null,\n  token: null,\n  userDetails: null\n});\n\nexport function authReducer(\n  state: AuthType = initialState,\n  action: Object\n): AuthType {\n  switch (action.type) {\n    case AUTH.saveOAuth: {\n      return state\n        .set('oAuthToken', action.oauth_token)\n        .set('oAuthTokenSecret', action.oauth_token_secret)\n        .set('error', null);\n    }\n    case AUTH.saveToken: {\n      return state.set('token', action.token).set('error', null);\n    }\n    case AUTH.clearSession: {\n      return fromJS({ error: state.get('error') }); // retain the error\n    }\n    case AUTH.loginError: {\n      return state.set('error', action.error);\n    }\n    case AUTH.userDetails: {\n      return state.set('userDetails', action.userDetails);\n    }\n    case AUTH.clearUserDetails: {\n      return state.set('userDetails', Map());\n    }\n    default:\n      return state;\n  }\n}\n","/* @flow */\nimport { Map, fromJS } from 'immutable';\n\nimport { CHANGESETS_PAGE } from './changesets_page_actions';\n\nexport type ChangesetsPageType = Map<\n  'currentPage' | 'pageIndex' | 'loading' | 'error' | 'diff' | 'diffLoading',\n  any\n>;\n\nconst changesetsInitial: ChangesetsPageType = fromJS({\n  pageIndex: 0,\n  currentPage: null,\n  loading: false,\n  error: null,\n  diff: 0, // difference between the number of changesets in cache and the currentPage.\n  diffLoading: false // indicator to show background update is going on.\n});\n\nexport function changesetsPageReducer(\n  state: ChangesetsPageType = changesetsInitial,\n  action: Object\n): ChangesetsPageType {\n  switch (action.type) {\n    case CHANGESETS_PAGE.updateNewCount: {\n      return state.set('diff', action.diff).set('diffLoading', false);\n    }\n    case CHANGESETS_PAGE.checkNewLoading: {\n      return state.set('diffLoading', true);\n    }\n    case CHANGESETS_PAGE.loading: {\n      return state\n        .set('pageIndex', action.pageIndex)\n        .set('loading', true)\n        .set('diff', 0)\n        .set('diffLoading', false)\n        .set('error', null);\n    }\n    case CHANGESETS_PAGE.fetched: {\n      return state\n        .set('currentPage', action.data)\n        .set('pageIndex', action.pageIndex)\n        .set('loading', false)\n        .set('error', null);\n    }\n    case CHANGESETS_PAGE.error: {\n      return state\n        .set('pageIndex', action.pageIndex)\n        .set('diff', 0)\n        .set('loading', false)\n        .set('error', action.error);\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","/* @flow */\nimport { Map, fromJS } from 'immutable';\n\nimport {\n  CHANGESET,\n  CHANGESET_MAP,\n  CHANGESET_MODIFY\n} from './changeset_actions';\n\nexport type ChangesetType = Map<\n  | 'changesets'\n  | 'changesetId' // of the currentChangeset\n  | 'loading'\n  | 'loadingChangesetMap'\n  | 'changesetMap'\n  | 'errorChangesetMap'\n  | 'errorChangeset',\n  any\n>;\n\nconst initial: ChangesetType = fromJS({\n  changesetId: null,\n  changesets: new Map(),\n  loading: false,\n  errorChangeset: null,\n  changesetMap: new Map(),\n  loadingChangesetMap: false,\n  errorChangesetMap: null\n});\n\nexport function changesetReducer(\n  state: ChangesetType = initial,\n  action: Object\n): ChangesetType {\n  switch (action.type) {\n    case CHANGESET.change: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('loading', false)\n        .set('errorChangeset', null)\n        .set('errorChangesetMap', null);\n    }\n    case CHANGESET.loading: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('loading', true)\n        .set('errorChangeset', null);\n    }\n    case CHANGESET.fetched: {\n      const changesets = state\n        .get('changesets')\n        .set(action.changesetId, action.data);\n      return state\n        .set('changesets', changesets)\n        .set('changesetId', action.changesetId)\n        .set('loading', false)\n        .set('errorChangeset', null);\n    }\n    case CHANGESET.error: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('loading', false)\n        .set('errorChangeset', action.error);\n    }\n    case CHANGESET_MAP.change: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('errorChangesetMap', null)\n        .set('loadingChangesetMap', false);\n    }\n    case CHANGESET_MAP.fetched: {\n      const changesetMap = state\n        .get('changesetMap')\n        .set(action.changesetId, action.data);\n      return state\n        .set('changesetMap', changesetMap)\n        .set('changesetId', action.changesetId)\n        .set('loadingChangesetMap', false)\n        .set('errorChangesetMap', null);\n    }\n    case CHANGESET_MAP.loading: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('loadingChangesetMap', true)\n        .set('errorChangesetMap', null);\n    }\n    case CHANGESET_MAP.error: {\n      return state\n        .set('changesetId', action.changesetId)\n        .set('loadingChangesetMap', false)\n        .set('errorChangesetMap', action.error);\n    }\n    case CHANGESET_MODIFY.modify: {\n      const changesets = state\n        .get('changesets')\n        .set(action.changesetId, action.changeset);\n      return state.set('changesets', changesets);\n    }\n    case CHANGESET_MODIFY.revert: {\n      const changesets = state\n        .get('changesets')\n        .set(action.changesetId, action.changeset);\n      return state\n        .set('changesets', changesets)\n        .set('errorChangeset', action.error);\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","// @flow\nimport { Map, fromJS } from 'immutable';\nimport { SHOW_MODAL } from './modal_actions';\n\nexport type ModalType = Map<\n  | 'error'\n  | 'kind'\n  | 'duration'\n  | 'title'\n  | 'description'\n  | 'callback'\n  | 'callbackLabel'\n  | 'dismiss'\n  | 'uid'\n  | 'autoDismiss'\n  | 'position',\n  any\n>; // osmcha uses this\n\nconst initialState: ModalType = fromJS({\n  error: null,\n  kind: null,\n  duration: null,\n  title: null,\n  dismiss: true,\n  autoDismiss: 5, // number\n  position: 'tr',\n  description: null,\n  uid: null // number\n});\n\nexport function modalReducer(\n  state: ModalType = initialState,\n  action: Object\n): ModalType {\n  switch (action.type) {\n    case SHOW_MODAL: {\n      return state\n        .set('kind', action.kind)\n        .set('error', action.error)\n        .set('callbackLabel', action.callbackLabel)\n        .set('title', action.title)\n        .set('dismiss', action.dismiss)\n        .set('uid', action.uid)\n        .set('autoDismiss', action.autoDismiss)\n        .set('position', action.position)\n        .set('description', action.description);\n    }\n    default:\n      return state;\n  }\n}\n","/* @flow */\nimport { Map, fromJS } from 'immutable';\n\nimport { FILTERS } from './filters_actions';\n\nexport type filtersReducerType = Map<\n  'loading' | 'error' | 'filters' | 'aoi',\n  any\n>;\n\nconst filtersInitial: filtersReducerType = fromJS({\n  filters: {},\n  aoi: {},\n  loading: false,\n  error: null\n});\n\nexport function filtersReducer(\n  state: filtersReducerType = filtersInitial,\n  action: Object\n): filtersReducerType {\n  switch (action.type) {\n    case FILTERS.set: {\n      return state.set('filters', action.filters).set('loading', false);\n    }\n    default:\n      return state;\n  }\n}\n","// @flow\n\nexport const MAPCONTROLS = {\n  setStyle: 'SET_STYLE'\n};\n\nexport function action(type: string, payload: ?Object) {\n  return { type, ...payload };\n}\n\nexport const updateStyle = (style: string) =>\n  action(MAPCONTROLS.setStyle, { style });\n","/* @flow */\nimport { Map, fromJS } from 'immutable';\n\nimport { MAPCONTROLS } from './map_controls_actions';\n\nexport type mapControlsReducerType = Map<'style', any>;\n\nconst mapControlsInitial: mapControlsReducerType = fromJS({\n  style: 'satellite'\n});\n\nexport function mapControlsReducer(\n  state: filtersReducerType = mapControlsInitial,\n  action: Object\n): mapControlsReducerType {\n  switch (action.type) {\n    case MAPCONTROLS.setStyle: {\n      return state.set('style', action.style);\n    }\n    default:\n      return state;\n  }\n}\n","import { Map, fromJS } from 'immutable';\nimport { TRUSTEDLIST } from './trustedlist_actions';\n\nexport type trustedlistReducerType = Map<'trustedlist', 'loading', any>;\n\nconst initialState: trustedlistReducerType = fromJS({\n  trustedlist: null,\n  loading: false\n});\n\nexport function trustedlistReducer(\n  state: trustedlistReducerType = initialState,\n  action: Object\n): WhitelistType {\n  switch (action.type) {\n    case TRUSTEDLIST.define: {\n      return state.set('trustedlist', action.trustedlist).set('loading', false);\n    }\n    case TRUSTEDLIST.add: {\n      return state\n        .set(\n          'trustedlist',\n          state.get('trustedlist').concat([action.trustedlist_user])\n        )\n        .set('loading', false);\n    }\n    case TRUSTEDLIST.remove: {\n      return state\n        .set(\n          'trustedlist',\n          state\n            .get('trustedlist')\n            .filter(item => item !== action.trustedlist_user)\n        )\n        .set('loading', false);\n    }\n    case TRUSTEDLIST.clear: {\n      return state.set('trustedlist', Map()).set('loading', false);\n    }\n    default:\n      return state;\n  }\n}\n","import { Map, List, fromJS } from 'immutable';\nimport { WATCHLIST } from './watchlist_actions';\n\nexport type watchlistReducerType = Map<'watchlist', 'loading', any>;\n\nconst initialState: watchlistReducerType = fromJS({\n  watchlist: List(),\n  loading: false\n});\n\nexport function watchlistReducer(\n  state: watchlistReducerType = initialState,\n  action: Object\n): WatchlistType {\n  switch (action.type) {\n    case WATCHLIST.define: {\n      return state.set('watchlist', action.watchlist).set('loading', false);\n    }\n    case WATCHLIST.add: {\n      return state\n        .set(\n          'watchlist',\n          state.get('watchlist').concat([fromJS(action.watchlist_user)])\n        )\n        .set('loading', false);\n    }\n    case WATCHLIST.remove: {\n      return state\n        .set(\n          'watchlist',\n          state\n            .get('watchlist')\n            .filter(item => item.get('uid') !== action.watchlist_user)\n        )\n        .set('loading', false);\n    }\n    case WATCHLIST.clear: {\n      return state.set('watchlist', Map()).set('loading', false);\n    }\n    default:\n      return state;\n  }\n}\n","/* @flow */\nimport { Map, fromJS } from 'immutable';\n\nimport { AOI } from './aoi_actions';\n\nexport type aoiReducerType = Map<'loading' | 'error' | 'aoi', any>;\n\nconst aoiInitial: aoiReducerType = fromJS({\n  aoi: {},\n  loading: false,\n  error: null\n});\n\nexport function aoiReducer(\n  state: aoiReducerType = aoiInitial,\n  action: Object\n): filtersReducerType {\n  switch (action.type) {\n    case AOI.loading: {\n      return state.set('loading', true);\n    }\n    case AOI.clear: {\n      return state\n        .set('aoi', Map())\n        .set('loading', false)\n        .set('error', null);\n    }\n    case AOI.fetched: {\n      return state\n        .set('loading', false)\n        .set('error', null)\n        .set('aoi', action.aoi);\n    }\n    default:\n      return state;\n  }\n}\n","import { all } from 'redux-saga/effects';\nimport { watchChangesetsPage } from './changesets_page_actions';\nimport { watchChangeset, watchModifyChangeset } from './changeset_actions';\nimport { watchAuth, watchUserDetails } from './auth_actions';\nimport { watchModal } from './modal_actions';\nimport { watchFilters } from './filters_actions';\nimport { watchTrustedlist } from './trustedlist_actions';\nimport { watchWatchlist } from './watchlist_actions';\nimport { watchAOI } from './aoi_actions';\n\nexport default function* rootSaga() {\n  yield all([\n    watchChangesetsPage(),\n    watchFilters(),\n    watchAOI(),\n    watchChangeset(),\n    watchAuth(),\n    watchUserDetails(),\n    watchModifyChangeset(),\n    watchModal(),\n    watchTrustedlist(),\n    watchWatchlist()\n  ]);\n}\n","// @flow\nimport { combineReducers, createStore, applyMiddleware } from 'redux';\nimport { Map } from 'immutable';\nimport { routerReducer, routerMiddleware } from 'react-router-redux';\nimport { history } from './history';\nimport createSagaMiddleware from 'redux-saga';\n\nimport * as safeStorage from '../utils/safe_storage';\n\n// Reducers\nimport { authReducer } from './auth_reducer';\nimport { changesetsPageReducer } from './changesets_page_reducer';\nimport { changesetReducer } from './changeset_reducer';\nimport { modalReducer } from './modal_reducer';\nimport { filtersReducer } from './filters_reducer';\nimport { mapControlsReducer } from './map_controls_reducer';\nimport { trustedlistReducer } from './trustedlist_reducer';\nimport { watchlistReducer } from './blacklist_reducer';\nimport { aoiReducer } from './aoi_reducer';\n\nimport type { ModalType } from './modal_reducer';\nimport type { ChangesetsPageType } from './changesets_page_reducer';\nimport type { ChangesetType } from './changeset_reducer';\nimport type { AuthType } from './auth_reducer';\nimport type { filtersReducerType } from './filters_reducer';\nimport type { mapControlsReducerType } from './map_controls_reducer';\nimport type { trustedlistReducerType } from './trustedlist_reducer';\nimport type { watchlistReducerType } from './blacklist_reducer';\n// Sagas\nimport sagas from './sagas';\n\nexport type RootStateType = {\n  auth: AuthType,\n  changesetsPage: ChangesetsPageType,\n  filters: filtersReducerType,\n  aoi: aoiReducerType,\n  changeset: ChangesetType,\n  modal: ModalType,\n  routing: Object,\n  trustedlist: trustedlistReducerType,\n  watchlist: watchlistReducerType,\n  mapControls: mapControlsReducerType\n};\n\n// Root reducer\nconst reducers = combineReducers({\n  changesetsPage: changesetsPageReducer,\n  changeset: changesetReducer,\n  filters: filtersReducer,\n  mapControls: mapControlsReducer,\n  aoi: aoiReducer,\n  routing: routerReducer,\n  auth: authReducer,\n  modal: modalReducer,\n  trustedlist: trustedlistReducer,\n  watchlist: watchlistReducer\n});\n\nconst sagaMiddleware = createSagaMiddleware();\n// Middlewares\nconst middlewares = [sagaMiddleware, routerMiddleware(history)];\n\nlet appliedMiddlewares = applyMiddleware(...middlewares);\nif (process.env.NODE_ENV !== 'production') {\n  // const { createLogger } = require('redux-logger');\n\n  // const logger = createLogger({\n  //   stateTransformer: state => {\n  //     let newState = {};\n\n  //     for (var i of Object.keys(state)) {\n  //       if (Iterable.isIterable(state[i])) {\n  //         newState[i] = state[i].toJS();\n  //       } else {\n  //         newState[i] = state[i];\n  //       }\n  //     }\n  //     return newState;\n  //   }\n  // });\n  // middlewares.push(logger);\n  const { composeWithDevTools } = require('redux-devtools-extension');\n  appliedMiddlewares = composeWithDevTools(appliedMiddlewares);\n}\n\n// Persisted state\nconst persistedState = {\n  auth: Map({\n    token: safeStorage.getItem('token'),\n    oAuthToken: safeStorage.getItem('oauth_token'),\n    oAuthTokenSecret: safeStorage.getItem('oauth_token_secret'),\n    error: null\n  })\n};\n\n// Store\nconst store = createStore(reducers, persistedState, appliedMiddlewares);\nsagaMiddleware.run(sagas);\n\nexport { store };\n","import ReactGA from 'react-ga4';\n\nimport { isProd } from '../config';\n\nexport function gaPageView(page: string) {\n  if (isProd) {\n    ReactGA.send(page);\n  }\n}\n\nexport function gaSendEvent(obj: Object) {\n  if (isProd) {\n    ReactGA.event(obj);\n  }\n}\n","// @flow\nexport function getDisplayName(WrappedComponent: Object): string {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n","export function createPopup(\n  title: string = 'Authentication',\n  location: string\n) {\n  const width = 500;\n  const height = 600;\n  const settings = [\n    ['width', width],\n    ['height', height],\n    ['left', window.innerWidth.width / 2 - width / 2],\n    ['top', window.innerHeight.height / 2 - height / 2]\n  ]\n    .map(x => x.join('='))\n    .join(',');\n\n  const popup = window.open('about:blank', title, settings);\n  if (!popup) return;\n  popup.location = location;\n}\n","export function dispatchEvent(\n  messageId: string,\n  payLoad: Object,\n  target: ?Object\n) {\n  const event = new CustomEvent(messageId, {\n    detail: payLoad\n  });\n  (target || document.body).dispatchEvent(event);\n}\n","// @flow\nexport function elementInViewport(element: HTMLElement) {\n  var rect = element.getBoundingClientRect();\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= window.innerHeight &&\n    rect.right <= window.innerWidth\n  );\n}\n","const parseQueryString = queryString => {\n  const query = {};\n  queryString.split('&').forEach(pair => {\n    const [key, value] = pair.split('=');\n    query[decodeURIComponent(key)] = decodeURIComponent(value) || null;\n  });\n\n  return query;\n};\n\nexport function handlePopupCallback() {\n  // TO-FIX what if it never resolves\n  return new Promise((res, rej) => {\n    window.authComplete = location => {\n      const queryString = location.split('?')[1];\n      const creds = parseQueryString(queryString);\n      delete window.authComplete;\n      return res(creds);\n    };\n  });\n}\n","// @flow\n// export type cancelablePromiseType = { promise: Promise<*>, cancel: () => any };\nexport function cancelablePromise(promise: Promise<*>) {\n  let hasCanceled_ = false;\n\n  const wrappedPromise = new Promise((resolve, reject) => {\n    promise\n      .then(val => (hasCanceled_ ? reject({ isCanceled: true }) : resolve(val)))\n      .catch(\n        error => (hasCanceled_ ? reject({ isCanceled: true }) : reject(error))\n      );\n  });\n\n  return {\n    promise: wrappedPromise,\n    cancel() {\n      hasCanceled_ = true;\n    }\n  };\n}\nfunction handleErrors(response) {\n  if (!response.ok) {\n    throw Error(response.statusText);\n  }\n  return response;\n}\n\nexport function cancelableFetchJSON(url: string, token?: string) {\n  if (token) {\n    return cancelablePromise(\n      fetch(url, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: token ? `Token ${token}` : ''\n        }\n      })\n        .then(handleErrors)\n        .then(res => {\n          return res.json();\n        })\n    );\n  } else {\n    return cancelablePromise(\n      fetch(url)\n        .then(handleErrors)\n        .then(res => {\n          return res.json();\n        })\n    );\n  }\n}\n\nexport function delayPromise(\n  interval: number\n): { promise: Promise<*>, cancel: () => any } {\n  return cancelablePromise(new Promise(res => setTimeout(res, interval)));\n}\n","// Very, very basic mobile detection.\nexport const isMobile = () => {\n  return window.innerWidth <= 800;\n};\n","import React from 'react';\n\nexport class Floater extends React.PureComponent {\n  render() {\n    return (\n      <div\n        className={`relative h-auto mt3 scroll-auto ${this.props.className}`}\n      >\n        <div\n          style={this.props.style}\n          className=\"fixed block flex-parent flex-parent--column pb12 flex-parent--center-cross \"\n        >\n          {this.props.children}\n        </div>\n      </div>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\n\nexport function CreateDeleteModify(props: Object) {\n  const showZero = props.showZero;\n  return (\n    <div\n      className={`flex-parent flex-parent--row flex-parent--wrap ${props.className}`}\n    >\n      {(props.create > -1 || showZero) &&\n        <div className=\"cmap-bg-create  color-white inline-block px6 txt-s txt-bold round unround-r\">\n          {props.create}\n        </div>}\n      {(props.modify > -1 || showZero) &&\n        <div className=\"cmap-bg-modify-old  color-white inline-block px6  txt-s txt-bold unround\">\n          {props.modify}\n        </div>}\n      {(props.delete > -1 || showZero) &&\n        <div className=\"cmap-bg-delete color-white inline-block px6 txt-s txt-bold round unround-l\">\n          {props.delete}\n        </div>}\n    </div>\n  );\n}\n\n// export function CreateDeleteModify(props: Object) {\n//   const showZero = props.showZero;\n//   return (\n//     <div\n//       className={`flex-parent flex-parent--row ${props.className} border border--gray-light border--1 round`}\n//     >\n//       <span className=\"mr6 flex-parent align-items--center\">\n//         <svg className=\"icon inline-block align-middle\">\n//           <use xlinkHref=\"#icon-plus-document\" />\n//         </svg>\n//         <span className=\"color-gray txt-bold \">{props.create}</span>\n//       </span>\n//       <span className=\"mr6 cmap-bg-modify-old flex-parent align-items--center\">\n//         <span className=\"color-white txt-bold \">{props.modify}</span>\n//       </span>\n//       <span className=\"mr6 flex-parent align-items--center\">\n//         <svg className=\"icon inline-block align-middle \">\n//           <use xlinkHref=\"#icon-trash\" />\n//         </svg>\n//         <span className=\"color-gray txt-bold \">{props.delete}</span>\n//       </span>\n//     </div>\n//   );\n// }\n","//@flow\nimport React from 'react';\n\nexport default function AssemblyAnchor({ url }: { url?: string }) {\n  return (\n    <a className=\"link\" href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n      {url}\n    </a>\n  );\n}\n","//@flow\nimport React from 'react';\n\nexport default function TranslateButton({ text }: { text: string }) {\n  return (\n    <a\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      title=\"Translate\"\n      href={`http://translate.google.com/#auto/en/${encodeURIComponent(text)}`}\n      className=\"btn btn--xs border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition pl12 pr6\"\n    >\n      Translate\n      <svg className=\"icon h18 w18 inline-block align-middle pb3 pl3\">\n        <use xlinkHref=\"#icon-share\" />\n      </svg>\n    </a>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { List } from 'immutable';\n\nexport function Reasons({\n  reasons,\n  userFlag,\n  underline,\n  color\n}: {\n  reasons: List<*>,\n  userFlag: string,\n  underline: boolean,\n  color: string\n}) {\n  const extraClass = underline ? 'txt-underline-dotted' : '';\n  return (\n    <span className=\"mb3\">\n      {reasons.map((r: Map<string, *>, k) => (\n        <Reason\n          key={k}\n          text={r.get('name')}\n          color={color}\n          extraClass={extraClass}\n        />\n      ))}\n      {userFlag && (\n        <Reason text={userFlag} color=\"purple\" extraClass={extraClass} />\n      )}\n    </span>\n  );\n}\n\nconst Reason = ({\n  text,\n  color,\n  extraClass\n}: {\n  text: string,\n  color: string,\n  extraClass: string\n}) => (\n  <span className=\"mr6\">\n    <span\n      className={`color-${color}-dark inline-block bg-${color}-faint px6 txt-s txt-bold ${extraClass}`}\n    >\n      {text}\n    </span>\n  </span>\n);\n","import React from 'react';\n\nconst Property = ({ property, value, imageryMatch, sourceMatch }) => {\n  return (\n    <div key={property} className=\"col\">\n      <strong\n        title={property}\n        className=\"wmax180 txt-s txt-uppercase txt-truncate\"\n      >\n        {property}\n      </strong>\n      <span className=\"wmax180 txt-break-word txt-s\">{value}</span>\n      {property === 'imagery' && (\n        <span>\n          <br />\n          {imageryMatch.map((e, k) => (\n            <a href={e} key={k} className=\"color-blue\">\n              {Array.isArray(\n                e.match(\n                  /^(?:https?:\\/\\/)?(?:[^@\\/\\n]+@)?(?:www\\.)?([^:\\/\\n]+)/gim\n                )\n              ) ? (\n                e.match(\n                  /^(?:https?:\\/\\/)?(?:[^@\\/\\n]+@)?(?:www\\.)?([^:\\/\\n]+)/gim\n                )[0]\n              ) : (\n                <svg className=\"icon h18 w18 inline-block align-middle \">\n                  <use xlinkHref=\"#icon-share\" />\n                </svg>\n              )}\n            </a>\n          ))}\n        </span>\n      )}\n      {property === 'source' && (\n        <span>\n          <br />\n          {sourceMatch.map((e, k) => (\n            <a\n              href={sourceMatch}\n              title={sourceMatch}\n              key={k}\n              className=\"color-blue\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              {Array.isArray(\n                e.match(\n                  /^(?:https?:\\/\\/)?(?:[^@\\/\\n]+@)?(?:www\\.)?([^:\\/\\n]+)/gim\n                )\n              ) ? (\n                e.match(\n                  /^(?:https?:\\/\\/)?(?:[^@\\/\\n]+@)?(?:www\\.)?([^:\\/\\n]+)/gim\n                )[0]\n              ) : (\n                <svg className=\"icon h18 w18 inline-block align-middle \">\n                  <use xlinkHref=\"#icon-share\" />\n                </svg>\n              )}\n            </a>\n          ))}\n        </span>\n      )}\n    </div>\n  );\n};\n\nexport default Property;\n","import React from 'react';\nimport Property from './property';\n\nconst PropertyList = ({ limit, properties, imageryMatch, sourceMatch }) => {\n  return Object.entries(properties)\n    .map(([property, value]) => (\n      <Property\n        key={property}\n        property={property}\n        value={value}\n        imageryMatch={imageryMatch}\n        sourceMatch={sourceMatch}\n      />\n    ))\n    .slice(limit, limit + 2);\n};\n\nexport default PropertyList;\n","// @flow\nimport React, { useState } from 'react';\nimport { Map } from 'immutable';\nimport AnchorifyText from 'react-anchorify-text';\nimport AssemblyAnchor from '../assembly_anchor';\nimport TranslateButton from './translate_button';\nimport { Reasons } from '../reasons';\nimport PropertyList from './property_list';\n\nexport function Details({\n  properties,\n  changesetId\n}: {\n  properties: Map<string, *>,\n  changesetId: number,\n  expanded?: boolean\n}) {\n  let source = properties.get('source');\n  let imagery = properties.get('imagery_used');\n  const editor = properties.get('editor');\n  const metadata = properties.get('metadata');\n  const reasons = properties.get('reasons');\n  const comment = properties.get('comment');\n\n  const urlRegex = new RegExp(\n    /(?:(?:https?|ftp|file):\\/\\/|www\\.|ftp\\.)(?:\\([-A-Z0-9+&@#\\/%=~_|$?!:,.]*\\)|[-A-Z0-9+&@#\\/%=~_|$?!:,.])*(?:\\([-A-Z0-9+&@#\\/%=~_|$?!:,.]*\\)|[A-Z0-9+&@#\\/%=~_|$])/gim\n  );\n\n  let sourceMatch = [];\n  if (source && source.indexOf('{switch:a,b,c}.') > -1) {\n    source = source.replace('{switch:a,b,c}.', '');\n  }\n  if (source && source.match(urlRegex)) {\n    sourceMatch = source.match(urlRegex);\n    source = source.replace(urlRegex, '');\n  }\n\n  let imageryMatch = [];\n  if (imagery && imagery.match(urlRegex)) {\n    imageryMatch = imagery.match(urlRegex);\n    imagery = imagery.replace(urlRegex, '');\n  }\n\n  let propertiesObj = {};\n  // As JOSM doesn't use the imagery field, change the order\n  // to make the source field visible in the first page\n  if (imagery === 'Not reported') {\n    propertiesObj = {\n      editor: editor,\n      source: source,\n      imagery: imagery\n    };\n  } else {\n    propertiesObj = {\n      editor: editor,\n      imagery: imagery,\n      source: source\n    };\n  }\n\n  Array.from(metadata, ([p, v]) => {\n    if (\n      !p.startsWith('ideditor') &&\n      !p.startsWith('resolved') &&\n      !p.startsWith('warnings')\n    ) {\n      propertiesObj[p] = v;\n    }\n  });\n\n  const size = Object.keys(propertiesObj).length;\n  const [leftLimit, setLeftLimit] = useState(0);\n\n  return (\n    <div>\n      <div className=\"flex-parent flex-parent--column flex-parent--start flex-parent--wrap py12\">\n        <div className=\"flex-parent flex-parent--row flex-parent--wrap mb3\">\n          <p\n            className={`flex-child txt-subhead txt-l txt-break-url ${\n              !comment ? 'color-gray txt-em' : ''\n            }`}\n          >\n            <AnchorifyText\n              text={\n                comment ? comment : `${changesetId} does not have a comment.`\n              }\n            >\n              <AssemblyAnchor />\n            </AnchorifyText>\n          </p>\n        </div>\n        <div className=\"flex-parent\">\n          <TranslateButton text={comment} />\n        </div>\n      </div>\n      <div className=\"flex-parent flex-parent--column flex-parent--start flex-parent--wrap \">\n        <Reasons reasons={reasons} color=\"blue\" />\n      </div>\n      <div className=\"grid pt12 pb6\">\n        {leftLimit > 0 && (\n          <button\n            className=\"wmax12 mr6\"\n            onClick={() => setLeftLimit(leftLimit - 2)}\n            title=\"Previous changeset properties\"\n          >\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-chevron-left\" />\n            </svg>\n          </button>\n        )}\n        <PropertyList\n          properties={propertiesObj}\n          limit={leftLimit}\n          imageryMatch={imageryMatch}\n          sourceMatch={sourceMatch}\n        />\n        {leftLimit + 2 < size && (\n          <button\n            className=\"wmax12 ml6\"\n            onClick={() => setLeftLimit(leftLimit + 2)}\n            title=\"Next changeset properties\"\n          >\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-chevron-right\" />\n            </svg>\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from 'react';\n\nexport const useIsUserListed = (username, uid, trustedlist, watchlist) => {\n  const [isInTrustedlist, setIsInTrustedlist] = useState(false);\n  const [isInWatchlist, setIsInWatchlist] = useState(false);\n\n  useEffect(() => {\n    try {\n      setIsInTrustedlist(trustedlist.indexOf(username) !== -1);\n    } catch (e) {\n      setIsInTrustedlist(false);\n    }\n    try {\n      setIsInWatchlist(\n        watchlist.map(user => user.get('uid')).indexOf(uid) !== -1\n      );\n    } catch (e) {\n      setIsInWatchlist(false);\n    }\n  }, [username, uid, watchlist, trustedlist]);\n\n  return [isInTrustedlist, isInWatchlist];\n};\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\nimport { formatDistanceToNow, parse } from 'date-fns';\n\nimport { CreateDeleteModify } from '../create_delete_modify';\nimport { Details } from './details';\nimport { useIsUserListed } from '../../hooks/UseIsUserListed';\n\ntype propsType = {|\n  properties: Map<string, *>,\n  changesetId: number,\n  userEditCount: number,\n  toggleUser: () => mixed,\n  trustedlist: Map<string, *>,\n  watchlisted: Map<object, *>\n|};\n\nfunction HeaderComponent({\n  properties,\n  changesetId,\n  userEditCount,\n  toggleUser,\n  trustedlist,\n  watchlisted\n}: propsType) {\n  const user = properties.get('user');\n  const date = parse(\n    properties.get('date'),\n    // eslint-disable-next-line\n    \"yyyy-MM-dd'T'HH:mm:ssX\",\n    new Date()\n  );\n  const create = properties.get('create');\n  const modify = properties.get('modify');\n  const destroy = properties.get('delete');\n  const [isInTrustedlist, isInWatchlist] = useIsUserListed(\n    user,\n    properties.get('uid'),\n    trustedlist,\n    watchlisted\n  );\n\n  return (\n    <div className=\"px12 py6\">\n      <div className=\"flex-parent flex-parent--column flex-parent--start flex-parent--wrap\">\n        <div className=\"flex-parent flex-parent--row justify--space-between\">\n          <h2 className=\"txt-m txt-uppercase txt-bold mr6 mb3\">Details</h2>\n          <div>\n            <CreateDeleteModify\n              showZero\n              className=\"mr3 mt3\"\n              create={create}\n              modify={modify}\n              delete={destroy}\n            />\n          </div>\n        </div>\n        <div className=\"flex-parent flex-parent--row justify--space-between flex-parent--wrap\">\n          <span className=\"txt-s\">\n            <strong className=\"txt-underline-on-hover pointer\">\n              <span dir=\"ltr pointer\" onClick={toggleUser}>\n                {user}\n              </span>\n            </strong>\n            {isInTrustedlist && (\n              <svg className=\"icon inline-block align-middle pl3 w18 h18 color-yellow\">\n                <use xlinkHref=\"#icon-star\" />\n              </svg>\n            )}\n            {isInWatchlist && (\n              <svg className=\"icon inline-block align-middle pl3 w18 h18 color-red\">\n                <use xlinkHref=\"#icon-alert\" />\n              </svg>\n            )}\n            {userEditCount > 0 && (\n              <span className=\"txt-s txt-em\">\n                &nbsp;({userEditCount} edits)\n              </span>\n            )}\n            &nbsp;created&nbsp;{formatDistanceToNow(date, { addSuffix: true })}\n          </span>\n        </div>\n      </div>\n      <Details changesetId={changesetId} properties={properties} />\n    </div>\n  );\n}\n\nconst Header = connect((state: RootStateType, props) => ({\n  trustedlist: state.trustedlist.get('trustedlist'),\n  watchlisted: state.watchlist.get('watchlist')\n}))(HeaderComponent);\nexport { Header };\n","import React from 'react';\nimport Placeholder from './user.jpg';\n\nexport class Avatar extends React.PureComponent {\n  props: {\n    url: string\n  };\n  state = {\n    loaded: false\n  };\n  handleImageLoaded() {\n    this.setState({ loaded: true });\n  }\n  handleImageErrored() {\n    this.setState({ loaded: false });\n  }\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.url !== this.props.url) {\n      this.setState({\n        loaded: false\n      });\n    }\n  }\n  render() {\n    let url: string = Placeholder;\n    if (this.props.url) {\n      url = this.props.url;\n      if (url.indexOf('http://') > -1) {\n        url = 'https://' + url.slice(5);\n      }\n    }\n    return (\n      <div className=\"p6 flex-parent flex-parent--center-main\">\n        <span\n          style={{\n            background: `url(${this.state.loaded\n              ? this.props.url\n              : Placeholder}) center center / ${this.props.size}px no-repeat`\n          }}\n          className={`flex-child flex-child--no-shrink border border--2 border--gray h${this\n            .props.size} w${this.props.size} bg-darken25 clip round-full`}\n        />\n        <img\n          alt=\"\"\n          className=\"none\"\n          src={this.props.url}\n          onLoad={this.handleImageLoaded.bind(this)}\n          onError={this.handleImageErrored.bind(this)}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { createPopup } from '../../utils/create_popup';\nimport { handlePopupCallback } from '../../utils/handle_popup_callback';\nimport { osmAuthUrl } from '../../config/constants';\nimport { isDev, isLocal } from '../../config';\nimport type { RootStateType } from '../../store';\nimport { getFinalToken } from '../../store/auth_actions';\nimport { getChangesetsPage } from '../../store/changesets_page_actions';\nimport { getChangeset } from '../../store/changeset_actions';\n\nclass SignInButton extends React.PureComponent {\n  props: {\n    text: string,\n    oAuthToken: ?string,\n    pageIndex: number,\n    getFinalToken: string => mixed,\n    getChangeset: string => mixed,\n    getChangesetsPage: string => mixed\n  };\n\n  handleLoginClick = () => {\n    var oAuthToken = this.props.oAuthToken;\n    if (!oAuthToken) return;\n\n    let url;\n    if (isDev || isLocal) {\n      url = `/local-landing.html#${oAuthToken}`;\n    } else {\n      url = `${osmAuthUrl}?oauth_token=${oAuthToken}`;\n    }\n\n    createPopup('oauth_popup', url);\n    handlePopupCallback().then(oAuthObj => {\n      this.props.getFinalToken(oAuthObj.oauth_verifier);\n    });\n  };\n  render() {\n    const extraClasses = this.props.className\n      ? this.props.className\n      : 'border--darken5 border--darken25-on-hover bg-darken10 bg-darken5-on-hover color-gray';\n    return (\n      <button\n        onClick={this.handleLoginClick}\n        className={`btn btn--s border border--1 round transition ${extraClasses}`}\n      >\n        <svg className=\"icon w18 h18 inline-block align-middle pr3\">\n          <use xlinkHref=\"#icon-osm\" />\n        </svg>\n        {this.props.text}\n      </button>\n    );\n  }\n}\n\nSignInButton = connect(\n  (state: RootStateType, props) => ({\n    oAuthToken: state.auth.get('oAuthToken'),\n    pageIndex: state.changesetsPage.get('pageIndex') || 0\n  }),\n  {\n    getFinalToken,\n    getChangeset,\n    getChangesetsPage\n  }\n)(SignInButton);\n\nexport { SignInButton };\n","import React from 'react';\n\nexport function Button({\n  onClick,\n  children,\n  iconName,\n  className,\n  disabled\n}: Object) {\n  return (\n    <button\n      disabled={disabled}\n      onClick={onClick}\n      className={`${className ||\n        ''} btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition ${\n        iconName && children ? 'pl12 pr6' : ''\n      }`}\n    >\n      {children}\n      {iconName && (\n        <svg\n          className={`icon w18 h18 inline-block align-middle ${\n            children ? 'pl3 pb3' : 'pb3'\n          }`}\n        >\n          <use xlinkHref={`#icon-${iconName}`} />\n        </svg>\n      )}\n    </button>\n  );\n}\n","// @flow\nimport React from 'react';\nimport './dropdown.css';\nimport onClickOutside from 'react-click-outside';\nimport { Button } from './button';\n\nclass DropdownContent extends React.PureComponent {\n  isActive = (obj: Object) => {\n    for (let v of this.props.value) {\n      if (v.label === obj.label) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  handleClick = (data: Object) => {\n    if (data) {\n      var label = data.label;\n      if (!label || !this.props.value || !this.props.onChange) return;\n      const value = this.props.value;\n      let ourObj = data;\n      if (!ourObj) return;\n\n      let isRemove = false;\n      for (let x = 0; x < value.length; x++) {\n        if (value[x].label === label) {\n          isRemove = true;\n          this.props.onRemove(ourObj);\n          this.props.onChange(value.slice(0, x).concat(value.slice(x + 1)));\n        }\n      }\n\n      if (!isRemove) {\n        let newArray = value.slice(0, value.length);\n        if (!this.props.multi) {\n          newArray = [];\n        }\n        newArray.push(ourObj);\n        this.props.onAdd(ourObj);\n        this.props.onChange(newArray);\n      }\n    }\n    if (!this.props.multi) {\n      this.props.toggleDropdown();\n    }\n  };\n\n  render() {\n    return (\n      <ul\n        className=\"dropdown-content wmin96 round wmax240\"\n        style={this.props.styles}\n      >\n        {this.props.options.map((i, k) => (\n          <li\n            key={k}\n            onClick={this.handleClick.bind(null, i)}\n            className=\"dropdown-content-item flex-parent flex-parent--row flex-parent--center-cross py6 px12\"\n          >\n            {this.props.multi && (\n              <input\n                data-label={i.label}\n                data-payload={JSON.stringify(i)}\n                type=\"checkbox\"\n                checked={this.isActive(i)}\n                value={i.label}\n                className=\"cursor-pointer mt6\"\n              />\n            )}\n            {i.href ? (\n              <a\n                target={'_blank'}\n                rel=\"noopener noreferrer\"\n                href={i.href}\n                onClick={this.props.toggleDropdown}\n                className={`txt-nowrap flex-child--grow cursor-pointer color-gray ${\n                  this.isActive(i) ? 'is-active txt-bold' : ''\n                }`}\n              >\n                {i.label}\n              </a>\n            ) : (\n              <span\n                onClick={\n                  this.props.multi ? () => {} : this.props.toggleDropdown\n                }\n                className={`txt-nowrap flex-child--grow cursor-pointer color-gray ${\n                  this.isActive(i) ? 'is-active txt-bold' : ''\n                }`}\n              >\n                {i.label}\n              </span>\n            )}\n            {this.props.deletable && (\n              <span\n                onClick={e => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  this.props.toggleDropdown();\n                  this.props.deletable(i.value);\n                }}\n              >\n                x\n              </span>\n            )}\n          </li>\n        ))}\n      </ul>\n    );\n  }\n}\n\nexport class _Dropdown extends React.PureComponent {\n  props: {\n    className: string,\n    disabled: boolean,\n    value: Array<Object>,\n    onChange: (Array<Object>) => any,\n    onAdd: (?Object) => any,\n    onRemove: (?Object) => any,\n    options: Array<Object>,\n    display: string,\n    deletable?: (value: string) => any,\n    multi: boolean,\n    position: string\n  };\n\n  state = {\n    display: false\n  };\n\n  handleClickOutside = () => {\n    this.setState({\n      display: false\n    });\n  };\n\n  toggleDropdown = () => {\n    this.setState({\n      display: !this.state.display\n    });\n  };\n\n  isActive = (obj: Object) => {\n    for (let v of this.props.value) {\n      if (v.label === obj.label) {\n        return true;\n      }\n    }\n    return false;\n  };\n\n  render() {\n    return (\n      <div className={`dropdown pointer ${this.props.className || ''}`}>\n        <Button\n          iconName=\"chevron-down\"\n          onClick={this.toggleDropdown}\n          className=\"wmin96\"\n        >\n          <span>{this.props.display}</span>\n        </Button>\n        {this.state.display && (\n          <DropdownContent\n            {...this.props}\n            eventTypes={['click', 'touchend']}\n            toggleDropdown={this.toggleDropdown}\n            styles={\n              this.props.position === 'right' ? { right: 0 } : { left: 0 }\n            }\n          />\n        )}\n      </div>\n    );\n  }\n}\n\nexport const Dropdown = onClickOutside(_Dropdown);\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport { Dropdown } from '../dropdown';\nimport {\n  addToWatchlist,\n  removeFromWatchlist\n} from '../../store/watchlist_actions';\nimport {\n  addToTrustedlist,\n  removeFromTrustedlist\n} from '../../store/trustedlist_actions';\n\ntype propsType = {\n  user: Map<string, any>,\n  trustedlist: Map<string, *>,\n  watchlist: Map<object, *>,\n  addToWatchlist: string => void,\n  removeFromWatchlist: string => void,\n  addToTrustedlist: string => void,\n  removeFromTrustedlist: string => void\n};\n\nclass TrustWatchUser extends React.PureComponent<any, propsType, any> {\n  handleVerify = (arr: Array<Object>) => {\n    const username = this.props.user.get('name');\n    const uid = this.props.user.get('uid');\n    if (arr.length === 1) {\n      if (arr[0].value === false) {\n        this.props.addToWatchlist({ username, uid });\n      }\n      if (arr[0].value === true) {\n        this.props.addToTrustedlist(username);\n      }\n    } else if (arr.length > 1) {\n      throw new Error('verify array is big');\n    }\n  };\n\n  handleVerifyClear = () => {\n    const is_in_trustedlist =\n      this.props.trustedlist.indexOf(this.props.user.get('name')) !== -1;\n    const is_watchlisted =\n      this.props.watchlist\n        .map(user => user.get('uid'))\n        .indexOf(this.props.user.get('uid')) !== -1;\n\n    if (is_watchlisted) {\n      this.props.removeFromWatchlist(this.props.user.get('uid'));\n    } else if (is_in_trustedlist) {\n      this.props.removeFromTrustedlist(this.props.user.get('name'));\n    }\n  };\n\n  render() {\n    const watchlist = this.props.watchlist.map(user => user.get('uid'));\n\n    if (watchlist.includes(this.props.user.get('uid'))) {\n      return (\n        <div className=\"flex-parent-inline\">\n          <span className=\"btn btn--s border border--1 round color-gray transition pl12 pr6 bg-lighten50 border--red-light\">\n            <span>\n              <svg className=\"icon inline-block align-middle pr3 pb3 w18 h18 color-gray\">\n                <use xlinkHref=\"#icon-alert\" />\n              </svg>\n              Watchlisted user\n            </span>\n            <svg\n              onClick={() =>\n                this.props.removeFromWatchlist(this.props.user.get('uid'))\n              }\n              className=\"icon inline-block align-middle pl6 w24 h24 pointer color-gray\"\n            >\n              <use xlinkHref=\"#icon-close\" />\n            </svg>\n          </span>\n        </div>\n      );\n    } else if (\n      this.props.trustedlist &&\n      this.props.trustedlist.includes(this.props.user.get('name'))\n    ) {\n      return (\n        <div className=\"flex-parent-inline\">\n          <span className=\"btn btn--s border border--1 round color-gray transition pl12 pr6 bg-lighten50 border--yellow\">\n            <span>\n              <svg className=\"icon inline-block align-middle pr3 pb3 w18 h18 color-gray\">\n                <use xlinkHref=\"#icon-star\" />\n              </svg>\n              Trusted user\n            </span>\n            <svg\n              onClick={e =>\n                this.props.removeFromTrustedlist(this.props.user.get('name'))\n              }\n              className=\"icon inline-block align-middle pl6 w24 h24 pointer color-gray\"\n            >\n              <use xlinkHref=\"#icon-close\" />\n            </svg>\n          </span>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"select-container\">\n        <Dropdown\n          eventTypes={['click', 'touchend']}\n          value={[]}\n          onAdd={() => {}}\n          onRemove={() => {}}\n          options={[\n            {\n              value: false,\n              label: 'Add to your watchlist'\n            },\n            {\n              value: true,\n              label: 'Add to your trusted users list'\n            }\n          ]}\n          onChange={this.handleVerify}\n          display=\"Trust / Watch user\"\n          position=\"left\"\n        />\n      </div>\n    );\n  }\n}\n\nTrustWatchUser = connect(\n  (state: RootStateType, props) => ({\n    trustedlist: state.trustedlist.get('trustedlist'),\n    watchlist: state.watchlist.get('watchlist')\n  }),\n  {\n    addToWatchlist,\n    removeFromWatchlist,\n    addToTrustedlist,\n    removeFromTrustedlist\n  }\n)(TrustWatchUser);\n\nexport { TrustWatchUser };\n","import React from 'react';\n\nexport const UserOSMLink = ({ userName, linkClasses, children }) => {\n  if (!userName) return null;\n\n  const url = `https://www.openstreetmap.org/user/${userName}`;\n\n  return (\n    <a\n      href={url}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      title=\"Open in OSM\"\n      className={\n        linkClasses ||\n        'mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition'\n      }\n    >\n      {children}\n    </a>\n  );\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport showdown from 'showdown';\nimport { formatDistanceToNow, parse } from 'date-fns';\n\nimport { Avatar } from '../avatar';\nimport { getObjAsQueryParam } from '../../utils/query_params';\nimport { SignInButton } from './sign_in_button';\nimport { TrustWatchUser } from './trust_watch_user';\nimport { UserOSMLink } from './user_osm_link';\n\nclass UserLink extends React.PureComponent {\n  getHarmfulObject() {\n    if (this.props.harmful) {\n      return {\n        label: 'Show Bad only',\n        value: true\n      };\n    } else {\n      return {\n        label: 'Show Good only',\n        value: false\n      };\n    }\n  }\n  getLinkContent() {\n    if (this.props.harmful) {\n      return `${this.props.userDetails.get('harmful_changesets')} Bad`;\n    } else {\n      const count =\n        this.props.userDetails.get('checked_changesets') -\n        this.props.userDetails.get('harmful_changesets');\n      return `${count} Good`;\n    }\n  }\n  render() {\n    return (\n      <Link\n        className=\"txt-underline-on-hover txt-bold pointer color-gray\"\n        to={{\n          search: getObjAsQueryParam('filters', {\n            uids: [\n              {\n                label: this.props.userDetails.get('uid'),\n                value: this.props.userDetails.get('uid')\n              }\n            ],\n            harmful: [this.getHarmfulObject()],\n            date__gte: [{ label: '', value: '' }]\n          }),\n          pathname: '/'\n        }}\n      >\n        {this.getLinkContent()}\n      </Link>\n    );\n  }\n}\n\n// getObjAsQueryParam('filters', filters.toJS());\nexport class User extends React.PureComponent {\n  renderUidFilterLink() {\n    return (\n      <Link\n        className=\"txt-underline-on-hover txt-bold pointer color-gray\"\n        to={{\n          search: getObjAsQueryParam('filters', {\n            uids: [\n              {\n                label: this.props.userDetails.get('uid'),\n                value: this.props.userDetails.get('uid')\n              }\n            ],\n            date__gte: [{ label: '', value: '' }]\n          }),\n          pathname: '/'\n        }}\n      >\n        {`${this.props.userDetails.get('count')} edits`}\n      </Link>\n    );\n  }\n  render() {\n    const converter = new showdown.Converter({\n      noHeaderId: true,\n      simplifiedAutoLink: true\n    });\n    const UserDescriptionHTML = converter.makeHtml(\n      this.props.userDetails.get('description') || ''\n    );\n    const registrationDate = this.props.userDetails.get('accountCreated')\n      ? formatDistanceToNow(\n          parse(\n            this.props.userDetails.get('accountCreated'),\n            // eslint-disable-next-line\n            \"yyyy-MM-dd'T'HH:mm:ssX\",\n            new Date()\n          ),\n          { addSuffix: true }\n        )\n      : '';\n\n    return (\n      <div className=\"px12 py6\">\n        <h2 className=\"txt-m txt-uppercase txt-bold mr6 mb3\">\n          User{' '}\n          {this.props.userDetails.get('uid') &&\n            `/ ${this.props.userDetails.get('uid')}`}\n        </h2>\n        {this.props.userDetails.get('name') ? (\n          <div className=\"flex-parent flex-parent--column align-items--center justify--space-between mb6\">\n            <div>\n              <Avatar size={96} url={this.props.userDetails.get('img')} />\n              <div className=\"mt6 txt-bold color-gray align-center\">\n                {this.props.userDetails.get('name')}\n              </div>\n            </div>\n            <div>\n              <p className=\"txt-s color-gray align-center\">\n                {`Joined ${registrationDate} | `}\n                {this.props.userDetails.get('count')\n                  ? this.renderUidFilterLink()\n                  : `${this.props.userDetails.get(\n                      'changesets_in_osmcha'\n                    )} edits registered on OSMCha`}\n              </p>\n            </div>\n            <div>\n              <p className=\"txt-s color-gray align-center\">\n                <UserLink userDetails={this.props.userDetails} harmful={true} />\n                &nbsp;and&nbsp;\n                <UserLink\n                  userDetails={this.props.userDetails}\n                  harmful={false}\n                />\n                &nbsp;changesets\n              </p>\n            </div>\n\n            <div className=\"mt6\">\n              <TrustWatchUser user={this.props.userDetails} />\n            </div>\n\n            <div className=\"mt12\">\n              <Link\n                className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n                to={{\n                  search: getObjAsQueryParam('filters', {\n                    users: [\n                      {\n                        label: this.props.userDetails.get('name'),\n                        value: this.props.userDetails.get('name')\n                      }\n                    ],\n                    date__gte: [{ label: '', value: '' }]\n                  }),\n                  pathname: '/'\n                }}\n              >\n                OSMCha\n              </Link>\n              <UserOSMLink userName={this.props.userDetails.get('name')}>\n                OSM\n              </UserOSMLink>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                title=\"Open in HDYC\"\n                className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n                href={`https://hdyc.neis-one.org/?${this.props.userDetails.get(\n                  'name'\n                )}`}\n              >\n                HDYC\n              </a>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                title=\"Open in Missing Maps\"\n                className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n                href={`https://www.missingmaps.org/users/#/${this.props.userDetails.get(\n                  'name'\n                )}`}\n              >\n                Missing Maps\n              </a>\n            </div>\n\n            {this.props.whosThat.size > 1 && (\n              <div className=\"txt-s color-gray\">\n                Past usernames: &nbsp;\n                {this.props.whosThat.slice(0, -1).map((e, k) => (\n                  <span key={k} className=\"txt-em\">\n                    {e}&nbsp;\n                  </span>\n                ))}\n              </div>\n            )}\n            <div className=\"mt12\">\n              <p\n                className=\"txt-subhead txt-s txt-break-url user-description\"\n                dangerouslySetInnerHTML={{ __html: UserDescriptionHTML }}\n              />\n            </div>\n          </div>\n        ) : (\n          <div className=\"flex-parent flex-parent--column align-items--center justify--space-between mb6\">\n            <div>\n              <Avatar size={96} url={this.props.userDetails.get('img')} />\n              <div className=\"mt6 txt-bold color-gray align-center\">\n                {this.props.userDetails.get('name')}\n              </div>\n            </div>\n            <div className=\"flex-parent flex-parent--column mt6 mb3\">\n              <SignInButton text=\"Sign in to see the user details\" />\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nexport const Loading = ({ height, className }) => (\n  <div\n    style={{ height: height ? height : 'auto' }}\n    className={`${className} flex-parent flex-parent--column flex-parent--center-cross flex-parent--center-main flex-child--grow`}\n  >\n    <div className=\"flex-child loading\" />\n  </div>\n);\n","// @flow\nimport React from 'react';\n\nimport { SignInButton } from './changeset/sign_in_button';\n\nexport function SignIn() {\n  return (\n    <div className=\"flex-parent flex-parent--column flex-parent--center-cross bg-gray-faint hfull-55\">\n      <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n      <div className=\"flex-parent flex-parent--column flex-parent--center-cross\">\n        <svg className=\"icon h160 w160 inline-block align-middle pb3\">\n          <use xlinkHref=\"#icon-osm\" />\n        </svg>\n      </div>\n      <div className=\"flex-parent flex-parent--column align-center txt-l txt-bold pt12\">\n        Sign in with your OpenStreetMap account to use OSMCha.\n      </div>\n      <div className=\"flex-parent flex-parent--column align-center txt-l pt36\">\n        <SignInButton\n          className=\"border--darken5 border--darken25-on-hover bg-gray-light color-gray-dark\"\n          text=\"Sign in\"\n        />\n      </div>\n      <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n    </div>\n  );\n}\n","import React from 'react';\nimport debounce from 'lodash.debounce';\nimport { connect } from 'react-redux';\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup';\nimport { Loading } from '../components/loading';\nimport { SignIn } from '../components/sign_in';\nimport { dispatchEvent } from '../utils/dispatch_event';\nimport { updateStyle } from '../store/map_controls_actions';\nimport { importChangesetMap } from '../utils/cmap';\nimport {\n  mapboxAccessToken,\n  osmUrl,\n  isOfficialOSM,\n  enableRealChangesets\n} from '../config/constants';\n\nimport 'changeset-map/public/css/style.css';\nimport type { RootStateType } from '../store';\nimport { isMobile } from '../utils';\n\nlet changesetId;\nlet currentChangesetMap;\nlet width = 700;\nlet height = 500;\nlet event;\nlet cMapRender;\n\nlet getMapInstance;\nexport function selectFeature(id: number) {\n  if (!id || !event) return;\n  event.emit('selectFeature', 'node|way', id);\n}\n\nfunction loadingChangesetMapAsync() {\n  if (cMapRender) return Promise.resolve(cMapRender);\n  return Promise.all([\n    importChangesetMap('render'),\n    importChangesetMap('getMapInstance')\n  ]).then(res => {\n    cMapRender = res[0];\n    getMapInstance = res[1];\n    return cMapRender;\n  });\n}\n\nfunction loadMap() {\n  var container = document.getElementById('container');\n  if (!container || !currentChangesetMap) return;\n  loadingChangesetMapAsync().then(render => {\n    if (!render) return;\n    // if (event) event.emit('clearFeature');\n    event = render(container, changesetId, {\n      width: width + 'px',\n      height: Math.max(400, height) + 'px',\n      data: currentChangesetMap,\n      disableSidebar: true,\n      enableRealChangesets: enableRealChangesets,\n      mapboxAccessToken: mapboxAccessToken,\n      osmBase: osmUrl,\n      isOSMApp: isOfficialOSM\n    });\n  });\n}\n\nvar minDebounce = debounce(loadMap, 250);\n\nclass CMap extends React.PureComponent {\n  props: {\n    changesetId: number,\n    currentChangesetMap: Object,\n    errorChangesetMap: ?Object,\n    loadingChangesetMap: boolean,\n    className: string,\n    style: string\n  };\n\n  state = {\n    visible: false,\n    height: 0,\n    width: 0\n  };\n\n  ref = null;\n\n  componentDidMount() {\n    changesetId = this.props.changesetId;\n    currentChangesetMap = this.props.currentChangesetMap;\n    const mobile = isMobile();\n\n    if (this.ref) {\n      var rect = this.ref.parentNode.getBoundingClientRect();\n      // On mobile, above the map are two bars, one 36px, on 40px\n      height = mobile\n        ? parseInt(window.innerHeight - 36 - 40, 10)\n        : parseInt(window.innerHeight - 1 * 55, 10);\n      width = parseInt(rect.width, 10);\n    }\n    window.onresize = debounce(this.setDimensions, 100);\n    minDebounce();\n  }\n\n  componentWillUnmount() {\n    window.onresize = null;\n    if (this.props.style !== 'satellite') this.props.updateStyle('satellite');\n    event && event.emit('remove');\n  }\n\n  componentDidUpdate(prevProp: Object) {\n    if (\n      this.props.currentChangesetMap !== prevProp.currentChangesetMap ||\n      this.props.token !== prevProp.token\n    ) {\n      minDebounce();\n    }\n  }\n\n  setRef = (r: any) => {\n    this.ref = r;\n    this.setDimensions();\n  };\n\n  setDimensions = () => {\n    if (!this.ref) return;\n    var rect = this.ref.parentNode.getBoundingClientRect();\n    height = parseInt(window.innerHeight - 1 * 55, 10);\n    width = parseInt(rect.width, 10);\n    this.setState({\n      height,\n      width\n    });\n    if (getMapInstance) {\n      var instance = getMapInstance();\n      if (instance && instance.map) {\n        instance.map.resize();\n      }\n    }\n  };\n\n  render() {\n    if (this.props.errorChangesetMap) {\n      dispatchEvent('showToast', {\n        title: 'changeset-map failed to load',\n        content: 'Try reloading osmcha',\n        timeOut: 5000,\n        type: 'error'\n      });\n      console.error(this.props.errorChangesetMap);\n      // return null;\n    }\n    changesetId = this.props.changesetId;\n    currentChangesetMap = this.props.currentChangesetMap;\n\n    if (this.props.token) {\n      return (\n        <div className=\"relative\" ref={this.setRef}>\n          <div\n            id=\"container\"\n            className=\"absolute\"\n            style={{\n              height: this.state.height,\n              width: this.state.width,\n              visibility: !(\n                this.props.loadingChangesetMap || this.props.errorChangesetMap\n              )\n                ? 'visible'\n                : 'hidden'\n            }}\n          />\n          <CSSTransitionGroup\n            transitionName=\"map-hide\"\n            transitionAppearTimeout={300}\n            transitionAppear={true}\n            transitionEnterTimeout={300}\n            transitionLeaveTimeout={1000} // determines the transition to cMap\n          >\n            {(this.props.loadingChangesetMap ||\n              this.props.errorChangesetMap) && (\n              <div\n                key={0}\n                id=\"placeholder\"\n                className={`absolute z0\n                  ${this.props.errorChangesetMap ? 'bg-red-faint' : 'bg-black'}\n                  `}\n                style={{\n                  height: this.state.height,\n                  width: this.state.width\n                }}\n              >\n                <Loading height={this.state.height} />\n              </div>\n            )}\n          </CSSTransitionGroup>\n        </div>\n      );\n    } else {\n      return <SignIn />;\n    }\n  }\n}\n\nCMap = connect(\n  (state: RootStateType, props) => ({\n    changesetId: state.changeset.get('changesetId'),\n    currentChangesetMap: state.changeset.getIn([\n      'changesetMap',\n      state.changeset.get('changesetId')\n    ]),\n    errorChangesetMap: state.changeset.get('errorChangesetMap'),\n    loadingChangesetMap: state.changeset.get('loadingChangesetMap'),\n    style: state.mapControls.get('style'),\n    token: state.auth.get('token')\n  }),\n  { updateStyle }\n)(CMap);\n\nexport { CMap };\n","// @flow\nimport React from 'react';\nimport { Map, List } from 'immutable';\nimport { Reasons } from '../reasons';\nimport { selectFeature } from '../../views/map';\n\nconst Feature = ({\n  data,\n  changesetReasons\n}: {\n  data: Map<string, any>,\n  changesetReasons: Map<string, any>\n}) => {\n  let reasons;\n  // operation necessary to the change\n  if (\n    data.get('reasons').size &&\n    typeof data.get('reasons').get(0) === 'number'\n  ) {\n    reasons = changesetReasons.filter(reason =>\n      data.get('reasons').contains(reason.get('id'))\n    );\n  } else {\n    reasons = data.get('reasons');\n  }\n  return (\n    <tr className=\"txt-s\">\n      <td>{data.get('osm_id')}</td>\n      <td>{data.get('name')}</td>\n      <td>\n        {data.get('note') ? (\n          <abbr title={data.get('note')}>\n            <Reasons\n              reasons={reasons}\n              userFlag={data.get('user_flag')}\n              underline={true}\n              color=\"blue\"\n            />\n          </abbr>\n        ) : (\n          <Reasons\n            reasons={reasons}\n            color=\"blue\"\n            userFlag={data.get('user_flag')}\n          />\n        )}\n      </td>\n      <td>\n        <span\n          className=\"cursor-pointer txt-underline-on-hover txt-bold mr6\"\n          role=\"button\"\n          tabIndex=\"0\"\n          onFocus={() => selectFeature(parseInt(data.get('osm_id'), 10))}\n        >\n          Map\n        </span>\n        <strong className=\"cursor-pointer txt-underline-on-hover\">\n          <a\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n            href={`http://localhost:8111/load_object?objects=${data\n              .getIn(['url'], '')\n              .charAt(0)}${data.get('osm_id')}`}\n          >\n            JOSM\n          </a>\n        </strong>\n      </td>\n    </tr>\n  );\n};\n\nexport function Features({\n  properties,\n  changesetId\n}: {\n  properties: Map<string, *>,\n  changesetId: number\n}) {\n  let features: List<Map<string, *>> = properties.get('features');\n  const reviewedFeatures: List<Map<string, *>> = properties\n    .get('reviewed_features')\n    .map(feature =>\n      Map({\n        url: feature.get('id'),\n        user_flag: `Flagged by ${feature.get('user')}`,\n        osm_id: feature.get('id').split('-')[1],\n        reasons: []\n      })\n    );\n  const reviewedIds = reviewedFeatures.map(feature => feature.get('url'));\n  const featuresIds = features.map(feature => feature.get('url'));\n  const intersection = features\n    .filter(feature => reviewedIds.includes(feature.get('url')))\n    .map((feature, k) => [k, feature.get('url')]);\n  intersection.forEach(item => {\n    features = features.setIn(\n      [item[0], 'user_flag'],\n      reviewedFeatures.find(f => f.get('url') === item[1]).get('user_flag')\n    );\n  });\n  features = features.concat(\n    reviewedFeatures.filter(\n      feature => !featuresIds.includes(feature.get('url'))\n    )\n  );\n\n  return (\n    <div className=\"px12 py6\">\n      <div>\n        <h2 className=\"txt-m txt-uppercase txt-bold mr6 mb3\">\n          Flagged Features\n          {features.size > 0 && (\n            <strong className=\"bg-blue-faint color-blue-dark mx6 px6 py3 txt-s round\">\n              {features.size}\n            </strong>\n          )}\n        </h2>\n        {features.size === 0 ? (\n          <div className=\"flex-parent flex-parent--column flex-parent--center-cross mb12\">\n            <svg className=\"icon icon--xxl color-darken25\">\n              <use xlinkHref=\"#icon-alert\" />\n            </svg>\n            <p className=\"txt-m\">{`No features were flagged for ${changesetId}.`}</p>\n          </div>\n        ) : (\n          <table className=\"table osmcha-custom-table my12\">\n            <thead>\n              <tr className=\"txt-s txt-uppercase\">\n                <th>OSM Id</th>\n                <th>Name</th>\n                <th>Reasons</th>\n                <th>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {features.map((f, k) => (\n                <Feature\n                  key={k}\n                  data={f}\n                  changesetReasons={properties.get('reasons')}\n                />\n              ))}\n            </tbody>\n          </table>\n        )}\n      </div>\n    </div>\n  );\n}\n","// @flow\nimport React from 'react';\n\ntype propsType = {|\n  isActive: boolean,\n  setOpenAll: Function\n|};\n\nexport const OpenAll = ({ isActive, setOpenAll }: propsType) => (\n  <div className=\"inline-block fr\">\n    <button\n      className=\"txt-s txt-underline pointer\"\n      onClick={() => setOpenAll(!isActive)}\n      role=\"switch\"\n      aria-checked={isActive}\n      tabIndex=\"0\"\n    >\n      {isActive ? 'Close all' : 'Open all'}\n    </button>\n  </div>\n);\n","// @flow\nimport React from 'react';\n\ntype propsType = {|\n  isOpen: boolean\n|};\n\nexport const ExpandItemIcon = ({ isOpen }: propsType) => {\n  return (\n    <>\n      {isOpen ? (\n        <svg\n          className=\"icon h18 w18 inline-block\"\n          style={{ verticalAlign: 'text-bottom' }}\n        >\n          <use xlinkHref={'#icon-chevron-down'} />\n        </svg>\n      ) : (\n        <svg\n          className=\"icon h18 w18 inline-block\"\n          style={{ verticalAlign: 'text-bottom' }}\n        >\n          <use xlinkHref={'#icon-chevron-right'} />\n        </svg>\n      )}\n    </>\n  );\n};\n","// @flow\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { OrderedSet } from 'immutable';\n\nimport type { RootStateType } from '../store';\nimport { selectFeature } from '../../views/map';\nimport { Loading } from '../loading';\nimport { OpenAll } from '../open_all';\nimport { ExpandItemIcon } from '../expand_item_icon';\n\nexport function getFeatures(features) {\n  var keys = Object.keys(features);\n  return keys.map(item => features[item]);\n}\n\nexport function processFeatures(features) {\n  const finalReport = new Map();\n  const analyzedFeatures = features.map(feature =>\n    analyzeFeature(feature[0], feature[1])\n  );\n  const keys = ['addedTags', 'changedValues', 'deletedTags'];\n  analyzedFeatures.map(item =>\n    keys.map(key =>\n      item.get(key).forEach(tag => {\n        if (finalReport.get(tag[0])) {\n          finalReport.set(\n            tag[0],\n            finalReport\n              .get(tag[0])\n              .concat([\n                { id: item.get('id'), type: item.get('type'), value: tag[1] }\n              ])\n          );\n        } else {\n          finalReport.set(tag[0], [\n            { id: item.get('id'), type: item.get('type'), value: tag[1] }\n          ]);\n        }\n      })\n    )\n  );\n  return finalReport;\n}\n\nexport function analyzeFeature(newVersion, oldVersion) {\n  const oldVersionKeys = Object.keys(oldVersion.properties.tags);\n  const newVersionKeys = Object.keys(newVersion.properties.tags);\n  const addedTags = newVersionKeys.filter(tag => !oldVersionKeys.includes(tag));\n  const deletedTags = oldVersionKeys.filter(\n    tag => !newVersionKeys.includes(tag)\n  );\n  const changedValues = newVersionKeys\n    .filter(tag => !addedTags.includes(tag) && !deletedTags.includes(tag))\n    .filter(\n      tag => newVersion.properties.tags[tag] !== oldVersion.properties.tags[tag]\n    );\n  const result = new Map();\n  result\n    .set('id', newVersion.properties.id)\n    .set('type', newVersion.properties.type)\n    .set(\n      'addedTags',\n      addedTags.map(tag => [\n        `Added tag ${tag}`,\n        newVersion.properties.tags[tag]\n      ])\n    )\n    .set(\n      'deletedTags',\n      deletedTags.map(tag => [\n        `Deleted tag ${tag}`,\n        oldVersion.properties.tags[tag]\n      ])\n    )\n    .set(\n      'changedValues',\n      changedValues.map(tag => [\n        `Changed value of tag ${tag}`,\n        [oldVersion.properties.tags[tag], newVersion.properties.tags[tag]]\n      ])\n    );\n  return result;\n}\n\nexport function FeatureListItem({ id, type }) {\n  return (\n    <li>\n      <span\n        className=\"pointer txt-bold-on-hover\"\n        role=\"button\"\n        tabIndex=\"0\"\n        onFocus={() => selectFeature(id)}\n      >\n        {type} {id}\n      </span>\n    </li>\n  );\n}\n\nfunction ChangeTitle({ value, type }) {\n  if (type.startsWith('Added')) {\n    return <span className=\"txt-code cmap-bg-create-light\">{value}</span>;\n  }\n  if (type.startsWith('Deleted')) {\n    return <span className=\"txt-code cmap-bg-delete-light\">{value}</span>;\n  }\n  if (type.startsWith('Changed')) {\n    const [oldValue, newValue] = value;\n    return (\n      <span>\n        <span className=\"txt-code cmap-bg-modify-old-light\">{oldValue}</span>\n        <strong> ➜ </strong>\n        <span className=\"txt-code cmap-bg-modify-new-light\">{newValue}</span>\n      </span>\n    );\n  }\n  return <div></div>;\n}\n\nexport const ChangeItem = ({ opened, tag, features }) => {\n  const [isOpen, setIsOpen] = useState(opened);\n  const values = new OrderedSet(features.map(feature => feature.value));\n  const last_space = tag.lastIndexOf(' ') + 1;\n\n  useEffect(() => setIsOpen(opened), [opened]);\n\n  return (\n    <div>\n      <button\n        className=\"pointer\"\n        tabIndex=\"0\"\n        aria-pressed={isOpen}\n        onClick={() => setIsOpen(!isOpen)}\n      >\n        <ExpandItemIcon isOpen={isOpen} />\n        <span className=\"txt-bold\">{tag.slice(0, last_space)}</span>\n        <span className=\"txt-code\">{tag.slice(last_space)}</span>\n        <strong className=\"bg-blue-faint color-blue-dark mx6 px6 py3 txt-s round\">\n          {features.length}\n        </strong>\n      </button>\n      {values.map((value, n) => (\n        <div\n          className=\"ml18 py3\"\n          style={{ display: isOpen ? 'block' : 'none' }}\n          key={n}\n        >\n          <ChangeTitle value={value} type={tag} />\n          <ul className=\"ml6\">\n            {features\n              .filter(feature => feature.value === value)\n              .map((feature, k) => (\n                <FeatureListItem\n                  id={feature.id}\n                  type={feature.type}\n                  value={feature.value}\n                  key={k}\n                />\n              ))}\n          </ul>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nconst ChangeItemList = ({ changes, openAll }) => {\n  return (\n    <>\n      {changes.length ? (\n        changes.map((change, k) => (\n          <ChangeItem\n            key={k}\n            tag={change[0]}\n            features={change[1]}\n            opened={openAll}\n          />\n        ))\n      ) : (\n        <span>No tags were changed in this changeset.</span>\n      )}\n    </>\n  );\n};\n\ntype propsType = {|\n  changesetId: string,\n  changes: Object\n|};\n\nconst TagChangesComponent = ({ changesetId, changes }: propsType) => {\n  const [changeReport, setChangeReport] = useState([]);\n  const [openAll, setOpenAll] = useState(false);\n\n  useEffect(() => {\n    const newChangeReport = [];\n    if (changes && changes.get(changesetId)) {\n      const changesetData = changes.get(changesetId)['featureMap'];\n      const processed = processFeatures(\n        getFeatures(changesetData).filter(\n          item => item.length === 2 && item[0].properties.action === 'modify'\n        )\n      );\n      processed.forEach((featureIDs, tag) =>\n        newChangeReport.push([tag, featureIDs])\n      );\n      setChangeReport(newChangeReport.sort());\n    }\n  }, [changes, changesetId]);\n\n  return (\n    <div className=\"px12 py6\">\n      <div className=\"pb6\">\n        <h2 className=\"inline txt-m txt-uppercase txt-bold mr6 mb3\">\n          Tag changes\n        </h2>\n        {changeReport.length ? (\n          <OpenAll isActive={openAll} setOpenAll={setOpenAll} />\n        ) : null}\n      </div>\n      {changes.get(changesetId) ? (\n        <ChangeItemList changes={changeReport} openAll={openAll} />\n      ) : (\n        <Loading className=\"pt18\" />\n      )}\n    </div>\n  );\n};\n\nconst TagChanges = connect((state: RootStateType, props) => ({\n  changes: state.changeset.get('changesetMap')\n}))(TagChangesComponent);\n\nexport { TagChanges };\n","// @flow\nimport React, { useEffect, useState } from 'react';\nimport { connect } from 'react-redux';\n\nimport type { RootStateType } from '../store';\nimport { getFeatures, FeatureListItem } from './tag_changes';\nimport { Loading } from '../loading';\nimport { OpenAll } from '../open_all';\nimport { ExpandItemIcon } from '../expand_item_icon';\n\nfunction processFeatures(features) {\n  const finalReport = new Map();\n  features = features.map(item => item[0]);\n  const keys = ['create', 'delete'];\n  keys.map(key =>\n    finalReport.set(\n      key,\n      features\n        .filter(item => item.properties.action === key)\n        .map(item => ({ id: item.properties.id, type: item.properties.type }))\n    )\n  );\n  finalReport.set(\n    'modify',\n    features\n      .filter(item => item.properties.action === 'modify')\n      .filter(item => item.properties.type === 'relation')\n      .map(item => ({ id: item.properties.id, type: item.properties.type }))\n  );\n  return finalReport;\n}\n\nconst ActionItem = ({ opened, tag, features }) => {\n  const [isOpen, setIsOpen] = useState(opened);\n  const titles = {\n    create: 'Created',\n    modify: 'Modified Relations',\n    delete: 'Deleted'\n  };\n\n  useEffect(() => setIsOpen(opened), [opened]);\n\n  return (\n    <div>\n      <button\n        className=\"pointer\"\n        tabIndex=\"0\"\n        aria-pressed={isOpen}\n        onClick={() => setIsOpen(!isOpen)}\n      >\n        <ExpandItemIcon isOpen={isOpen} />\n        <span className=\"txt-bold\">{titles[tag]}</span>\n        <strong className=\"bg-blue-faint color-blue-dark mx6 px6 py3 txt-s round\">\n          {features.length}\n        </strong>\n      </button>\n      <ul className=\"cmap-vlist\" style={{ display: isOpen ? 'block' : 'none' }}>\n        {features.map((item, k) => (\n          <FeatureListItem id={item.id} type={item.type} key={k} />\n        ))}\n      </ul>\n    </div>\n  );\n};\n\ntype propsType = {|\n  changesetId: string,\n  changes: Object\n|};\n\nconst OtherFeaturesComponent = ({ changesetId, changes }: propsType) => {\n  const [changeReport, setChangeReport] = useState([]);\n  const [openAll, setOpenAll] = useState(false);\n\n  useEffect(() => {\n    const newChangeReport = [];\n    if (changes && changes.get(changesetId)) {\n      const changesetData = changes.get(changesetId)['featureMap'];\n      const processed = processFeatures(getFeatures(changesetData));\n      processed.forEach((featureIDs, tag) =>\n        newChangeReport.push([tag, featureIDs])\n      );\n      setChangeReport(\n        newChangeReport.filter(changeType => changeType[1].length)\n      );\n    }\n  }, [changes, changesetId]);\n\n  return (\n    <div className=\"px12 py6\">\n      <div className=\"pb6\">\n        <h2 className=\"inline txt-m txt-uppercase txt-bold mr6 mb3\">\n          Other features\n        </h2>\n        {changeReport.length ? (\n          <OpenAll isActive={openAll} setOpenAll={setOpenAll} />\n        ) : null}\n      </div>\n      {changes.get(changesetId) ? (\n        changeReport.length ? (\n          changeReport.map((change, k) => (\n            <ActionItem\n              key={k}\n              tag={change[0]}\n              features={change[1]}\n              opened={openAll}\n            />\n          ))\n        ) : (\n          <span>No created and deleted features in this changeset.</span>\n        )\n      ) : (\n        <Loading className=\"pt18\" />\n      )}\n    </div>\n  );\n};\n\nexport const OtherFeatures = connect((state: RootStateType, props) => ({\n  changes: state.changeset.get('changesetMap')\n}))(OtherFeaturesComponent);\n","// @flow\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\n\nimport type { RootStateType } from '../store';\nimport { getFeatures, FeatureListItem } from './tag_changes';\nimport { Loading } from '../loading';\nimport { OpenAll } from '../open_all';\nimport { ExpandItemIcon } from '../expand_item_icon';\n\nfunction processFeatures(features) {\n  const finalReport = new Map();\n  const keys = ['node', 'way', 'relation'];\n  keys.map(key =>\n    finalReport.set(\n      key,\n      features\n        .filter(item => item[0].properties.action === 'modify')\n        .filter(item => item[0].properties.type === key)\n        .filter(\n          item =>\n            JSON.stringify(item[0].geometry) !==\n            JSON.stringify(item[1].geometry)\n        )\n        .map(item => ({ id: item[0].properties.id }))\n    )\n  );\n  return finalReport;\n}\n\nconst GeometryChangesItem = ({ tag, features, opened }) => {\n  const titles = { node: 'Nodes', way: 'Ways', relation: 'Relations' };\n  const [isOpen, setIsOpen] = useState(opened);\n\n  useEffect(() => setIsOpen(opened), [opened]);\n\n  return (\n    <div>\n      <button\n        className=\"pointer\"\n        tabIndex=\"0\"\n        aria-pressed={isOpen}\n        onClick={() => setIsOpen(!isOpen)}\n      >\n        <ExpandItemIcon isOpen={isOpen} />\n        <span className=\"txt-bold\">{titles[tag]}</span>\n        <strong className=\"bg-blue-faint color-blue-dark mx6 px6 py3 txt-s round\">\n          {features.length}\n        </strong>\n      </button>\n      <ul className=\"cmap-vlist\" style={{ display: isOpen ? 'block' : 'none' }}>\n        {features.map((item, k) => (\n          <FeatureListItem id={item.id} key={k} />\n        ))}\n      </ul>\n    </div>\n  );\n};\n\ntype propsType = {|\n  changesetId: string,\n  changes: Object\n|};\n\nconst GeometryChangesComponent = ({ changesetId, changes }: propsType) => {\n  const [changeReport, setChangeReport] = useState([]);\n  const [openAll, setOpenAll] = useState(false);\n\n  useEffect(() => {\n    const newChangeReport = [];\n    if (changes && changes.get(changesetId)) {\n      const changesetData = changes.get(changesetId)['featureMap'];\n      const processed = processFeatures(getFeatures(changesetData));\n      processed.forEach((featureIDs, tag) =>\n        newChangeReport.push([tag, featureIDs])\n      );\n      setChangeReport(\n        newChangeReport.filter(changeType => changeType[1].length)\n      );\n    }\n  }, [changes, changesetId]);\n\n  return (\n    <div className=\"px12 py6\">\n      <div className=\"pb6\">\n        <h2 className=\"inline txt-m txt-uppercase txt-bold mr6 mb3\">\n          Geometry Changes\n        </h2>\n        {changeReport.length ? (\n          <OpenAll isActive={openAll} setOpenAll={setOpenAll} />\n        ) : null}\n      </div>\n      {changes.get(changesetId) ? (\n        changeReport.length ? (\n          changeReport.map((change, k) => (\n            <GeometryChangesItem\n              key={k}\n              tag={change[0]}\n              features={change[1]}\n              opened={openAll}\n            />\n          ))\n        ) : (\n          <span>No geometry changes in this changeset.</span>\n        )\n      ) : (\n        <Loading className=\"pt18\" />\n      )}\n    </div>\n  );\n};\n\nexport const GeometryChanges = connect((state: RootStateType, props) => ({\n  changes: state.changeset.get('changesetMap')\n}))(GeometryChangesComponent);\n","import React from 'react';\n\nexport const Box = ({ children, pullDown, pullUp, className, style, bg }) => (\n  <div className={`mb3 z4 bg-gray-faint ${className} `} style={style}>\n    <div\n      className={`${bg} scroll-styled scroll-auto hmax360`}\n      style={{ minHeight: '248px' }}\n    >\n      {children}\n    </div>\n  </div>\n);\n","// @flow\nimport React from 'react';\nimport { Map, List } from 'immutable';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { postComment } from '../../network/changeset';\nimport { Button } from '../button';\n\ntype propsType = {\n  token: string,\n  changesetId: number,\n  userDetails: Map<string, any>,\n  changesetIsHarmful: boolean,\n  discussions: List<*>\n};\n\nexport class CommentForm extends React.PureComponent<any, propsType, any> {\n  postCommentPromise;\n\n  state = {\n    success: false,\n    error: false,\n    value: ''\n  };\n\n  componentWillUnmount() {\n    this.postCommentPromise && this.postCommentPromise.cancel();\n  }\n  componentDidMount() {\n    this.updateValue(this.props);\n  }\n  componentWillReceiveProps(nextProps) {\n    this.updateValue(nextProps);\n  }\n  updateValue(props) {\n    const userCommentedBefore =\n      props.discussions.filter(\n        item => item.get('userName') === props.userDetails.get('username')\n      ).size > 0;\n    if (\n      this.state.value === '' &&\n      props.changesetIsHarmful !== null &&\n      !userCommentedBefore\n    ) {\n      if (props.changesetIsHarmful) {\n        this.setState({ value: props.userDetails.get('message_bad') });\n      } else {\n        this.setState({ value: props.userDetails.get('message_good') });\n      }\n    }\n  }\n  onChange = (event: any) => {\n    this.setState({ value: event.target.value });\n    if (this.state.error) {\n      this.setState({ error: false });\n    }\n    if (this.state.success) {\n      this.setState({ success: false });\n    }\n  };\n  postComment = (comment: string) => {\n    if (!comment) return;\n    this.postCommentPromise = cancelablePromise(\n      postComment(this.props.changesetId, this.props.token, comment)\n    );\n    this.postCommentPromise.promise\n      .then(r => {\n        this.setState({ success: true });\n        this.setState({ error: false });\n        this.setState({ value: '' });\n      })\n      .catch(e => {\n        console.log(e);\n        this.setState({ error: true });\n        this.setState({ success: false });\n      });\n  };\n  handleSubmit = event => {\n    this.postComment(this.state.value);\n  };\n  render() {\n    return (\n      <div>\n        {this.props.token && (\n          <div className=\"flex-parent flex-parent--column mt6 mb3\">\n            {this.state.success && (\n              <div className=\"bg-green-faint color-green inline-block px6 py3 txt-s align-center round my12\">\n                <strong>Comment successfully posted.</strong>\n                <br />\n                <span>It will appear on OSMCha after some minutes.</span>\n              </div>\n            )}\n            {this.state.error && (\n              <div className=\"bg-red-faint color-red-dark inline-block px6 py3 txt-s align-center round my12\">\n                <strong>It was not possible to post your comment.</strong>\n              </div>\n            )}\n            <div className=\"grid grid--gut12\">\n              <div className=\"col col--12\">\n                <textarea\n                  placeholder=\"Provide constructive feedback to the mapper with a changeset comment.\"\n                  className=\"textarea\"\n                  ref={r => {\n                    if (this.clicked) {\n                      r && r.select();\n                      this.clicked = false;\n                    }\n                  }}\n                  value={this.state.value}\n                  onChange={this.onChange}\n                />\n                <div className=\"pt6 fr\">\n                  <Button className=\"input wmax120\" onClick={this.handleSubmit}>\n                    Post Comment\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { formatDistanceToNow, parse } from 'date-fns';\nimport AnchorifyText from 'react-anchorify-text';\n\nimport AssemblyAnchor from '../assembly_anchor';\nimport { CommentForm } from './comment';\nimport TranslateButton from './translate_button';\nimport { SignInButton } from './sign_in_button';\nimport { UserOSMLink } from './user_osm_link';\n\nclass Discussions extends React.PureComponent {\n  props: {\n    discussions: List<*>,\n    changesetId: number,\n    changesetAuthor: string,\n    changesetIsHarmful: boolean\n  };\n\n  renderComments() {\n    const { discussions, changesetAuthor } = this.props;\n\n    if (discussions.size === 0) {\n      return (\n        <div className=\"flex-parent flex-parent--column flex-parent--center-cross mb12\">\n          <svg className=\"icon icon--xxl color-darken25\">\n            <use xlinkHref=\"#icon-contact\" />\n          </svg>\n          <p className=\"txt-m\">{'No discussions, yet.'}</p>\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"\">\n          {discussions.map((comment, i) => (\n            <div\n              key={i}\n              className=\"flex-parent flex-parent--column justify--space-between border border--gray-light round p6 my6 mt12\"\n            >\n              <div className=\"flex-parent flex-parent--row justify--space-between txt-s \">\n                <span>\n                  By{' '}\n                  <strong>\n                    <UserOSMLink\n                      userName={comment.get('user')}\n                      linkClasses={'txt-underline-on-hover pointer'}\n                    >\n                      {comment.get('user')}\n                    </UserOSMLink>{' '}\n                  </strong>\n                  {changesetAuthor === comment.get('user') && (\n                    <span style={{ color: '#aaa' }}>(changeset author)</span>\n                  )}\n                </span>\n                <span>\n                  {formatDistanceToNow(\n                    // eslint-disable-next-line\n                    parse(\n                      comment.get('date'),\n                      \"yyyy-MM-dd'T'HH:mm:ssX\",\n                      new Date()\n                    ),\n                    { addSuffix: true }\n                  )}\n                </span>\n              </div>\n              <div className=\"flex-parent flex-parent--column mt6 mb3\">\n                <p className=\"txt-break-url\">\n                  <AnchorifyText text={comment.get('text')}>\n                    <AssemblyAnchor />\n                  </AnchorifyText>\n                </p>\n              </div>\n              <div className=\"flex-parent justify--flex-end\">\n                <TranslateButton text={comment.get('text')} />\n              </div>\n            </div>\n          ))}\n        </div>\n      );\n    }\n  }\n  render() {\n    const {\n      discussions,\n      changesetId,\n      changesetIsHarmful,\n      changesetAuthor\n    } = this.props;\n\n    return (\n      <div className=\"px12 py6\">\n        <h2 className=\"txt-m mr6 mb3\">\n          <span className=\"txt-uppercase txt-bold\">Discussions </span>\n          for changeset by {changesetAuthor}\n        </h2>\n        {this.props.token ? (\n          this.renderComments()\n        ) : (\n          <div>\n            <div className=\"flex-parent flex-parent--column flex-parent--center-cross mb12\">\n              <svg className=\"icon icon--xxl color-darken25\">\n                <use xlinkHref=\"#icon-contact\" />\n              </svg>\n            </div>\n            <div className=\"flex-parent flex-parent--inline flex-parent--center-main mt6 mb3\">\n              <SignInButton text=\"Sign in to read and post comments\" />\n            </div>\n          </div>\n        )}\n        {this.props.token && (\n          <div className=\"flex-parent flex-parent--column justify--space-between my6 mt12\">\n            <CommentForm\n              changesetId={changesetId}\n              changesetIsHarmful={changesetIsHarmful}\n              discussions={discussions}\n              token={this.props.token}\n              userDetails={this.props.userDetails}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nDiscussions = connect((state: RootStateType) => ({\n  token: state.auth.get('token'),\n  userDetails: state.auth.get('userDetails')\n}))(Discussions);\n\nexport { Discussions };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\n\nimport { importChangesetMap } from '../../utils/cmap';\nimport { updateStyle } from '../../store/map_controls_actions';\nimport { Dropdown } from '../dropdown';\n\nclass MapOptions extends React.PureComponent {\n  state = {\n    actions: true,\n    type: true,\n    mapStyle: true,\n    user: true\n  };\n  layerOptions = [\n    {\n      label: 'Mapbox Satellite',\n      value: 'satellite',\n      function: () => this.toggleSatellite()\n    },\n    {\n      label: 'Mapbox Streets',\n      value: 'streets',\n      function: () => this.toggleStreet()\n    },\n    { label: 'Mapbox Dark', value: 'dark', function: () => this.toggleDark() },\n    { label: 'Bing', value: 'bing', function: () => this.toggleBing() },\n    {\n      label: 'OpenStreetMap Carto',\n      value: 'carto',\n      function: () => this.toggleOsm()\n    }\n  ];\n  getLayerDropdownDisplay = id => {\n    const filteredLayer = this.layerOptions.filter(l => l.value === id);\n    if (filteredLayer.length) return filteredLayer[0].label;\n    return 'Select a style';\n  };\n  onLayerChange = layer => {\n    if (layer && layer.length) {\n      layer[0].function();\n      this.props.updateStyle(layer[0].value);\n    }\n  };\n  onChange = () => {\n    importChangesetMap('getMapInstance').then(\n      r => r && r() && r().filterLayers()\n    );\n  };\n  toggleSatellite = () => {\n    importChangesetMap('getMapInstance').then(\n      r =>\n        r &&\n        r() &&\n        r().renderMap('mapbox://styles/openstreetmap/cjnd8lj0e10i42spfo4nsvoay')\n    );\n  };\n  toggleDark = () => {\n    importChangesetMap('getMapInstance').then(\n      r => r && r() && r().renderMap('mapbox://styles/mapbox/dark-v9')\n    );\n  };\n  toggleStreet = () => {\n    importChangesetMap('getMapInstance').then(\n      r => r && r() && r().renderMap('mapbox://styles/mapbox/streets-v9')\n    );\n  };\n  toggleBing = () => {\n    const bingStyle = {\n      version: 8,\n      sources: {\n        'bing-tiles': {\n          type: 'raster',\n          tiles: [\n            'https://ecn.t0.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z',\n            'https://ecn.t1.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z',\n            'https://ecn.t2.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z',\n            'https://ecn.t3.tiles.virtualearth.net/tiles/a{quadkey}.jpeg?g=587&mkt=en-gb&n=z'\n          ],\n          attribution:\n            '© <a href=\"https://blog.openstreetmap.org/2010/11/30/microsoft-imagery-details\">Microsoft Corporation</a>'\n        }\n      },\n      layers: [\n        {\n          id: 'bing',\n          type: 'raster',\n          source: 'bing-tiles',\n          minzoom: 0,\n          maxzoom: 22\n        }\n      ]\n    };\n    importChangesetMap('getMapInstance').then(\n      r => r && r() && r().renderMap(bingStyle)\n    );\n  };\n  toggleOsm = () => {\n    const osmStyle = {\n      version: 8,\n      sources: {\n        'osm-tiles': {\n          type: 'raster',\n          tiles: [\n            'https://a.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            'https://b.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            'https://c.tile.openstreetmap.org/{z}/{x}/{y}.png'\n          ],\n          tileSize: 256,\n          attribution:\n            '© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n        }\n      },\n      layers: [\n        {\n          id: 'osm',\n          type: 'raster',\n          source: 'osm-tiles',\n          minzoom: 0,\n          maxzoom: 22\n        }\n      ]\n    };\n    importChangesetMap('getMapInstance').then(\n      r => r && r() && r().renderMap(osmStyle)\n    );\n  };\n  render() {\n    return (\n      <div className=\"px12 py6\">\n        <h2 className=\"txt-m txt-uppercase txt-bold mr6 mb3\">Map Controls</h2>\n        <section className=\"cmap-filter-action-section cmap-pt3\">\n          <h6 className=\"cmap-heading pointer txt-bold\">Filter by actions</h6>\n\n          <ul className=\"cmap-hlist\">\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"added\"\n                  defaultChecked=\"true\"\n                  id=\"cmap-layer-selector-added\"\n                  onChange={this.onChange}\n                />\n                <span className=\"cmap-label-text\">Added</span>\n                <span className=\"cmap-color-box cmap-color-added\" />\n              </label>\n            </li>\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"modified\"\n                  defaultChecked=\"true\"\n                  onChange={this.onChange}\n                  id=\"cmap-layer-selector-modified\"\n                />\n                <span className=\"cmap-label-text\">Modified</span>\n                <span className=\"cmap-color-box cmap-color-modified-old\" />\n                <span className=\"cmap-unicode\">→</span>\n                <span className=\"cmap-color-box cmap-color-modified-new\" />\n              </label>\n            </li>\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"deleted\"\n                  defaultChecked=\"true\"\n                  onChange={this.onChange}\n                  id=\"cmap-layer-selector-deleted\"\n                />\n                <span className=\"cmap-label-text\">Deleted</span>\n                <span className=\"cmap-color-box cmap-color-deleted\" />\n              </label>\n            </li>\n          </ul>\n        </section>\n        <section className=\"cmap-filter-type-section\">\n          <h6 className=\"cmap-heading pointer txt-bold\">Filter by type</h6>\n          <ul className=\"cmap-hlist\">\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"nodes\"\n                  defaultChecked=\"true\"\n                  id=\"cmap-type-selector-nodes\"\n                  onChange={this.onChange}\n                />\n                <span className=\"cmap-label-text\">Nodes</span>\n              </label>\n            </li>\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"ways\"\n                  defaultChecked=\"true\"\n                  id=\"cmap-type-selector-ways\"\n                  onChange={this.onChange}\n                />\n                <span className=\"cmap-label-text\">Ways</span>\n              </label>\n            </li>\n            <li>\n              <label className=\"cmap-hlist-item cmap-noselect cmap-pointer\">\n                <input\n                  type=\"checkbox\"\n                  value=\"relations\"\n                  defaultChecked=\"true\"\n                  id=\"cmap-type-selector-relations\"\n                  onChange={this.onChange}\n                />\n                <span className=\"cmap-label-text\">Relations</span>\n              </label>\n            </li>\n          </ul>\n        </section>\n        <section className=\"cmap-map-style-section cmap-pb3\">\n          <h6 className=\"cmap-heading pointer txt-bold\">Map style</h6>\n          <Dropdown\n            eventTypes={['click', 'touchend']}\n            value={this.props.style}\n            onAdd={() => {}}\n            onRemove={() => {}}\n            options={this.layerOptions}\n            onChange={this.onLayerChange}\n            display={this.getLayerDropdownDisplay(this.props.style)}\n            position=\"left\"\n          />\n        </section>\n      </div>\n    );\n  }\n}\n\nMapOptions = connect(\n  (state: RootStateType, props) => ({ style: state.mapControls.get('style') }),\n  { updateStyle }\n)(MapOptions);\n\nexport { MapOptions };\n","import React from 'react';\n\nexport function Control({ active, onClick, children, className }: Object) {\n  return (\n    <span\n      className={`${className} mx6 cursor-pointer txt-s inline-block txt-bold round p6 transition color-darken75\n         ${active ? 'bg-gray-faint' : 'bg-white-on-hover bg-lighten50'}`}\n      onClick={onClick}\n    >\n      {children}\n    </span>\n  );\n}\n","// @flow\n\nexport const FILTER_BINDING = {\n  label: 'FILTER_BINDING',\n  bindings: ['\\\\']\n};\nexport const HELP_BINDING = {\n  label: 'HELP_BINDING',\n  bindings: ['/', '?']\n};\nexport const NEXT_CHANGESET = {\n  label: 'NEXT_CHANGESET',\n  bindings: ['down', 'right']\n};\nexport const PREV_CHANGESET = {\n  label: 'PREV_CHANGESET',\n  bindings: ['up', 'left']\n};\nexport const REFRESH_CHANGESETS = {\n  label: 'REFRESH_CHANGESETS',\n  bindings: ['R', 'r']\n};\nexport const CHANGESET_DETAILS_SHOW_ALL = {\n  label: 'CHANGESET_DETAILS_SHOW_ALL',\n  bindings: ['0']\n};\nexport const CHANGESET_DETAILS_DETAILS = {\n  label: 'CHANGESET_DETAILS_DETAILS',\n  bindings: ['1']\n};\nexport const CHANGESET_DETAILS_SUSPICIOUS = {\n  label: 'CHANGESET_DETAILS_SUSPICIOUS',\n  bindings: ['2']\n};\nexport const CHANGESET_DETAILS_TAGS = {\n  label: 'CHANGESET_DETAILS_TAGS',\n  bindings: ['3']\n};\nexport const CHANGESET_DETAILS_GEOMETRY_CHANGES = {\n  label: 'CHANGESET_DETAILS_GEOMETRY_CHANGES',\n  bindings: ['4']\n};\nexport const CHANGESET_DETAILS_OTHER_FEATURES = {\n  label: 'CHANGESET_DETAILS_OTHER_FEATURES',\n  bindings: ['5']\n};\nexport const CHANGESET_DETAILS_DISCUSSIONS = {\n  label: 'CHANGESET_DETAILS_DISCUSSIONS',\n  bindings: ['6']\n};\nexport const CHANGESET_DETAILS_USER = {\n  label: 'CHANGESET_DETAILS_USER',\n  bindings: ['7']\n};\nexport const CHANGESET_DETAILS_MAP = {\n  label: 'CHANGESET_DETAILS_MAP',\n  bindings: ['8']\n};\nexport const VERIFY_GOOD = {\n  label: 'VERIFY_GOOD',\n  bindings: ['G', 'g']\n};\nexport const VERIFY_BAD = {\n  label: 'VERIFY_BAD',\n  bindings: ['B', 'b']\n};\nexport const VERIFY_CLEAR = {\n  label: 'VERIFY_CLEAR',\n  bindings: ['C', 'c', 'u', 'U']\n};\nexport const OPEN_IN_JOSM = {\n  label: 'OPEN_IN_JOSM',\n  bindings: ['J', 'j']\n};\nexport const OPEN_IN_ID = {\n  label: 'OPEN_IN_ID',\n  bindings: ['I', 'i']\n};\nexport const OPEN_IN_OSM = {\n  label: 'OPEN_IN_OSM',\n  bindings: ['O', 'o']\n};\nexport const OPEN_IN_LEVEL0 = {\n  label: 'OPEN_IN_LEVEL0',\n  bindings: ['L', 'l']\n};\nexport const OPEN_IN_ACHAVI = {\n  label: 'OPEN_IN_ACHAVI',\n  bindings: ['V', 'v']\n};\nexport const OPEN_IN_HDYC = {\n  label: 'OPEN_IN_HDYC',\n  bindings: ['H', 'h']\n};\nexport const FILTER_BY_USER = {\n  label: 'FILTER_BY_USER',\n  bindings: ['A', 'a']\n};\n","import React from 'react';\n\nimport { Control } from './control';\nimport { Floater } from './floater';\n\nimport {\n  CHANGESET_DETAILS_DETAILS,\n  CHANGESET_DETAILS_SUSPICIOUS,\n  CHANGESET_DETAILS_TAGS,\n  CHANGESET_DETAILS_GEOMETRY_CHANGES,\n  CHANGESET_DETAILS_OTHER_FEATURES,\n  CHANGESET_DETAILS_USER,\n  CHANGESET_DETAILS_DISCUSSIONS,\n  CHANGESET_DETAILS_MAP\n} from '../../config/bindings';\n\nexport function ControlLayout({\n  bindingsState,\n  features,\n  discussions,\n  toggleDetails,\n  toggleFeatures,\n  toggleOtherFeatures,\n  toggleGeometryChanges,\n  toggleTags,\n  toggleDiscussions,\n  toggleUser,\n  toggleMapOptions\n}) {\n  return (\n    <Floater\n      style={{\n        marginTop: 8,\n        marginLeft: 5\n      }}\n    >\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_DETAILS.label)}\n        onClick={toggleDetails}\n        className=\"unround-r unround-bl\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle \">\n          <use xlinkHref=\"#icon-eye\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_SUSPICIOUS.label)}\n        onClick={toggleFeatures}\n        className=\"unround\"\n      >\n        <svg\n          className={`icon h18 w18 inline-block align-middle ${\n            features && features.size === 0 ? 'color-darken25' : 'color-black'\n          }`}\n        >\n          <use xlinkHref=\"#icon-alert\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_TAGS.label)}\n        onClick={toggleTags}\n        className=\"unround\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle\">\n          <use xlinkHref=\"#icon-hash\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_GEOMETRY_CHANGES.label)}\n        onClick={toggleGeometryChanges}\n        className=\"unround\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle\">\n          <use xlinkHref=\"#icon-point-line\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_OTHER_FEATURES.label)}\n        onClick={toggleOtherFeatures}\n        className=\"unround\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle\">\n          <use xlinkHref=\"#icon-plus\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_DISCUSSIONS.label)}\n        onClick={toggleDiscussions}\n        className=\"unround\"\n      >\n        <svg\n          className={`icon h18 w18 inline-block align-middle ${\n            discussions.size === 0 ? 'color-darken25' : 'color-black'\n          }`}\n        >\n          <use xlinkHref=\"#icon-contact\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_USER.label)}\n        onClick={toggleUser}\n        className=\"unround\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle\">\n          <use xlinkHref=\"#icon-user\" />\n        </svg>\n      </Control>\n      <Control\n        active={bindingsState.get(CHANGESET_DETAILS_MAP.label)}\n        onClick={toggleMapOptions}\n        className=\"unround-r unround-tl\"\n      >\n        <svg className=\"icon h18 w18 inline-block align-middle\">\n          <use xlinkHref=\"#icon-map\" />\n        </svg>\n      </Control>\n    </Floater>\n  );\n}\n","// @flow\nimport React from 'react';\nimport Mousetrap from 'mousetrap';\nimport { Map } from 'immutable';\n\nimport { getDisplayName } from '../utils/component';\n\ntype stateType = {\n  bindings: Map<string, *>,\n  lastKeyStroke: Map<string, *>\n};\n\n/**\n * @param exclusive - flag to toggle one key and switch off all other keys\n * @prop `bindingsState` - immutable Map containing toggleState(true/false) for each of the bindings. \n * @prop `lastKeyStroke` - immutable Map containg the state of last key pressed only.\n */\nexport function keyboardToggleEnhancer<P: {}, S: {}>(\n  exclusive: boolean,\n  bindings: Array<{ label: string, bindings: Array<string> }>,\n  WrappedComponent: Class<React.PureComponent<*, P, S>>\n): Class<React.PureComponent<void, P, stateType>> {\n  return class wrapper extends React.PureComponent<void, P, stateType> {\n    static displayName = `HOCKeyboard${getDisplayName(WrappedComponent)}`;\n\n    state = {\n      bindings: Map(),\n      lastKeyStroke: Map()\n    };\n    componentDidMount() {\n      bindings.forEach(item =>\n        Mousetrap.bind(item.bindings, (e: Event) => {\n          e.preventDefault();\n          if (exclusive) {\n            return this.exclusiveKeyToggle(item.label);\n          }\n          this.toggleKey(item.label);\n        })\n      );\n    }\n\n    componentWillUnmount() {\n      // unbind all bindings\n      bindings.forEach(item =>\n        item.bindings.forEach(b => {\n          Mousetrap.unbind(b);\n        })\n      );\n    }\n\n    // allow toggling the state of a particular key\n    toggleKey = (label: string) => {\n      let prev = this.state.bindings;\n      let lastKeyStroke = Map().set(label, !prev.get(label));\n      prev = prev.set(label, !prev.get(label));\n      this.setState({\n        bindings: prev,\n        lastKeyStroke\n      });\n    };\n\n    // exclusively toggle this label and switch off others\n    exclusiveKeyToggle = (label: string) => {\n      let newBindingState = Map();\n      const prevBindingValue = this.state.bindings.get(label);\n      newBindingState = newBindingState.set(label, !prevBindingValue);\n      this.setState({\n        bindings: newBindingState,\n        lastKeyStroke: newBindingState // will be same as state.bindings as size=1\n      });\n    };\n\n    render() {\n      return (\n        <WrappedComponent\n          {...this.props}\n          bindingsState={this.state.bindings}\n          lastKeyStroke={this.state.lastKeyStroke}\n          toggleKey={this.toggleKey}\n          exclusiveKeyToggle={this.exclusiveKeyToggle}\n        />\n      );\n    }\n  };\n}\n","// @flow\nimport React from 'react';\nimport { Map, fromJS } from 'immutable';\nimport debounce from 'lodash.debounce';\nimport { getDisplayName } from '../utils/component';\n\ntype stateType = {\n  data: Map<string, *>\n};\n\n/**\n * @desc If any network request fails it silents it \n * It also sets state on first come first serve basis.\n * @param  onUpdate - decides whether to do the network calls on not\n */\nexport function withFetchDataSilent<P: {}, S: {}>(\n  dataToFetch: (props: P) => Object,\n  onUpdate: (P, P) => boolean,\n  WrappedComponent: Class<React.PureComponent<*, P, S>>\n): Class<React.PureComponent<void, P, stateType>> {\n  return class FetchDataEnhancer extends React.PureComponent<\n    void,\n    P,\n    stateType\n  > {\n    static displayName = `HOCFetchData${getDisplayName(WrappedComponent)}`;\n    state = {\n      data: Map()\n    };\n    fetchedData: Object;\n    initFetching: (props: P) => void;\n    constructor(props) {\n      super(props);\n      this.initFetching = debounce(this._initFetching, 500);\n    }\n    componentDidMount() {\n      this.initFetching(this.props);\n    }\n    componentWillReceiveProps(nextProps: P) {\n      if (onUpdate(nextProps, this.props)) {\n        this.initFetching(nextProps);\n      }\n    }\n    _initFetching = (props: P) => {\n      this.fetchedData = dataToFetch(props);\n      // iterate through all of cancelable promises, one for each api request\n      Object.keys(this.fetchedData).forEach(k => {\n        var prom = this.fetchedData[k];\n        prom.promise\n          .then(x => {\n            let data = this.state.data;\n            data = data.set(k, fromJS(x));\n            this.setState({ data });\n          })\n          .catch(e => console.error(e));\n      });\n    };\n    reloadData = () => {\n      this.initFetching(this.props);\n    };\n    componentWillUnmount() {\n      this.fetchedData &&\n        Object.keys(this.fetchedData).forEach(k => {\n          this.fetchedData[k] && this.fetchedData[k].cancel();\n        });\n    }\n    render() {\n      return (\n        <WrappedComponent\n          {...this.props}\n          data={this.state.data}\n          reloadData={this.reloadData}\n        />\n      );\n    }\n  };\n}\n","import { fromJS, Map } from 'immutable';\nimport { apiOSM } from '../config/constants';\nimport { API_URL } from '../config';\n\nexport function getUserDetails(uid: number, token: string): Map<'string', *> {\n  const user = { uid: uid };\n  const fromOSM = fetch(`${apiOSM}/user/${uid}.json`, {\n    method: 'GET',\n    headers: { 'Content-Type': 'application/json' }\n  })\n    .then(r => r.json())\n    .then(r => {\n      const u = r.user;\n      user.count = u.changesets.count;\n      user.accountCreated = u.account_created;\n      user.description = u.description;\n      user.img = u.img && u.img.href;\n      user.name = u.display_name;\n      return fromJS(user);\n    })\n    .catch(e => user);\n\n  const fromOSMCha = fetch(`${API_URL}/user-stats/${uid}/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(r => r.json())\n    .then(r => fromJS(r))\n    .catch(e => new Map());\n\n  return Promise.all([fromOSMCha, fromOSM]).then(([r1, r2]) => r1.merge(r2));\n}\n","import { whosThat } from '../config/constants';\nimport { handleErrors } from './aoi';\n\nexport function getUsers(input): Promise<*> {\n  return fetch(`${whosThat}${input}`, {\n    method: 'GET'\n  })\n    .then(handleErrors)\n    .then(response => {\n      return response.json();\n    });\n}\n","// @flow\nimport { Map, List, fromJS } from 'immutable';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport CSSGroup from 'react-transition-group/CSSTransitionGroup';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { Floater } from './floater';\nimport { Header } from './header';\nimport { User } from './user';\nimport { Features } from './features';\nimport { TagChanges } from './tag_changes';\nimport { OtherFeatures } from './other_features';\nimport { GeometryChanges } from './geometry_changes';\nimport { Box } from './box';\nimport { Discussions } from './discussions';\nimport { MapOptions } from './map_options';\nimport { ControlLayout } from './control_layout';\nimport { keyboardToggleEnhancer } from '../keyboard_enhancer';\nimport { withFetchDataSilent } from '../fetch_data_enhancer';\nimport { getUserDetails } from '../../network/openstreetmap';\nimport { getUsers } from '../../network/whosthat';\nimport {\n  CHANGESET_DETAILS_DETAILS,\n  CHANGESET_DETAILS_SUSPICIOUS,\n  CHANGESET_DETAILS_TAGS,\n  CHANGESET_DETAILS_GEOMETRY_CHANGES,\n  CHANGESET_DETAILS_OTHER_FEATURES,\n  CHANGESET_DETAILS_USER,\n  CHANGESET_DETAILS_DISCUSSIONS,\n  CHANGESET_DETAILS_MAP\n} from '../../config/bindings';\n\n// | denote strict props\ntype propsType = {|\n  changesetId: number,\n  currentChangeset: Map<string, any>,\n  // The props below come from HOCs, they are not optional!\n  // to circumvent the $Diff bug  ref: https://github.com/facebook/flow/issues/1601\n  // have to make them optional for flow to not throw error.\n  data?: Map<string, *>,\n  bindingsState?: Map<string, ?boolean>,\n  exclusiveKeyToggle?: (label: string) => any\n|};\n\n// presentational component for view/changeset.js\nexport class _Changeset extends React.PureComponent<*, propsType, *> {\n  getUserDetailsPromise;\n  getWhosThatPromise;\n\n  state = {\n    userDetails: null,\n    whosThat: null\n  };\n\n  static defaultProps = {\n    data: Map()\n  };\n  componentDidMount() {\n    this.toggleDetails();\n  }\n  componentDidUpdate(prevProps) {\n    if (\n      !prevProps.currentChangeset.getIn(['properties', 'uid']) &&\n      this.props.currentChangeset.getIn(['properties', 'uid'])\n    ) {\n      this.getUserDetailsPromise = cancelablePromise(\n        getUserDetails(\n          this.props.currentChangeset.getIn(['properties', 'uid'], null),\n          this.props.token\n        )\n      );\n      this.getUserDetailsPromise.promise\n        .then(r => {\n          this.setState({ userDetails: r });\n        })\n        .catch(e => console.log(e));\n\n      this.getWhosThatPromise = cancelablePromise(\n        getUsers(this.props.currentChangeset.getIn(['properties', 'uid'], ''))\n      );\n      this.getWhosThatPromise.promise\n        .then(r => {\n          this.setState({ whosThat: List(r[0].names) });\n        })\n        .catch(e => console.log(e));\n    }\n  }\n  showFloaters = () => {\n    const { changesetId, currentChangeset, bindingsState, data } = this.props;\n    if (!bindingsState || !data) return;\n    const properties = currentChangeset.get('properties');\n    return (\n      <CSSGroup\n        name=\"floaters\"\n        transitionName=\"floaters\"\n        transitionAppearTimeout={300}\n        transitionAppear={true}\n        transitionEnterTimeout={300}\n        transitionLeaveTimeout={250}\n      >\n        {bindingsState.get(CHANGESET_DETAILS_DETAILS.label) && (\n          <Box key={3} className=\" responsive-box round-tr round-br\">\n            <Header\n              toggleUser={this.toggleUser}\n              changesetId={changesetId}\n              properties={properties}\n              userEditCount={\n                this.state.userDetails != null\n                  ? this.state.userDetails.get('count')\n                  : 0 || data.getIn(['userDetails', 'count'], 0)\n              }\n            />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_SUSPICIOUS.label) && (\n          <Box key={2} className=\" responsive-box round-tr round-br\">\n            <Features changesetId={changesetId} properties={properties} />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_TAGS.label) && (\n          <Box key={5} className=\" responsive-box round-tr round-br\">\n            <TagChanges changesetId={changesetId} />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_GEOMETRY_CHANGES.label) && (\n          <Box key={5} className=\" responsive-box round-tr round-br\">\n            <GeometryChanges changesetId={changesetId} />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_OTHER_FEATURES.label) && (\n          <Box key={5} className=\" responsive-box round-tr round-br\">\n            <OtherFeatures changesetId={changesetId} />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_DISCUSSIONS.label) && (\n          <Box key={1} className=\" responsive-box  round-tr round-br\">\n            <Discussions\n              changesetAuthor={currentChangeset.get('properties').get('user')}\n              discussions={\n                this.props.osmInfo\n                  ? this.props.osmInfo.getIn(['changeset', 'comments'])\n                  : List()\n              }\n              changesetIsHarmful={properties.get('harmful')}\n              changesetId={changesetId}\n            />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_USER.label) && (\n          <Box key={0} className=\"responsive-box round-tr round-br\">\n            <User\n              userDetails={\n                data.getIn(['userDetails', 'name'])\n                  ? data.getIn(['userDetails'], Map())\n                  : Map([\n                      [\n                        'uid',\n                        this.props.currentChangeset.getIn(['properties', 'uid'])\n                      ],\n                      [\n                        'name',\n                        this.props.currentChangeset.getIn([\n                          'properties',\n                          'user'\n                        ])\n                      ],\n                      [\n                        'harmful_changesets',\n                        data.getIn(['userDetails', 'harmful_changesets'])\n                      ],\n                      [\n                        'checked_changesets',\n                        data.getIn(['userDetails', 'checked_changesets'])\n                      ],\n                      [\n                        'changesets_in_osmcha',\n                        data.getIn(['userDetails', 'changesets_in_osmcha'])\n                      ]\n                    ])\n              }\n              whosThat={\n                data.getIn(['userDetails', 'name'])\n                  ? data.getIn(['whosThat', 0, 'names'], List())\n                  : this.state.whosThat || List()\n              }\n              changesetUsername\n            />\n          </Box>\n        )}\n        {bindingsState.get(CHANGESET_DETAILS_MAP.label) && (\n          <Box key={4} className=\"responsive-box round-tr round-br\">\n            <MapOptions />\n          </Box>\n        )}\n      </CSSGroup>\n    );\n  };\n\n  toggleFeatures = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_SUSPICIOUS.label);\n  };\n  toggleOtherFeatures = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_OTHER_FEATURES.label);\n  };\n  toggleTags = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_TAGS.label);\n  };\n  toggleGeometryChanges = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_GEOMETRY_CHANGES.label);\n  };\n  toggleDiscussions = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_DISCUSSIONS.label);\n  };\n  toggleDetails = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_DETAILS.label);\n  };\n  toggleUser = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_USER.label);\n  };\n  toggleMapOptions = () => {\n    this.props.exclusiveKeyToggle &&\n      this.props.exclusiveKeyToggle(CHANGESET_DETAILS_MAP.label);\n  };\n\n  render() {\n    const { bindingsState, currentChangeset } = this.props;\n    const features = currentChangeset.getIn(['properties', 'features']);\n    return (\n      <div className=\"flex-child clip\">\n        <ControlLayout\n          toggleDetails={this.toggleDetails}\n          toggleFeatures={this.toggleFeatures}\n          toggleOtherFeatures={this.toggleOtherFeatures}\n          toggleTags={this.toggleTags}\n          toggleGeometryChanges={this.toggleGeometryChanges}\n          toggleDiscussions={this.toggleDiscussions}\n          toggleUser={this.toggleUser}\n          toggleMapOptions={this.toggleMapOptions}\n          features={features}\n          bindingsState={bindingsState}\n          discussions={\n            this.props.osmInfo\n              ? this.props.osmInfo.getIn(['changeset', 'comments'])\n              : List()\n          }\n        />\n        <Floater style={{ marginTop: 5, marginLeft: 41 }}>\n          {this.showFloaters()}\n        </Floater>\n      </div>\n    );\n  }\n}\n\nlet Changeset = keyboardToggleEnhancer(\n  true,\n  [\n    CHANGESET_DETAILS_DETAILS,\n    CHANGESET_DETAILS_SUSPICIOUS,\n    CHANGESET_DETAILS_TAGS,\n    CHANGESET_DETAILS_GEOMETRY_CHANGES,\n    CHANGESET_DETAILS_OTHER_FEATURES,\n    CHANGESET_DETAILS_USER,\n    CHANGESET_DETAILS_DISCUSSIONS,\n    CHANGESET_DETAILS_MAP\n  ],\n  _Changeset\n);\n\n/**\n * Never use props not required by the Basecomponent in HOCs\n */\nChangeset = withFetchDataSilent(\n  (props: propsType) => ({\n    userDetails: cancelablePromise(\n      getUserDetails(\n        props.currentChangeset.getIn(['properties', 'uid'], null),\n        props.token\n      )\n    ),\n    whosThat: cancelablePromise(\n      getUsers(props.currentChangeset.getIn(['properties', 'uid'], ''))\n    )\n  }),\n  (nextProps: propsType, props: propsType) =>\n    props.changesetId !== nextProps.changesetId,\n  Changeset\n);\n\nChangeset = connect((state: RootStateType, props) => ({\n  token: state.auth.get('token'),\n  osmInfo: fromJS(state.changeset.getIn(['changesetMap', props.changesetId]))\n}))(Changeset);\n\nexport { Changeset };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map, fromJS } from 'immutable';\nimport Mousetrap from 'mousetrap';\n\nimport { Changeset as ChangesetDumb } from '../components/changeset';\n\nimport { dispatchEvent } from '../utils/dispatch_event';\n\nimport { applyFilters } from '../store/filters_actions';\nimport { FILTER_BY_USER } from '../config/bindings';\nimport type { RootStateType } from '../store';\n\nclass Changeset extends React.PureComponent {\n  props: {\n    errorChangeset: ?Object, // error of the latest that changeset failed\n    location: Object,\n    loading: boolean, // loading of the selected changesetId\n    currentChangeset?: Map<string, *>,\n    changesetId: number,\n    token: string,\n    applyFilters: (Map<string, *>) => mixed // base 0\n  };\n  componentDidMount() {\n    Mousetrap.bind(FILTER_BY_USER.bindings, this.filterChangesetsByUser);\n  }\n  componentWillUnmount() {\n    FILTER_BY_USER.bindings.forEach(k => Mousetrap.unbind(k));\n  }\n  filterChangesetsByUser = () => {\n    if (this.props.currentChangeset) {\n      const userName = this.props.currentChangeset.getIn([\n        'properties',\n        'user'\n      ]);\n      this.props.applyFilters(\n        new Map().set(\n          'users',\n          fromJS([\n            {\n              label: userName,\n              value: userName\n            }\n          ])\n        )\n      );\n    }\n  };\n  showChangeset = () => {\n    const {\n      loading,\n      errorChangeset,\n      currentChangeset,\n      changesetId,\n      token\n    } = this.props;\n\n    if (loading || !currentChangeset) {\n      return null;\n    }\n\n    if (errorChangeset) {\n      dispatchEvent('showToast', {\n        title: `changeset:${changesetId} failed to load`,\n        content: 'Try reloading osmcha',\n        timeOut: 5000,\n        type: 'error'\n      });\n      console.error(errorChangeset);\n      return null;\n    }\n    return (\n      <ChangesetDumb\n        changesetId={changesetId}\n        currentChangeset={currentChangeset}\n        token={token}\n      />\n    );\n  };\n  render() {\n    return (\n      <div>\n        <div className=\"flex-parent flex-parent--column clip\">\n          {this.showChangeset()}\n        </div>\n      </div>\n    );\n  }\n}\n\nChangeset = connect(\n  (state: RootStateType, props) => ({\n    changeset: state.changeset,\n    location: props.location,\n    changesetId: parseInt(props.match.params.id, 10),\n    currentChangeset: state.changeset.getIn([\n      'changesets',\n      parseInt(props.match.params.id, 10)\n    ]),\n    errorChangeset: state.changeset.get('errorChangeset'),\n    loading: state.changeset.get('loading'),\n    token: state.auth.get('token')\n  }),\n  { applyFilters }\n)(Changeset);\n\nexport { Changeset };\n","// @flow\nimport React from 'react';\nimport showdown from 'showdown';\nimport DOMPurify from 'dompurify';\n\nimport { cancelablePromise } from '../utils/promise';\nimport { appVersion, isDev, isStaging, isLocal } from '../config';\n\nconst converter = new showdown.Converter({\n  ghCompatibleHeaderId: true,\n  extensions: formatMarkdown()\n});\n\nconverter.setFlavor('github');\nconverter.setOption('simpleLineBreaks', false);\n\nfunction formatMarkdown() {\n  return [\n    {\n      type: 'output',\n      regex: /a href=/g,\n      replace: 'a class=\"link\" href='\n    },\n    {\n      type: 'output',\n      regex: /\\<h3/g,\n      replace: '<h3 class=\"txt-l txt-bold mt18\"'\n    },\n    {\n      type: 'output',\n      regex: /\\<h2/g,\n      replace:\n        '<h2 class=\"txt-xl txt-bold mt24 mb12 border-b border--gray-light border--1\"'\n    },\n    {\n      type: 'output',\n      regex: /\\<h1/g,\n      replace:\n        '<h1 class=\"txt-xl txt-bold mt24 mb12 border-b border--gray-light border--1\"'\n    },\n    {\n      type: 'output',\n      regex: /\\<ul\\>/g,\n      replace: '<ul class=\"pl24\">'\n    },\n    {\n      type: 'output',\n      regex: /\\<li\\>/g,\n      replace: '<li style=\"list-style-type: circle;\">'\n    },\n    {\n      type: 'output',\n      regex: /img src=/g,\n      replace: `img\n      class=\"py12 my12 border border--gray-light border--2\"\n      style=\"margin-left: auto;\n             margin-right: auto;\n             display: block;\n            \" src=`\n    }\n  ];\n}\n\nexport class About extends React.PureComponent {\n  state = {\n    about: null\n  };\n  cancellablePromise = null;\n  componentDidMount() {\n    this.cancellablePromise = cancelablePromise(\n      fetch(\n        'https://raw.githubusercontent.com/mapbox/osmcha-frontend/master/ABOUT.md'\n      ).then(r => r.text())\n    );\n    this.cancellablePromise.promise\n      .then(markdown => this.setState({ about: converter.makeHtml(markdown) }))\n      .catch(e => {});\n  }\n  componentWillUnmount() {\n    this.cancellablePromise && this.cancellablePromise.cancel();\n  }\n  render() {\n    return (\n      <div className=\"scroll-auto about-page-height flex-parent flex-parent--column pb12 flex-parent--center-cross\">\n        <div className=\"txt-xs txt-mono align-right\">\n          OSMCha Version {appVersion}\n          {isDev && ' Dev'}\n          {isLocal && ' Local'}\n          {isStaging && ' Staging'}\n        </div>\n        <div\n          id=\"guide\"\n          className=\"pb36 px12\"\n          dangerouslySetInnerHTML={{\n            __html: DOMPurify.sanitize(this.state.about)\n          }}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\nexport const Stats = () => <div> stats here </div>;\n","// @flow\nimport React from 'react';\nimport Select from 'react-select';\nimport { fromJS } from 'immutable';\nimport type { filterType } from './';\n\nexport class Radio extends React.PureComponent {\n  props: {\n    name: string,\n    display: string,\n    type: string,\n    placeholder: string,\n    options: Array<Object>,\n    value: filterType,\n    onChange: (string, value?: filterType) => any\n  };\n  onChangeLocal = (data: Object) => {\n    if (!data || data.value === '') {\n      return this.props.onChange(this.props.name); // always sends 1 size array to keep things consistent with multiselect InputTypes\n    }\n    this.props.onChange(this.props.name, fromJS([data])); // always sends 1 size array to keep things consistent with multiselect InputTypes\n  };\n  render() {\n    const { name, options, placeholder, value } = this.props;\n    return (\n      <Select\n        name={name}\n        value={value && value.get(0) && value.get(0).toJS()} // always takes 1st item array to keep things consistent with multiselect InputTypes\n        options={options}\n        placeholder={placeholder}\n        className=\"\"\n        onChange={this.onChangeLocal}\n      />\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { fromJS } from 'immutable';\nimport type { filterType } from './';\n\nexport class Text extends React.Component {\n  props: {\n    name: string,\n    display: string,\n    type: string,\n    placeholder: string,\n    value: filterType,\n    className: string,\n    onChange: (string, value?: filterType) => any,\n    min: ?string,\n    max: ?string\n  };\n  static defaultProps = {\n    className: ''\n  };\n  state = {\n    isValid: true\n  };\n  handleFormChange = (event: any) => {\n    const target = event.target;\n    const value = target.type === 'checkbox' ? target.checked : target.value;\n    const name = target.name;\n    this.setState({ isValid: target.validity.valid });\n    if (!value || value === '') {\n      return this.props.onChange(name);\n    }\n    this.props.onChange(\n      name,\n      fromJS([\n        // allways sends 1 size array to keep things consistent\n        {\n          label: value,\n          value\n        }\n      ])\n    );\n  };\n  render() {\n    const {\n      name,\n      type,\n      placeholder,\n      display,\n      value,\n      className,\n      min,\n      max\n    } = this.props;\n    const { isValid } = this.state;\n    const errorClass = 'border border--1 border--red';\n    return (\n      <input\n        name={name}\n        className={`input ${className} ${isValid ? '' : errorClass}`}\n        value={(value && value.getIn([0, 'value'])) || ''} // allways sends 1 size array to keep things consistent\n        onChange={this.handleFormChange}\n        type={type}\n        placeholder={placeholder || display}\n        min={min}\n        max={max}\n      />\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { fromJS } from 'immutable';\nimport { Creatable, Async } from 'react-select';\nimport { API_URL } from '../../config';\nimport type { filterType } from './';\n\nexport class MultiSelect extends React.PureComponent {\n  props: {\n    name: string,\n    display: string,\n    value: filterType,\n    type: string,\n    placeholder: string,\n    options: Array<Object>,\n    dataURL: ?string,\n    onChange: (string, value?: filterType) => any,\n    showAllToggle: boolean,\n    token: string\n  };\n  state = {\n    allToggle: this.props.name.slice(0, 4) === 'all_'\n  };\n  getAsyncOptions = () => {\n    if (!this.props.dataURL) return;\n    return fetch(`${API_URL}/${this.props.dataURL}/`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: this.props.token ? `Token ${this.props.token}` : ''\n      }\n    })\n      .then(response => {\n        return response.json();\n      })\n      .then(json => {\n        const data = json\n          .filter(d => d.for_changeset)\n          .map(d => ({ ...d, label: d.name, value: d.id }));\n        return { options: data };\n      });\n  };\n  onChangeLocal = (data: ?Array<Object>) => {\n    if (!Array.isArray(data)) return;\n    this.sendData(this.state.allToggle, data);\n  };\n  sendData = (allToggle: boolean, data: Array<Object>) => {\n    let name =\n      this.props.name.slice(0, 4) === 'all_'\n        ? this.props.name.slice(4)\n        : this.props.name;\n\n    name = `${allToggle ? 'all_' : ''}${name}`;\n    if (data.length === 0) return this.props.onChange(name);\n    var processed = data.map(o => ({ label: o.label, value: o.value })); // remove any bogus keys\n    this.props.onChange(name, fromJS(processed));\n  };\n  renderSelect = () => {\n    const { name, options, placeholder, value, display, dataURL } = this.props;\n    if (dataURL)\n      return (\n        <Async\n          multi\n          promptTextCreator={label => `Add ${label} to ${display}`}\n          name={name}\n          className=\"\"\n          value={value && value.toJS()}\n          loadOptions={this.getAsyncOptions}\n          onChange={this.onChangeLocal} // have to add an identifier for filter name\n          placeholder={placeholder}\n        />\n      );\n    return (\n      <Creatable\n        multi\n        promptTextCreator={label => `Add ${label} to ${display}`}\n        name={name}\n        value={value && value.toJS()}\n        options={options}\n        onChange={this.onChangeLocal}\n        placeholder={placeholder}\n      />\n    );\n  };\n  handleToggle = (e: Event) => {\n    let { value } = this.props;\n    value = value && value.toJS();\n    if (value) {\n      this.sendData(!this.state.allToggle, value);\n    }\n    this.setState({\n      allToggle: !this.state.allToggle\n    });\n  };\n  render() {\n    return (\n      <div className=\"\">\n        {this.props.showAllToggle && (\n          <span className=\"relative fr\">\n            <span className=\"absolute\" style={{ left: -95, top: -30 }}>\n              <div className=\"toggle-group txt-s mr18\">\n                <label className=\"toggle-container\">\n                  <input\n                    checked={!this.state.allToggle}\n                    name={`toggle${this.props.name}`}\n                    type=\"radio\"\n                    onClick={this.handleToggle}\n                  />\n                  <div className=\"toggle toggle--gray-light\">OR</div>\n                </label>\n                <label className=\"toggle-container\">\n                  <input\n                    name={`toggle${this.props.name}`}\n                    type=\"radio\"\n                    checked={this.state.allToggle}\n                    onClick={this.handleToggle}\n                  />\n                  <div className=\"toggle toggle--gray-light\">AND</div>\n                </label>\n              </div>\n            </span>\n          </span>\n        )}\n        {this.renderSelect()}\n      </div>\n    );\n  }\n}\n\nexport class MappingTeamMultiSelect extends MultiSelect {\n  getAsyncOptions = () => {\n    if (!this.props.dataURL) return;\n    return fetch(`${API_URL}/${this.props.dataURL}/`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: this.props.token ? `Token ${this.props.token}` : ''\n      }\n    })\n      .then(response => {\n        return response.json();\n      })\n      .then(json => {\n        const data = json.map(d => {\n          if (d.trusted) {\n            return { ...d, label: `${d.name} (verified)`, value: d.name };\n          } else {\n            return {\n              ...d,\n              label: d.name.replace('(verified)', ''),\n              value: d.name\n            };\n          }\n        });\n        return { options: data };\n      });\n  };\n  sendData = (allToggle: boolean, data: Array<Object>) => {\n    let name =\n      this.props.name.slice(0, 4) === 'all_'\n        ? this.props.name.slice(4)\n        : this.props.name;\n\n    name = `${allToggle ? 'all_' : ''}${name}`;\n    if (data.length === 0) return this.props.onChange(name);\n    var processed = data.map(o => ({ label: o.label, value: o.value })); // remove any bogus keys\n    this.props.onChange(name, fromJS(processed));\n  };\n}\n","import { nominatimUrl } from '../config/constants';\nimport { handleErrors } from './aoi';\n\nexport function nominatimSearch(input, type): Promise<*> {\n  return fetch(\n    `${nominatimUrl}?polygon_geojson=1&format=json&${type}=${input}`,\n    {\n      method: 'GET'\n    }\n  )\n    .then(handleErrors)\n    .then(response => {\n      return response.json();\n    });\n}\n","// @flow\nimport React from 'react';\nimport { fromJS } from 'immutable';\nimport debounce from 'lodash.debounce';\nimport { Async } from 'react-select';\nimport Select from 'react-select';\n\nimport area from '@turf/area';\nimport bbox from '@turf/bbox';\nimport simplify from '@turf/simplify';\nimport truncate from '@turf/truncate';\nimport MapboxDraw from '@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw';\n\nimport { nominatimSearch } from '../../network/nominatim';\nimport { mapboxAccessToken } from '../../config/constants';\nimport { importChangesetMap } from '../../utils/cmap';\n\nexport class LocationSelect extends React.PureComponent {\n  props: {\n    name: string,\n    display: string,\n    value: Object,\n    type: string,\n    placeholder: string,\n    options: Array<Object>,\n    onChange: (string, value: Object) => any\n  };\n  state = {\n    geometry: Object,\n    location: '',\n    queryType: 'q',\n    lastSearch: new Date()\n  };\n  queryTypeOptions = [\n    { value: 'q', label: 'Any' },\n    { value: 'city', label: 'City' },\n    { value: 'county', label: 'County' },\n    { value: 'state', label: 'State' },\n    { value: 'country', label: 'Country' }\n  ];\n  map = null;\n  draw = null;\n\n  updateMap(data) {\n    if (this.map.getSource('feature')) {\n      this.map.getSource('feature').setData(data);\n    } else {\n      this.map.addSource('feature', {\n        type: 'geojson',\n        data: {\n          type: 'Feature',\n          geometry: data\n        }\n      });\n    }\n    if (this.map.getLayer('geometry') === undefined) {\n      this.map.addLayer({\n        id: 'geometry',\n        type: 'fill',\n        source: 'feature',\n        paint: {\n          'fill-color': '#088',\n          'fill-opacity': 0.6\n        }\n      });\n    }\n    this.setState({ geometry: data });\n    this.props.onChange(\n      this.props.name,\n      fromJS([{ label: data, value: data }])\n    );\n    const geom_bbox = bbox(data);\n    this.map.fitBounds([geom_bbox.slice(0, 2), geom_bbox.slice(2)], {\n      padding: 20\n    });\n  }\n\n  componentDidMount() {\n    importChangesetMap('getGL').then((getGL: any) => {\n      if (getGL) {\n        var mapboxgl = getGL();\n        mapboxgl.accessToken = mapboxAccessToken;\n        const map = new mapboxgl.Map({\n          container: 'geometry-map',\n          style: 'mapbox://styles/mapbox/light-v9'\n        });\n        this.map = map;\n        this.draw = new MapboxDraw({\n          displayControlsDefault: false,\n          controls: {\n            polygon: true\n          }\n        });\n        map.addControl(this.draw);\n\n        map.on('draw.create', this.drawingUpdate);\n        map.on('draw.modechange', this.clearBeforeDraw);\n        map.on('draw.delete', this.drawingUpdate);\n        map.on('draw.update', this.drawingUpdate);\n        map.on('style.load', () => {\n          try {\n            this.updateMap(\n              this.props.value\n                .get('0')\n                .get('value')\n                .toJS()\n            );\n          } catch (e) {\n            if (e instanceof TypeError) {\n            }\n          }\n        });\n      }\n    });\n  }\n\n  clearBeforeDraw = e => {\n    if (e.mode === 'draw_polygon') {\n      this.clearMap();\n      this.draw.changeMode('draw_polygon');\n    }\n  };\n  clearMap = () => {\n    this.draw.deleteAll();\n    this.props.onChange(this.props.name, null);\n    if (this.map.getSource('feature')) {\n      this.map.getSource('feature').setData({});\n    }\n    if (this.map.getLayer('geometry')) {\n      this.map.removeLayer('geometry');\n    }\n  };\n  drawingUpdate = e => {\n    const drawingData = this.draw.getAll();\n    if (\n      drawingData &&\n      drawingData.features.length &&\n      drawingData.features[0].geometry\n    ) {\n      this.updateMap(\n        truncate(drawingData.features[0].geometry, {\n          precision: 6,\n          coordinates: 2\n        })\n      );\n    } else {\n      this.clearMap();\n    }\n  };\n\n  getAsyncOptions = (input: string, cb: (e: ?Error, any) => void) => {\n    if (input.length >= 3) {\n      return nominatimSearch(input, this.state.queryType)\n        .then(json => {\n          if (!Array.isArray(json)) return cb(null, { options: [] });\n\n          const data = json.map(d => ({\n            label: d.display_name,\n            value: d.geojson\n          }));\n          return cb(null, { options: data });\n        })\n        .catch(e => cb(e, null));\n    } else {\n      return cb(null, { options: [] });\n    }\n  };\n  onChangeLocal = (data: ?Array<Object>) => {\n    if (data) {\n      this.draw.deleteAll();\n      const tolerance = area(data.value) / 10 ** 6 < 1000 ? 0.01 : 0.1;\n      const simplified_bounds = simplify(data.value, {\n        tolerance: tolerance,\n        highQuality: true\n      });\n      this.updateMap(\n        truncate(simplified_bounds, { precision: 6, coordinates: 2 })\n      );\n    }\n  };\n  handleQueryTypeChange = value => {\n    this.setState({ queryType: value });\n  };\n  renderSelect = () => {\n    const { name, placeholder, value } = this.props;\n    return (\n      <Async\n        name={name}\n        className=\"\"\n        value={value}\n        loadOptions={debounce(\n          (input, cb) => this.getAsyncOptions(input, cb),\n          500\n        )}\n        onChange={this.onChangeLocal}\n        placeholder={placeholder}\n      />\n    );\n  };\n  render() {\n    return (\n      <div>\n        <div className=\"grid grid--gut12\">\n          <div className=\"col col--4\">\n            <Select\n              onChange={this.handleQueryTypeChange}\n              options={this.queryTypeOptions}\n              simpleValue\n              value={this.state.queryType}\n              placeholder=\"Place Type\"\n            />\n          </div>\n          <div className=\"col col--8 pl3\">{this.renderSelect()}</div>\n        </div>\n        <div className=\"grid grid--gut12 pt6\">\n          <div className=\"col col--12 map-select\">\n            <div id=\"geometry-map\">\n              <button\n                onClick={this.clearMap}\n                className=\"pointer z5 mx1 my1 inline-block px6 py3 txt-s bg-white txt-bold round absolute fl\"\n                style={{ zIndex: 2 }}\n              >\n                Clear All\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup';\nimport { isMobile } from '../../utils';\n\nexport function Wrapper({\n  display,\n  children,\n  description,\n  handleFocus = () => {},\n  name,\n  hasValue\n}) {\n  const mobile = isMobile();\n\n  return (\n    <div\n      className=\"ml3 my12 flex-parent flex-parent--column\"\n      onClick={() => handleFocus(name)}\n      onFocus={() => handleFocus(name)}\n    >\n      <div className=\"flex-parent flex-parent--row flex-parent--center-cross mt12 mb6 \">\n        <span className=\"relative\">\n          {hasValue && (\n            <svg\n              style={{ left: -18, top: -9 }}\n              className=\"absolute icon inline-block align-middle color-blue\"\n            >\n              <use xlinkHref=\"#icon-circle\" />\n            </svg>\n          )}\n        </span>\n        <strong className=\"txt-truncate pointer\">{display}&nbsp;</strong>\n      </div>\n      <div className=\"grid\">\n        <span className=\"col col--6-mxl col--6-ml col--12-mm col--12\">\n          {children}\n        </span>\n        {!mobile && (\n          <span className=\"col col--3-mxl col--3-ml col--1-mm\">\n            <span className=\"desc block relative ml12 wmin120\">\n              <CSSTransitionGroup\n                transitionName=\"filters-desc\"\n                transitionAppearTimeout={300}\n                transitionEnterTimeout={300}\n                transitionLeaveTimeout={200}\n              >\n                {description && (\n                  <span\n                    key={0}\n                    className=\"absolute wmin300 bg-white\"\n                    style={{ marginTop: -5 }}\n                  >\n                    {description}\n                  </span>\n                )}\n              </CSSTransitionGroup>\n            </span>\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { Map, fromJS } from 'immutable';\nimport Select from 'react-select';\nimport type { filtersType } from './';\n\nexport class Meta extends React.PureComponent {\n  options: Array<*>;\n  props: {\n    placeholder: string,\n    name: string,\n    activeFilters: filtersType,\n    metaOf: Array<string>,\n    options: Array<Object>,\n    replaceFiltersState: filtersType => void\n  };\n  handleChange = (data: Object) => {\n    let { activeFilters } = this.props;\n    if (!activeFilters) activeFilters = new Map();\n    this.props.metaOf.forEach(f => {\n      activeFilters = activeFilters.delete(f);\n    });\n    if (data && data.value) {\n      activeFilters = activeFilters.merge(fromJS(data.value));\n    }\n    this.props.replaceFiltersState(activeFilters);\n  };\n  findCurrentValue = () => {\n    const { activeFilters } = this.props;\n    let value;\n    if (activeFilters) {\n      activeFilters.forEach((v, k) => {\n        this.props.options.forEach(option => {\n          if (\n            Object.keys(option.value)[0] === k &&\n            v.getIn([0, 'value']) === option.value[k][0].value\n          ) {\n            value = option;\n          }\n        });\n      });\n    }\n    return value;\n  };\n  render() {\n    const { name, placeholder } = this.props;\n    let value = this.findCurrentValue();\n    return (\n      <Select\n        name={name}\n        value={value} // always takes 1st item array to keep things consistent with multiselect InputTypes\n        options={this.props.options}\n        placeholder={placeholder}\n        className=\"\"\n        onChange={this.handleChange}\n      />\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { fromJS } from 'immutable';\nimport DatePicker from 'react-datepicker';\nimport { format, parse } from 'date-fns';\nimport type { filterType } from './';\n\nimport 'react-datepicker/dist/react-datepicker.css';\n\nexport class DateField extends React.Component {\n  props: {\n    name: string,\n    display: string,\n    type: string,\n    placeholder: string,\n    value: filterType,\n    className: string,\n    onChange: (string, value?: filterType) => any,\n    min: ?string,\n    max: ?string\n  };\n  static defaultProps = {\n    className: ''\n  };\n  handleDateChange = date => {\n    const name = this.props.name;\n    if (date) {\n      const value = format(date, 'yyyy-MM-dd');\n      this.props.onChange(\n        name,\n        fromJS([\n          // allways sends 1 size array to keep things consistent\n          {\n            label: value,\n            value\n          }\n        ])\n      );\n    } else {\n      this.props.onChange(name);\n    }\n  };\n  render() {\n    const { placeholder, display, value, className, min, max } = this.props;\n    const hasValue = value && value.getIn([0, 'value']);\n    return (\n      <DatePicker\n        className={`input ${className}`}\n        isClearable={true}\n        selected={\n          hasValue\n            ? parse(value.getIn([0, 'value']), 'yyyy-MM-dd', new Date())\n            : null\n        }\n        placeholderText={placeholder || display}\n        onChange={this.handleDateChange}\n        dateFormat=\"yyyy-MM-dd\"\n        minDate={min && Date.parse(min)}\n        maxDate={max && Date.parse(max)}\n      />\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport debounce from 'lodash.debounce';\nimport { fromJS } from 'immutable';\n\nimport { mapboxAccessToken } from '../config/constants';\nimport { importChangesetMap } from '../utils/cmap';\n\nexport class BBoxPicker extends React.Component {\n  update = debounce(() => {\n    if (!this.map) return;\n    let bounds: {\n      getSouth: () => number,\n      getWest: () => number,\n      getNorth: () => number,\n      getEast: () => number\n    } =\n      this.map && this.map.getBounds(); // ne, sw / lat, lng\n\n    let s = bounds.getSouth().toFixed(4);\n    let w = bounds.getWest().toFixed(4);\n    let n = bounds.getNorth().toFixed(4);\n    let e = bounds.getEast().toFixed(4);\n    let wsen = [w, s, e, n].join(',');\n    this.props.onChange(\n      this.props.name,\n      fromJS([\n        {\n          label: wsen,\n          value: wsen\n        }\n      ])\n    );\n  }, 600);\n\n  map = null;\n  componentDidMount() {\n    importChangesetMap('getGL').then((getGL: any) => {\n      if (getGL) {\n        var mapboxgl = getGL();\n        mapboxgl.accessToken = mapboxAccessToken;\n        if (this.props.value) {\n          // let bbox = this.props.value.getIn(['0', 'value'], '').split(',');\n        }\n        const map = new mapboxgl.Map({\n          container: 'map',\n          style: 'mapbox://styles/mapbox/light-v9'\n        });\n        map.on('dragend', this.update);\n        map.on('zoomend', this.update);\n        map.on('touchend', this.update);\n        this.map = map;\n      }\n    });\n  }\n  componentWillUnmount() {\n    this.map && this.map.remove();\n  }\n  clearBbox = () => {\n    this.props.onChange(this.props.name, null);\n  };\n\n  render() {\n    return (\n      <div className=\"map-select border border--1  border--gray-light\">\n        <div\n          onClick={this.clearBbox}\n          className=\"pointer z5 m3 inline-block px6 py3 txt-s bg-gray-light txt-bold round absolute fl\"\n        >\n          Clear\n        </div>\n        <div id=\"map\" style={{ height: 300, width: 300 }} />\n      </div>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { Loading } from './loading';\n\ntype propTypes = {\n  loading: boolean\n};\n\nexport function loadingEnhancer<P: {}, S: {}>(\n  WrappedComponent: Class<React.PureComponent<any, P, S>>\n): Class<React.PureComponent<void, P & propTypes, *>> {\n  return class PureRendered extends React.PureComponent<\n    void,\n    P & propTypes,\n    *\n  > {\n    render() {\n      return this.props.loading\n        ? <Loading />\n        : <WrappedComponent {...this.props} />;\n    }\n  };\n}\n","// @flow\nimport React from 'react';\n\nimport {\n  Text,\n  Radio,\n  MappingTeamMultiSelect,\n  MultiSelect,\n  Wrapper,\n  Meta,\n  DateField,\n  LocationSelect\n} from './';\n\nimport { BBoxPicker } from '../bbox_picker';\nimport { loadingEnhancer } from '../loading_enhancer';\nimport filters from '../../config/filters.json';\nimport { getDefaultFromDate } from '../../utils/filters';\nimport type { filterType, filtersType } from './';\n\nconst defaultDate = getDefaultFromDate().getIn(['date__gte']);\n\nvar filtersData = filters.filter(f => {\n  return !f.ignore;\n});\ntype propsType = {|\n  filters: filtersType,\n  loading: boolean,\n  active: string,\n  token: string,\n  handleChange: (name: string, values?: filterType) => void,\n  handleFocus: (name: string) => void,\n  replaceFiltersState: (filters: filtersType) => void,\n  handleToggleAll: (name: string, values?: filterType) => void\n|};\nclass FiltersList extends React.PureComponent<void, propsType, *> {\n  renderFilters = (f: Object, k: number) => {\n    const propsToSend = {\n      name: f.name,\n      type: f.type,\n      display: f.display,\n      value: this.props.filters.get(f.name),\n      placeholder: f.placeholder,\n      options: f.options || [],\n      onChange: this.props.handleChange,\n      dataURL: f.data_url,\n      min: f.min,\n      max: f.max\n    };\n    const wrapperProps = {\n      name: f.name,\n      handleFocus: this.props.handleFocus,\n      hasValue: this.props.filters.has(f.name),\n      display: f.display,\n      key: k,\n      description: this.props.active === f.name && f.description\n    };\n    if (f.range && f.type === 'number') {\n      const gteValue = this.props.filters.get(f.name + '__gte');\n      const lteValue = this.props.filters.get(f.name + '__lte');\n      return (\n        <Wrapper\n          {...wrapperProps}\n          hasValue={\n            this.props.filters.has(f.name + '__gte') ||\n            this.props.filters.has(f.name + '__lte')\n          }\n        >\n          <span className=\"flex-parent flex-parent--row  \">\n            <Text\n              {...propsToSend}\n              className=\"mr3\"\n              name={f.name + '__gte'}\n              value={gteValue}\n              placeholder={'from'}\n              max={lteValue && lteValue.getIn([0, 'value'])}\n              min=\"0\"\n            />\n            <Text\n              {...propsToSend}\n              name={f.name + '__lte'}\n              value={lteValue}\n              placeholder={'to'}\n              min={gteValue && gteValue.getIn([0, 'value'])}\n            />\n          </span>\n        </Wrapper>\n      );\n    }\n    if (!f.range && f.type === 'number') {\n      return (\n        <Wrapper {...wrapperProps}>\n          <Text {...propsToSend} className=\"mr3\" min={1} max={100} />\n        </Wrapper>\n      );\n    }\n    if (f.range && f.type === 'date') {\n      let gteValue = this.props.filters.get(f.name + '__gte');\n      if (f.name === 'date') {\n        gteValue = this.props.filters.get(f.name + '__gte') || defaultDate;\n      }\n      const lteValue = this.props.filters.get(f.name + '__lte');\n      const today = new Date();\n      return (\n        <Wrapper\n          {...wrapperProps}\n          hasValue={\n            this.props.filters.has(f.name + '__gte') ||\n            this.props.filters.has(f.name + '__lte')\n          }\n        >\n          <span className=\"flex-parent flex-parent--row h36\">\n            <DateField\n              {...propsToSend}\n              name={f.name + '__gte'}\n              value={gteValue}\n              className=\"mr3\"\n              placeholder={'From'}\n              max={(lteValue && lteValue.getIn([0, 'value'])) || today}\n            />\n            <DateField\n              {...propsToSend}\n              name={f.name + '__lte'}\n              value={lteValue}\n              className=\"ml3\"\n              placeholder={'To'}\n              min={gteValue && gteValue.getIn([0, 'value'])}\n              max={today}\n            />\n          </span>\n        </Wrapper>\n      );\n    }\n    if (f.type === 'location') {\n      return (\n        <Wrapper {...wrapperProps}>\n          <LocationSelect {...propsToSend} />\n        </Wrapper>\n      );\n    }\n    if (f.type === 'text') {\n      return (\n        <Wrapper {...wrapperProps}>\n          <Text {...propsToSend} />\n        </Wrapper>\n      );\n    }\n    if (f.type === 'radio') {\n      return (\n        <Wrapper {...wrapperProps}>\n          <Radio {...propsToSend} />\n        </Wrapper>\n      );\n    }\n    if (f.type === 'meta') {\n      return (\n        <Wrapper\n          {...wrapperProps}\n          hasValue={f.metaOf.find(fi => this.props.filters.has(fi))}\n        >\n          <Meta\n            {...propsToSend}\n            replaceFiltersState={this.props.replaceFiltersState}\n            metaOf={f.metaOf}\n            activeFilters={this.props.filters}\n          />\n        </Wrapper>\n      );\n    }\n    if (f.type === 'text_comma') {\n      let { name, value, onChange } = propsToSend;\n      if (f.all) {\n        onChange = this.props.handleToggleAll;\n      }\n      if (f.all && this.props.filters.has(`all_${f.name}`)) {\n        name = `all_${f.name}`;\n        value = this.props.filters.get(name);\n      }\n\n      return (\n        <Wrapper\n          {...wrapperProps}\n          name={name}\n          hasValue={this.props.filters.has(name)}\n          description={this.props.active === f.name && f.description}\n        >\n          {name.endsWith('_teams') ? (\n            <MappingTeamMultiSelect\n              {...propsToSend}\n              name={name}\n              value={value}\n              onChange={onChange}\n              showAllToggle={f.all}\n              token={this.props.token}\n            />\n          ) : (\n            <MultiSelect\n              {...propsToSend}\n              name={name}\n              value={value}\n              onChange={onChange}\n              showAllToggle={f.all}\n              token={this.props.token}\n            />\n          )}\n        </Wrapper>\n      );\n    }\n    if (f.type === 'map') {\n      return (\n        <Wrapper\n          {...wrapperProps}\n          description={\n            this.props.active === f.name && (\n              <BBoxPicker\n                onChange={this.props.handleChange}\n                name={f.name}\n                value={this.props.filters.get(f.name)}\n              />\n            )\n          }\n        >\n          <Text {...propsToSend} />\n        </Wrapper>\n      );\n    }\n  };\n  render() {\n    return (\n      <div className=\"px30 flex-child filters-scroll\">\n        <h2 className=\"txt-xl mr6 txt-bold mt24   border-b border--gray-light border--1\">\n          Basic\n        </h2>\n        {filtersData\n          .slice(0, 5)\n          .map((f: Object, k) => this.renderFilters(f, k))}\n        <h2 className=\"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1\">\n          OSM Features\n        </h2>\n        {filtersData\n          .slice(5, 6)\n          .map((f: Object, k) => this.renderFilters(f, k))}\n        <span className=\"flex-child flex-child--grow wmin420 wmax435\" />\n        <h2 className=\"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1\">\n          Flags\n        </h2>\n        {filtersData\n          .slice(6, 8)\n          .map((f: Object, k) => this.renderFilters(f, k))}\n        <span className=\"flex-child flex-child--grow wmin420 wmax435\" />\n\n        <h2 className=\"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1\">\n          Review\n        </h2>\n        {filtersData\n          .slice(8, 12)\n          .map((f: Object, k) => this.renderFilters(f, k))}\n        <span className=\"flex-child flex-child--grow wmin420 wmax435\" />\n\n        <h2 className=\"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1\">\n          Users & Teams\n        </h2>\n        {filtersData\n          .slice(12, 19)\n          .map((f: Object, k) => this.renderFilters(f, k))}\n        <span className=\"flex-child flex-child--grow wmin420 wmax435\" />\n\n        <h2 className=\"txt-xl mr6 txt-bold mt30  border-b border--gray-light border--1\">\n          Changeset Details\n        </h2>\n        {filtersData.slice(19).map((f: Object, k) => this.renderFilters(f, k))}\n        <span className=\"flex-child flex-child--grow wmin420 wmax435\" />\n      </div>\n    );\n  }\n}\nFiltersList = loadingEnhancer(FiltersList);\nexport { FiltersList };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { push } from 'react-router-redux';\n\nimport { cancelablePromise } from '../../utils/promise';\nimport { fetchAllAOIs } from '../../network/aoi';\nimport { Button } from '../button';\nimport { Dropdown } from '../dropdown';\nimport { API_URL } from '../../config';\n\nclass SaveAOI extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editing: false,\n      value: props.name\n    };\n  }\n  ref;\n  clicked = false;\n  onClick = event => {\n    this.clicked = true;\n    this.setState({ editing: true, value: this.props.name });\n  };\n  onChange = (event: any) => {\n    this.setState({ value: event.target.value });\n  };\n  onKeyDown = event => {\n    if (event.keyCode === 13) {\n      this.handleSubmit(event);\n    } else if (event.keyCode === 27) {\n      this.setState({\n        editing: false,\n        value: this.props.name\n      });\n      this.clicked = false;\n    }\n  };\n  handleSubmit = event => {\n    this.setState({\n      editing: false\n    });\n    const aoiList = this.props.aoiList.filter(\n      aoi => aoi.value === this.props.aoiId\n    );\n    if (this.props.aoiId && aoiList.length) {\n      this.props.updateAOI(this.props.aoiId, this.state.value);\n    } else {\n      this.props.createAOI(this.state.value);\n    }\n  };\n  // handleFocus = event => {\n  //   event.target.select();\n  // };\n  render() {\n    return (\n      <span>\n        {this.state.editing ? (\n          <span>\n            <input\n              ref={r => {\n                if (this.clicked) {\n                  r.select();\n                  this.clicked = false;\n                }\n              }}\n              value={this.state.value}\n              onChange={this.onChange}\n              onKeyDown={this.onKeyDown}\n            />\n            <Button onClick={this.handleSubmit} className=\"mx3\">\n              Confirm Save\n            </Button>\n          </span>\n        ) : (\n          <Button onClick={this.onClick} className=\"border--0 bg-transparent\">\n            Save\n          </Button>\n        )}\n      </span>\n    );\n  }\n}\n\ntype filterProps = {\n  createAOI: string => void,\n  updateAOI: string => void,\n  removeAOI: string => void,\n  loading: boolean,\n  search: string,\n  token?: string,\n  aoiName?: string,\n  aoiId?: string,\n  handleApply: () => void,\n  handleClear: () => void,\n  loadAoiId: string => void,\n  location: Object,\n  push: any => any\n};\n\nclass FiltersHeader extends React.Component<any, filterProps, any> {\n  getAoisPromise;\n  state = {\n    aoiList: []\n  };\n\n  componentDidMount() {\n    this.getAois();\n  }\n\n  componentWillUnmount() {\n    this.getAoisPromise && this.getAoisPromise.cancel();\n  }\n\n  getAois() {\n    if (this.props.token) {\n      this.getAoisPromise = cancelablePromise(fetchAllAOIs(this.props.token));\n      this.getAoisPromise.promise\n        .then(r => {\n          let aoiList = r.features.map(aoi => {\n            return { label: aoi.properties.name, value: aoi.id };\n          });\n          this.setState({ aoiList: aoiList });\n        })\n        .catch(e => console.log(e));\n    }\n  }\n\n  renderRssLink() {\n    if (this.props.aoiId) {\n      return (\n        <a\n          className=\"txt--s pl6\"\n          href={`${API_URL}/aoi/${this.props.aoiId}/changesets/feed/`}\n          title=\"RSS Feed\"\n        >\n          <svg className=\"icon icon--s mt-neg3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition\">\n            <use xlinkHref=\"#icon-rss\" />\n          </svg>\n        </a>\n      );\n    }\n  }\n\n  renderAoiLink() {\n    if (this.props.aoiId) {\n      return (\n        <div\n          className=\"txt--s pl6 pointer inline\"\n          onClick={e =>\n            navigator.clipboard.writeText(\n              `${API_URL.replace('/api/v1', '')}/?aoi=${this.props.aoiId}`\n            )\n          }\n          title=\"Copy filter URL\"\n        >\n          <svg className=\"icon icon--s mt-neg3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition\">\n            <use xlinkHref=\"#icon-link\" />\n          </svg>\n        </div>\n      );\n    }\n  }\n\n  onAoiSelect = (arr: Array<Object>) => {\n    if (arr.length === 1) {\n      this.props.push({\n        ...this.props.location,\n        search: `aoi=${arr[0].value}`,\n        path: '/filters'\n      });\n    } else if (arr.length > 1) {\n      throw new Error('filter select array is big');\n    }\n  };\n\n  renderFilterInfo() {\n    const dropdown = (\n      <Dropdown\n        display={'My Filters'}\n        options={this.state.aoiList}\n        onChange={this.onAoiSelect}\n        value={[]}\n        onAdd={() => {}}\n        onRemove={() => {}}\n        position=\"left\"\n      />\n    );\n    if (this.props.token && this.state.aoiList.length) {\n      return <span>{dropdown}</span>;\n    }\n  }\n\n  render() {\n    var save_aoi = '';\n    if (this.props.token) {\n      save_aoi = (\n        <SaveAOI\n          name={this.props.aoiName}\n          aoiId={this.props.aoiId}\n          aoiList={this.state.aoiList}\n          createAOI={this.props.createAOI}\n          updateAOI={this.props.updateAOI}\n        />\n      );\n    }\n\n    return (\n      <header className=\"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1\">\n        <span className=\"txt-s color-gray--dark\">\n          {this.renderFilterInfo()}\n        </span>\n        <span className=\"txt-l txt-bold color-gray--dark\">\n          <span>\n            Filters\n            {this.props.aoiId && <span> / {this.props.aoiName}</span>}\n            {this.renderAoiLink()}\n            {this.renderRssLink()}\n          </span>\n        </span>\n        <span className=\"txt-l color-gray--dark\">\n          {save_aoi}\n          <Button\n            className=\"border--0 bg-transparent\"\n            onClick={this.props.handleClear}\n          >\n            Reset\n          </Button>\n          <Button onClick={this.props.handleApply} className=\"mx3\">\n            Apply\n          </Button>\n          <Link\n            to={{ search: this.props.search, pathname: '/' }}\n            className=\"mx3 pointer\"\n          >\n            <svg className=\"icon icon--m inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition\">\n              <use xlinkHref=\"#icon-close\" />\n            </svg>\n          </Link>\n        </span>\n      </header>\n    );\n  }\n}\n\nFiltersHeader = connect(\n  (state: RootStateType, props) => ({\n    location: props.location\n  }),\n  {\n    push\n  }\n)(FiltersHeader);\n\nexport { FiltersHeader };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { push } from 'react-router-redux';\n\nimport { Map, List, fromJS, is } from 'immutable';\n\nimport { checkForNewChangesets } from '../store/changesets_page_actions';\nimport { applyFilters } from '../store/filters_actions';\nimport { applyUpdateAOI, applyCreateAOI } from '../store/aoi_actions';\nimport { modal } from '../store/modal_actions';\n\nimport { FiltersList } from '../components/filters/filters_list';\nimport { FiltersHeader } from '../components/filters/filters_header';\n\nimport { deleteAOI } from '../network/aoi';\nimport type { RootStateType } from '../store';\nimport { delayPromise, gaSendEvent, isMobile } from '../utils';\n\nimport type { filterType, filtersType } from '../components/filters';\nconst NEW_AOI = 'unnamed *';\n\ntype propsType = {|\n  filters: filtersType,\n  loading: boolean,\n  aoi: Object,\n  token: string,\n  location: Object,\n  features: ?List<Map<string, any>>,\n  checkForNewChangesets: boolean => any,\n  push: (location: Object) => void,\n  applyFilters: (filtersType, path?: string) => mixed, // base 0\n  applyCreateAOI: (name?: string, filtersType) => mixed,\n  applyUpdateAOI: (aoiId?: string, name?: string, filtersType) => mixed,\n  modal: any => any\n|};\n\ntype stateType = {\n  filters: filtersType,\n  active: string\n};\nconst noDateGte: filterType = fromJS({\n  date__gte: [{ label: '', value: '' }]\n});\n\nclass Filters extends React.PureComponent<void, propsType, stateType> {\n  state = {\n    filters: this.props.filters,\n    active: ''\n    // aoiName: this.props.aoi.getIn(['properties', 'name'], NEW_AOI)\n  };\n  componentWillReceiveProps(nextProps: propsType) {\n    if (!is(this.props.filters, nextProps.filters)) {\n      this.setState({\n        filters: nextProps.filters\n      });\n    }\n  }\n  handleFocus = (name: string) => {\n    this.setState({\n      active: name\n    });\n  };\n  handleApply = () => {\n    // in case the user clicks on apply when filter\n    // loaded AOI.\n    if (JSON.stringify(this.state.filters.toJSON()).length > 7000) {\n      this.props.modal({\n        kind: 'error',\n        title: 'Use Save Filter',\n        description:\n          'Your filter is too big to be applied. You need to Save your Filter to be able to see the results.'\n      });\n    } else {\n      if (is(this.state.filters, this.props.filters)) {\n        this.props.push({\n          ...this.props.location,\n          pathname: '/'\n        });\n        return;\n      }\n      this.props.applyFilters(this.state.filters, '/');\n      this.sendToAnalytics();\n      // show user if there were any new changesets\n      // incase service had cached the request\n      delayPromise(3000).promise.then(() =>\n        this.props.checkForNewChangesets(true)\n      );\n    }\n  };\n  sendToAnalytics = () => {\n    const filters = this.state.filters;\n    filters.forEach((v, k) => {\n      v.forEach(vv => {\n        gaSendEvent({\n          category: 'Filters',\n          action: k,\n          label: vv.get('label')\n        });\n      });\n    });\n  };\n  handleChange = (name: string, values?: filterType) => {\n    let filters = this.state.filters;\n    // if someone cleared date__gte filter\n    // we use the convention defined at `noDateGte`\n    // to signify no default gte.\n    if (name === 'date__gte' && values == null) {\n      filters = filters.merge(noDateGte);\n    } else if (values == null) {\n      // clear this filter\n      filters = filters.delete(name);\n    } else {\n      filters = filters.set(name, values);\n    }\n    return this.setState({\n      filters\n    });\n  };\n  handleToggleAll = (name: string, values?: filterType) => {\n    let filters = this.state.filters;\n    const isAll = name.slice(0, 4) === 'all_';\n    //  delete the opposite value\n    if (isAll) {\n      filters = filters.delete(name.slice(4));\n    } else {\n      filters = filters.delete('all_' + name);\n    }\n    // regularly handle change\n    if (!values) {\n      filters = filters.delete(name);\n    } else {\n      filters = filters.set(name, values);\n    }\n    return this.setState({ filters });\n  };\n  replaceFiltersState = filters => {\n    this.setState({ filters });\n  };\n  handleClear = () => {\n    this.props.applyFilters(new Map(), '/');\n  };\n  loadAoiId = (aoiId: string) => {\n    this.props.push({\n      ...this.props.location,\n      search: `aoi=${aoiId}`\n    });\n  };\n  getAOIName = () => {\n    if (this.props.loading) return '';\n    return this.props.aoi.getIn(['properties', 'name'], NEW_AOI);\n  };\n  getAOIId = (aoiId: string) => {\n    if (this.props.loading) return '';\n    return this.props.aoi.get('id');\n  };\n  removeAOI = (aoiId: string) => {\n    if (aoiId === this.props.aoi.get('id')) {\n      this.handleClear();\n    }\n    deleteAOI(this.props.token, aoiId).catch(e => console.error(e));\n  };\n  createAOI = (name: string) => {\n    this.props.applyCreateAOI(name, this.state.filters);\n  };\n  updateAOI = (aoiId: string, name: string) => {\n    this.props.applyUpdateAOI(aoiId, name, this.state.filters);\n  };\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white ${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <FiltersHeader\n          createAOI={this.createAOI}\n          updateAOI={this.updateAOI}\n          removeAOI={this.removeAOI}\n          loading={this.props.loading}\n          token={this.props.token}\n          aoiName={this.getAOIName()}\n          aoiId={this.props.loading ? '' : this.props.aoi.get('id')}\n          loadAoiId={this.loadAoiId}\n          handleApply={this.handleApply}\n          handleClear={this.handleClear}\n          search={this.props.location.search}\n        />\n        <FiltersList\n          loading={this.props.loading}\n          filters={this.state.filters}\n          active={this.state.active}\n          handleFocus={this.handleFocus}\n          handleChange={this.handleChange}\n          handleToggleAll={this.handleToggleAll}\n          replaceFiltersState={this.replaceFiltersState}\n          token={this.props.token}\n        />\n      </div>\n    );\n  }\n}\n\nFilters = connect(\n  (state: RootStateType, props) => ({\n    filters: state.filters.get('filters'),\n    aoi: state.aoi.get('aoi'),\n    loading: state.filters.get('loading'),\n    features: state.changesetsPage.getIn(['currentPage', 'features']),\n    location: props.location,\n    token: state.auth.get('token')\n  }),\n  {\n    checkForNewChangesets,\n    applyFilters,\n    applyCreateAOI,\n    applyUpdateAOI,\n    push,\n    modal\n  }\n)(Filters);\n\nexport { Filters };\n","// @flow\nimport React from 'react';\n\nexport function NumberOfComments({ count }: { count: ?number }) {\n  return (\n    <span className=\"mr6\" title={`${count} comment${count > 1 ? 's' : ''}`}>\n      <span>{count}</span>\n      <svg className=\"icon h18 w18 inline-block align-middle color-darken25\">\n        <use xlinkHref=\"#icon-contact\" />\n      </svg>\n    </span>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { CreateDeleteModify } from '../create_delete_modify';\nimport { NumberOfComments } from './comments';\nimport { getObjAsQueryParam } from '../../utils/query_params';\n\nimport thumbsUp from '../../assets/thumbs-up.svg';\nimport thumbsDown from '../../assets/thumbs-down.svg';\n\nexport function SecondaryLine({ changesetId, date, properties }: Object) {\n  return (\n    <span className=\"flex-parent flex-parent--row justify--space-between txt-light txt-s color-gray\">\n      <span>\n        <Link\n          to={{\n            search: window.location.search,\n            pathname: `/changesets/${changesetId}`\n          }}\n          className=\"txt-underline-on-hover\"\n        >\n          <span className=\"mr6\">{changesetId}</span>\n        </Link>\n        {properties.get('checked') ? (\n          <Link\n            to={{\n              search: getObjAsQueryParam('filters', {\n                users: [\n                  {\n                    label: properties.get('check_user'),\n                    value: properties.get('check_user')\n                  }\n                ],\n                date__gte: [{ label: '', value: '' }]\n              }),\n              pathname: '/'\n            }}\n            title={`See ${properties.get('check_user')}'s changesets`}\n            className=\"txt-underline-on-hover\"\n          >\n            {properties.get('harmful') ? (\n              <img\n                src={thumbsDown}\n                alt=\"Marked as bad\"\n                className=\"icon inline-block\"\n              />\n            ) : (\n              <img\n                src={thumbsUp}\n                alt=\"Marked as good\"\n                className=\"icon inline-block\"\n              />\n            )}\n            {properties.get('check_user') && (\n              <span className=\"pl6\">{`by ${properties.get(\n                'check_user'\n              )}`}</span>\n            )}\n          </Link>\n        ) : null}\n      </span>\n      <span className=\"flex-parent flex-parent--row\">\n        {properties.get('comments_count') > 0 && (\n          <NumberOfComments count={properties.get('comments_count')} />\n        )}\n        <CreateDeleteModify\n          showZero\n          className=\"mr3\"\n          create={properties.get('create')}\n          modify={properties.get('modify')}\n          delete={properties.get('delete')}\n        />\n      </span>\n    </span>\n  );\n}\n//  <svg className=\"icon inline-block align-middle \"> //       <use xlinkHref=\"#icon-options\" /> //     </svg>\n","// @flow\nimport React from 'react';\nimport { Reasons } from '../reasons';\n\nexport function PrimaryLine({ reasons, comment, tags }: Object) {\n  return (\n    <span className=\"flex-parent flex-parent--column\">\n      <p className=\"flex-child truncate-3-lines my6 txt-break-url\">\n        {comment}\n      </p>\n      <Reasons reasons={reasons} color=\"blue\" />\n      <Reasons reasons={tags} color=\"red\" />\n    </span>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { formatDistanceToNow, parse } from 'date-fns';\n\nimport { useIsUserListed } from '../../hooks/UseIsUserListed';\n\nfunction TitleComponent({\n  properties,\n  wasOpen,\n  date,\n  trustedlist,\n  watchlisted\n}: Object) {\n  const [isInTrustedlist, isInWatchlist] = useIsUserListed(\n    properties.get('user'),\n    properties.get('uid'),\n    trustedlist,\n    watchlisted\n  );\n\n  return (\n    <div>\n      <span className=\"flex-parent flex-parent--row justify--space-between align-items--center\">\n        <strong className=\"txt-m mt3 mr6\">\n          {properties.get('user') || <i>OSM User</i>}\n          {isInTrustedlist && (\n            <svg className=\"icon inline-block align-middle pl3 w18 h18 color-yellow\">\n              <use xlinkHref=\"#icon-star\" />\n            </svg>\n          )}\n          {isInWatchlist && (\n            <svg className=\"icon inline-block align-middle pl3 w18 h18 color-red\">\n              <use xlinkHref=\"#icon-alert\" />\n            </svg>\n          )}\n        </strong>\n        <span className=\"txt-s mr3\">\n          &nbsp;\n          {formatDistanceToNow(\n            // eslint-disable-next-line\n            parse(date, \"yyyy-MM-dd'T'HH:mm:ssX\", new Date()),\n            { addSuffix: true }\n          )}\n        </span>\n      </span>\n    </div>\n  );\n}\n\nconst Title = connect((state: RootStateType, props) => ({\n  trustedlist: state.trustedlist.get('trustedlist'),\n  watchlisted: state.watchlist.get('watchlist')\n}))(TitleComponent);\n\nexport { Title };\n","// @flow\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { Map } from 'immutable';\n\nimport { SecondaryLine } from './secondary_line';\nimport { PrimaryLine } from './primary_line';\nimport { Title } from './title';\nimport { history } from '../../store/history';\n\nexport class Row extends React.Component {\n  props: {\n    properties: Map<string, *>,\n    active: ?boolean,\n    changesetId: number,\n    inputRef: ?(any) => any\n  };\n\n  shouldComponentUpdate(nextProps: Object) {\n    return (\n      nextProps.properties !== this.props.properties ||\n      this.props.active ||\n      nextProps.active\n    );\n  }\n\n  wasOpen = false;\n\n  render() {\n    const { properties, changesetId, active, inputRef, ...other } = this.props;\n    if (!this.wasOpen) {\n      // way to show read/unread state without\n      // performance compromise. The moment component\n      // gets active we set wasOpen to true and never\n      // toggle it back to any other state.\n      this.wasOpen = this.props.active;\n    }\n\n    let borderClass = 'border-l border-l--4 border-color-neutral';\n    if (properties.get('harmful') === true)\n      borderClass = 'border-l border-l--4 border-color-bad';\n    if (properties.get('harmful') === false)\n      borderClass = 'border-l border-l--4 border-color-good';\n\n    let backgroundClass = '';\n\n    backgroundClass += active ? 'light-blue' : this.wasOpen ? 'bg-darken5' : '';\n    return (\n      <div\n        onClick={() =>\n          history.push({\n            search: window.location.search,\n            pathname: `/changesets/${changesetId}`\n          })\n        }\n      >\n        <div className={`${backgroundClass} ${borderClass}`} ref={inputRef}>\n          <div\n            {...other}\n            className=\"p12 cursor-pointer flex-parent flex-parent--column border-b border-b--1 border--gray-light flex-parent flex-parent--column\"\n          >\n            <Link\n              to={{\n                search: window.location.search,\n                pathname: `/changesets/${changesetId}`\n              }}\n            >\n              <Title\n                properties={properties}\n                wasOpen={this.wasOpen}\n                date={properties.get('date')}\n              />\n              <PrimaryLine\n                reasons={properties.get('reasons')}\n                tags={properties.get('tags')}\n                comment={properties.get('comment')}\n              />\n            </Link>\n            <SecondaryLine\n              changesetId={changesetId}\n              properties={properties}\n              date={properties.get('date')}\n            />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\nimport { Row } from './row';\nimport { SignInButton } from '../changeset/sign_in_button.js';\nimport { elementInViewport } from '../../utils/element_in_view';\nimport { loadingEnhancer } from '../loading_enhancer';\n\ntype propTypes = {\n  currentPage: ?Map<string, *>,\n  activeChangesetId: ?number,\n  pageIndex: number\n};\n\nclass List extends React.Component<void, propTypes, *> {\n  shouldComponentUpdate(nextProps: propTypes) {\n    return (\n      nextProps.activeChangesetId !== this.props.activeChangesetId ||\n      nextProps.currentPage !== this.props.currentPage\n    );\n  }\n\n  handleScroll = (r: HTMLElement) => {\n    if (!r) return;\n    if (!elementInViewport(r)) {\n      r.scrollIntoView({ block: 'end', behavior: 'smooth' });\n    }\n  };\n\n  render() {\n    if (\n      !this.props.token &&\n      ['/about', '/filters', '/user', '/'].includes(this.props.location)\n    ) {\n      return (\n        <div className=\"flex-parent flex-parent--column scroll-styled flex-child--grow py36\">\n          <div className=\"flex-parent flex-parent--column flex-parent--center-cross\">\n            <svg className=\"icon h60 w60 inline-block align-middle pb3\">\n              <use xlinkHref=\"#icon-osm\" />\n            </svg>\n          </div>\n          <div className=\"flex-parent flex-parent--center-main align-center txt-l pt36\">\n            <SignInButton text=\"Sign in with your OpenStreetMap account\" />\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <ul className=\"flex-parent flex-parent--column scroll-styled flex-child--grow\">\n        <div>\n          {this.props.currentPage &&\n            this.props.currentPage.get('features').map((f, k) => (\n              <Row\n                active={f.get('id') === this.props.activeChangesetId}\n                properties={f.get('properties')}\n                changesetId={f.get('id')}\n                inputRef={\n                  f.get('id') === this.props.activeChangesetId // only saves the ref of currently active changesetId\n                    ? this.handleScroll\n                    : null\n                }\n                key={k}\n              />\n            ))}\n        </div>\n      </ul>\n    );\n  }\n}\n\nList = loadingEnhancer(List);\nList = connect((state: RootStateType, props) => ({\n  token: state.auth.get('token')\n}))(List);\n\nexport { List };\n","// @flow\nimport React from 'react';\n\nexport class PageRange extends React.PureComponent {\n  render() {\n    return (\n      <button\n        onClick={this._onClick}\n        disabled={this.props.disabled}\n        className={`flex-child btn btn--s color-gray round bg-gray-faint bg-darken10-on-active bg-darken5-on-hover\n          ${this.props.active && 'is-active '}\n          `}\n      >\n        {typeof this.props.page === 'number'\n          ? this.props.page + 1\n          : <svg className=\"icon icon--s inline-block align-middle \">\n              <use xlinkHref={`#icon-${this.props.page}`} />\n            </svg>}\n      </button>\n    );\n  }\n  _onClick = () => {\n    this.props.getChangesetsPage(this.props.pageIndex);\n  };\n}\n","// @flow\nimport React from 'react';\nimport { Range } from 'immutable';\n\nimport { PageRange } from './page_range';\nimport { PAGE_SIZE } from '../../config/constants';\n\nconst RANGE = 6;\n\nfunction range(start, end) {\n  return Range(start, end).map((k, i) => i + start);\n}\n\nexport function Footer({\n  pageIndex,\n  getChangesetsPage,\n  count\n}: {\n  pageIndex: number,\n  getChangesetsPage: (number, ?boolean) => mixed,\n  count: ?number\n}) {\n  const base = parseInt(pageIndex / RANGE, 10) * RANGE;\n  let maxPageCount = 0;\n  if (count && !Number.isNaN(count)) {\n    maxPageCount = Math.ceil(count / PAGE_SIZE);\n  }\n  return (\n    <footer className=\"hmin55 p12 border-t border--gray-light bg-gray-faint txt-s flex-parent justify--space-around\">\n      <PageRange\n        page={'arrow-left'}\n        pageIndex={pageIndex - 1}\n        disabled={pageIndex - 1 === -1}\n        active={false}\n        getChangesetsPage={getChangesetsPage}\n      />\n      {range(base, Math.min(base + RANGE, maxPageCount)).map(n =>\n        <PageRange\n          key={n}\n          page={n}\n          pageIndex={n}\n          active={n === pageIndex}\n          getChangesetsPage={getChangesetsPage}\n        />\n      )}\n      <PageRange\n        page={'arrow-right'}\n        disabled={pageIndex + 1 >= maxPageCount}\n        pageIndex={pageIndex + 1}\n        active={false}\n        getChangesetsPage={getChangesetsPage}\n      />\n    </footer>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { Dropdown } from '../dropdown';\nimport { Button } from '../button';\nimport numberWithCommas from '../../utils/number_with_commas.js';\nimport filtersConfig from '../../config/filters.json';\n\nexport function Header({\n  filters,\n  handleFilterOrderBy,\n  location,\n  diffLoading,\n  diff,\n  currentPage,\n  reloadCurrentPage\n}: Object) {\n  const valueData = [];\n  const options = filtersConfig.filter(f => f.name === 'order_by')[0].options;\n  if (filters.get('order_by')) {\n    options.forEach(o => {\n      if (filters.getIn(['order_by', 0, 'value']) === o.value) {\n        valueData.push(o);\n      }\n    });\n  }\n  return (\n    <div>\n      <header className=\"px12 hmin36 border-b border--gray-light bg-gray-faint txt-s flex-parent justify--space-between align-items--center\">\n        <Dropdown\n          onAdd={() => {}}\n          onRemove={() => {}}\n          onChange={handleFilterOrderBy}\n          value={valueData}\n          options={filtersConfig.filter(f => f.name === 'order_by')[0].options}\n          display={(valueData[0] && valueData[0].label) || 'Order by'}\n          position=\"left\"\n        />\n        <NavLink\n          activeStyle={{\n            fontWeight: 'bold'\n          }}\n          to={{\n            search: location.search,\n            pathname:\n              location.pathname.indexOf('/filters') > -1 ? '/' : '/filters'\n          }}\n        >\n          <Button className=\"mx3\">\n            Filters {filters.size > 0 && `(${filters.size})`}\n          </Button>\n        </NavLink>\n      </header>\n      <header\n        className={`px12 border-l border-b border-b--1 border--gray-light px12 py6 ${\n          diff > 0 ? 'bg-darken10' : 'bg-gray-faint'\n        } flex-child align-items--center`}\n      >\n        <span className=\"flex-parent flex-parent--row justify--space-between color-gray txt-s txt-bold\">\n          <span>\n            {(currentPage &&\n              numberWithCommas(currentPage.getIn(['count'], 0))) ||\n              0}{' '}\n            changesets.\n          </span>\n          <span className=\"flex-parent flex-parent--row\">\n            {diffLoading ? (\n              <span className=\"loading loading--s inline\" />\n            ) : (\n              <Button\n                className=\"mx3 btn--xs\"\n                iconName=\"rotate\"\n                onClick={reloadCurrentPage}\n              >\n                {diff > 0 ? `${diff} new` : ''}\n              </Button>\n            )}\n          </span>\n        </span>\n      </header>\n    </div>\n  );\n}\n","//@flow\n\nexport default function numberWithCommas(num: number): string {\n  return num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n}\n","// @flow\nimport React from 'react';\nimport { API_URL } from '../../config';\nimport { Map } from 'immutable';\nimport { Dropdown } from '../dropdown';\nimport { cancelablePromise } from '../../utils/promise';\n\n// TOFIX Needs cleanup.\n\nlet cacheTagsData;\nexport class Tags extends React.PureComponent {\n  props: {\n    changesetId: number,\n    disabled: boolean,\n    currentChangeset: Map<string, *>,\n    handleChangesetModifyTag: (number, Map<string, *>, Object, boolean) => mixed\n  };\n\n  state: {\n    options: Array<any>,\n    allTags: Array<any>\n  };\n\n  state = {\n    allTags: {},\n    options: []\n  };\n\n  tagsData = cacheTagsData;\n\n  componentDidMount() {\n    this.getAsyncOptions();\n  }\n\n  getAsyncOptions = () => {\n    if (!this.tagsData) {\n      this.tagsData = cancelablePromise(\n        fetch(`${API_URL}/tags/`).then(response => {\n          return response.json();\n        })\n      );\n    }\n\n    return this.tagsData.promise\n      .then(json => {\n        let data = {};\n        let selectData = json.filter(d => d.is_visible && d.for_changeset);\n\n        selectData.forEach(d => {\n          data[d.name] = { ...d, value: d.id, label: d.name };\n        });\n        this.setState({\n          allTags: data,\n          options: selectData.map(d => ({ label: d.name, value: d.id }))\n        });\n      })\n      .catch(e => {});\n  };\n\n  componentWillUnmount() {\n    if (this.tagsData) {\n      cacheTagsData = this.tagsData;\n      this.tagsData.cancel();\n    }\n  }\n\n  onAdd = (obj: Object) => {\n    if (!obj) return;\n    const {\n      changesetId,\n      currentChangeset,\n      handleChangesetModifyTag\n    } = this.props;\n    handleChangesetModifyTag(changesetId, currentChangeset, obj, false);\n  };\n\n  onRemove = (obj: Object) => {\n    if (!obj) return;\n    const {\n      changesetId,\n      currentChangeset,\n      handleChangesetModifyTag\n    } = this.props;\n    handleChangesetModifyTag(changesetId, currentChangeset, obj, true);\n  };\n\n  defaultValue = new Map();\n\n  render() {\n    if (!this.props.currentChangeset) return null;\n\n    const value = this.props.currentChangeset\n      .getIn(['properties', 'tags'], this.defaultValue)\n      .toJS()\n      .map(t => ({\n        value: t.id,\n        label: t.name\n      }));\n\n    if (this.state.options) {\n      return (\n        <Dropdown\n          eventTypes={['click', 'touchend']}\n          multi\n          onAdd={this.onAdd}\n          onRemove={this.onRemove}\n          disabled={this.props.disabled}\n          className={`${\n            this.props.disabled ? 'cursor-notallowed' : ''\n          } flex-parent mr3`}\n          value={value}\n          options={this.state.options}\n          onChange={() => {}}\n          display={`Tags${value.length > 0 ? ` (${value.length})` : ''}`}\n          position=\"right\"\n        />\n      );\n    } else {\n      return null;\n    }\n  }\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { is, List as ImmutableList, Map, fromJS } from 'immutable';\nimport { push } from 'react-router-redux';\nimport type { RootStateType } from '../store';\n\nimport {\n  getChangesetsPage,\n  checkForNewChangesets\n} from '../store/changesets_page_actions';\n\nimport { applyFilters } from '../store/filters_actions';\n\nimport { List } from '../components/list';\nimport { Footer } from '../components/list/footer';\nimport { Header } from '../components/list/header';\nimport { keyboardToggleEnhancer } from '../components/keyboard_enhancer';\nimport {\n  NEXT_CHANGESET,\n  PREV_CHANGESET,\n  FILTER_BINDING,\n  HELP_BINDING,\n  REFRESH_CHANGESETS\n} from '../config/bindings';\n\ntype propsType = {\n  location: Object,\n  loading: boolean,\n  error: Object,\n  currentPage: ?Map<string, *>,\n  diff: number,\n  diffLoading: boolean,\n  pageIndex: number,\n  activeChangesetId: ?number,\n  filters: Map<string, ImmutableList<*>>,\n  aoiId: ?string,\n  lastKeyStroke: Map<string, *>,\n  getChangesetsPage: (number, ?boolean) => mixed, // base 0\n  checkForNewChangesets: boolean => any,\n  push: Object => mixed,\n  applyFilters: (Map<string, ImmutableList<*>>) => mixed // base 0\n};\n\nclass ChangesetsList extends React.PureComponent<void, propsType, *> {\n  checkUpdate = null;\n  maxPageCount = Infinity;\n\n  // constructor(props: propsType) {\n  //   super(props);\n  //   this.props.getChangesetsPage(props.pageIndex);\n  //   this.checkUpdate = delayPromise(2000);\n  //   this.checkUpdate.promise.then(() => this.props.checkForNewChangesets(true));\n  // }\n  componentWillUnmount() {\n    this.checkUpdate && this.checkUpdate.cancel();\n  }\n\n  goUpDownToChangeset = (direction: number) => {\n    if (!this.props.currentPage) return;\n    let features = this.props.currentPage.get('features');\n    if (features) {\n      let index = features.findIndex(\n        f => f.get('id') === this.props.activeChangesetId\n      );\n      index += direction;\n      const nextFeature = features.get(index);\n      if (nextFeature) {\n        const location = {\n          ...this.props.location, //  clone it\n          pathname: `/changesets/${nextFeature.get('id')}`\n        };\n        this.props.push(location);\n      }\n    }\n  };\n\n  toggleFilters() {\n    if (this.props.location && this.props.location.pathname === '/filters') {\n      const location = {\n        ...this.props.location, //  clone it\n        pathname: '/'\n      };\n      this.props.push(location);\n    } else {\n      const location = {\n        ...this.props.location, //  clone it\n        pathname: '/filters'\n      };\n      this.props.push(location);\n    }\n  }\n\n  toggleHelp() {\n    if (\n      this.props.location &&\n      this.props.location.pathname.startsWith('/about')\n    ) {\n      const location = {\n        ...this.props.location, //  clone it\n        pathname: '/'\n      };\n      this.props.push(location);\n    } else {\n      console.log(...this.props.location);\n      const location = {\n        ...this.props.location, //  clone it\n        pathname: '/about'\n      };\n      this.props.push(location);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: propsType) {\n    const lastKeyStroke: Map<string, *> = nextProps.lastKeyStroke;\n    if (is(this.props.lastKeyStroke, lastKeyStroke)) return;\n    switch (lastKeyStroke.keySeq().first()) {\n      case FILTER_BINDING.label: {\n        this.toggleFilters();\n        break;\n      }\n      case HELP_BINDING.label: {\n        this.toggleHelp();\n        break;\n      }\n      case NEXT_CHANGESET.label: {\n        this.goUpDownToChangeset(1);\n        break;\n      }\n      case PREV_CHANGESET.label: {\n        this.goUpDownToChangeset(-1);\n        break;\n      }\n      case REFRESH_CHANGESETS.label: {\n        this.reloadCurrentPage();\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleFilterOrderBy = (selected: Array<*>) => {\n    let mergedFilters;\n    mergedFilters = this.props.filters.set('order_by', fromJS(selected));\n    this.props.applyFilters(mergedFilters);\n  };\n\n  reloadCurrentPage = () => {\n    this.props.getChangesetsPage(this.props.pageIndex, true);\n  };\n\n  render() {\n    const {\n      filters,\n      currentPage,\n      loading,\n      location,\n      diff,\n      diffLoading,\n      activeChangesetId,\n      pageIndex,\n      getChangesetsPage\n    } = this.props;\n\n    return (\n      <div className=\"flex-parent flex-parent--column changesets-list\">\n        <Header\n          filters={filters}\n          handleFilterOrderBy={this.handleFilterOrderBy}\n          location={location}\n          currentPage={currentPage}\n          diff={diff}\n          diffLoading={diffLoading}\n          reloadCurrentPage={this.reloadCurrentPage}\n        />\n        <List\n          activeChangesetId={activeChangesetId}\n          loading={loading}\n          currentPage={currentPage}\n          pageIndex={pageIndex}\n          location={location.pathname ? location.pathname : null}\n        />\n        <Footer\n          pageIndex={pageIndex}\n          getChangesetsPage={getChangesetsPage}\n          count={currentPage && currentPage.get('count')}\n        />\n      </div>\n    );\n  }\n}\n\nChangesetsList = keyboardToggleEnhancer(\n  false,\n  [\n    NEXT_CHANGESET,\n    PREV_CHANGESET,\n    FILTER_BINDING,\n    HELP_BINDING,\n    REFRESH_CHANGESETS\n  ],\n  ChangesetsList\n);\n\nChangesetsList = connect(\n  (state: RootStateType, props) => ({\n    location: state.routing.location,\n    loading: state.changesetsPage.get('loading'),\n    error: state.changesetsPage.get('error'),\n    currentPage: state.changesetsPage.get('currentPage'),\n    diff: state.changesetsPage.get('diff'),\n    diffLoading: state.changesetsPage.get('diffLoading'),\n    pageIndex: state.changesetsPage.get('pageIndex') || 0,\n    activeChangesetId: state.changeset.get('changesetId'),\n    filters: state.filters.get('filters'),\n    aoiId: state.aoi.get('aoi').get('id')\n  }),\n  {\n    // actions\n    getChangesetsPage,\n    checkForNewChangesets,\n    applyFilters,\n    push\n  }\n)(ChangesetsList);\nexport { ChangesetsList };\n","import React from 'react';\nimport { isMobile } from '../utils';\n\nexport function Navbar({\n  className,\n  title,\n  titleClassName = '',\n  buttons,\n  buttonsClassName = ''\n}) {\n  const mobile = isMobile();\n\n  return (\n    <nav\n      className={`\n        ${mobile ? 'h40' : 'h55 flex-parent--center-cross'}\n        flex-parent px12 py6 bg-gray-dark justify--space-between ${className}\n      `}\n    >\n      <div className={`flex-child flex-child--grow ${titleClassName}`}>\n        {title || ''}\n      </div>\n      <div className={`flex-child ${buttonsClassName}`}>{buttons}</div>\n    </nav>\n  );\n}\n","import React from 'react';\nimport { Dropdown } from '../dropdown';\nimport thumbsUp from '../../assets/thumbs-up.svg';\nimport thumbsDown from '../../assets/thumbs-down.svg';\n\nexport function Verify({\n  changeset,\n  options,\n  className,\n  onChange,\n  value,\n  onClear,\n  username,\n  checkUser\n}) {\n  if (changeset.getIn(['properties', 'checked'])) {\n    const isHarmful = changeset.getIn(['properties', 'harmful']);\n    return (\n      <div\n        className={`flex-parent align-items--center btn btn--s border border--1 round color-gray transition pl12 pr6 ${\n          isHarmful\n            ? 'bg-lighten50 border--red-light'\n            : 'bg-lighten50 border--green-light'\n        }`}\n        style={{ maxWidth: '100px' }}\n      >\n        <img\n          src={isHarmful ? thumbsDown : thumbsUp}\n          alt={`Marked as ${isHarmful ? 'bad' : 'good'}`}\n          className=\"icon inline-block w14 h14\"\n        />\n        <span\n          className=\"ml6\"\n          style={{\n            flex: '1',\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis'\n          }}\n        >\n          {checkUser ? <>{checkUser}</> : <em>Verified</em>}\n        </span>\n        <svg\n          onClick={onClear}\n          className=\"icon inline-block align-middle pl3 w18 h18 pointer color-gray\"\n        >\n          <use xlinkHref=\"#icon-close\" />\n        </svg>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"select-container\">\n      <Dropdown\n        eventTypes={['click', 'touchend']}\n        value={[]}\n        onAdd={() => {}}\n        onRemove={() => {}}\n        options={options}\n        onChange={onChange}\n        display=\"Verify\"\n        position=\"right\"\n      />\n    </div>\n  );\n}\n","import React from 'react';\n\nimport { importChangesetMap } from '../../utils/cmap';\nimport { Dropdown } from '../dropdown';\nimport { isMobile } from '../../utils';\n\nfunction openEditor(selected) {\n  importChangesetMap('getMapInstance')\n    .then(r => r && r() && r().map)\n    .then(map => {\n      let baseUrl;\n      if (selected && selected[0].value === 'iD') {\n        baseUrl = 'https://www.openstreetmap.org/edit?editor=id&';\n      }\n      if (selected && selected[0].value === 'RapiD') {\n        baseUrl = 'https://mapwith.ai/rapid?';\n      }\n      if (baseUrl) {\n        const center = map.getCenter();\n        const zoom = map.getZoom();\n        let windowObjectReference = window.open('editor - OSMCha');\n        windowObjectReference.location.href = `${baseUrl}#map=${zoom}/${center.lat}/${center.lng}`;\n      }\n    });\n}\n\nexport function OpenIn({ display, changesetId, coordinates, className }) {\n  const mobile = isMobile();\n  const options = [\n    {\n      label: 'Achavi',\n      value: 'Achavi',\n      href: `https://overpass-api.de/achavi/?changeset=${changesetId}&relations=true`\n    },\n    {\n      label: 'iD',\n      value: 'iD'\n    },\n    {\n      label: 'JOSM',\n      value: 'JOSM',\n      href: `http://127.0.0.1:8111/import?url=https://www.openstreetmap.org/api/0.6/changeset/${changesetId}/download`\n    },\n    {\n      label: 'Level0',\n      value: 'Level0',\n      href: `http://level0.osmz.ru/?url=changeset/${changesetId}`\n    },\n    {\n      label: 'RapiD',\n      value: 'RapiD'\n    }\n  ];\n  if (mobile) {\n    options.unshift({\n      label: 'OSM.org',\n      value: 'OSM.org',\n      href: `https://www.openstreetmap.org/changeset/${changesetId}`\n    });\n  }\n\n  return (\n    <div className={`select-container ${className}`}>\n      <Dropdown\n        onAdd={() => {}}\n        onRemove={() => {}}\n        value={[]}\n        onChange={openEditor}\n        options={options}\n        display={display}\n        position=\"left\"\n      />\n    </div>\n  );\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { is, Map } from 'immutable';\n\nimport { keyboardToggleEnhancer } from '../components/keyboard_enhancer';\nimport { Tags } from '../components/changeset/tags';\nimport { Navbar } from '../components/navbar';\nimport { Verify } from '../components/changeset/verify';\nimport { OpenIn } from '../components/changeset/open_in';\nimport { isMobile } from '../utils';\n\nimport {\n  VERIFY_BAD,\n  VERIFY_GOOD,\n  VERIFY_CLEAR,\n  OPEN_IN_JOSM,\n  OPEN_IN_ID,\n  OPEN_IN_OSM,\n  OPEN_IN_LEVEL0,\n  OPEN_IN_ACHAVI,\n  OPEN_IN_HDYC\n} from '../config/bindings';\nimport { API_URL } from '../config/index';\n\nimport {\n  handleChangesetModifyTag,\n  handleChangesetModifyHarmful\n} from '../store/changeset_actions';\nimport type { RootStateType } from '../store';\n\ntype propsType = {\n  changesetId: number,\n  location: Object,\n  currentChangeset: Map<string, *>,\n  username: ?string,\n  lastKeyStroke: Map<string, *>,\n  handleChangesetModifyTag: (number, Map<string, *>, Object, boolean) => mixed,\n  handleChangesetModifyHarmful: (number, Map<string, *>, boolean | -1) => mixed\n};\n\nclass NavbarChangeset extends React.PureComponent<void, propsType, *> {\n  componentWillReceiveProps(nextProps: propsType) {\n    if (!this.props.currentChangeset) return;\n    const lastKeyStroke: Map<string, *> = nextProps.lastKeyStroke;\n    if (is(this.props.lastKeyStroke, lastKeyStroke)) return;\n    switch (lastKeyStroke.keySeq().first()) {\n      case VERIFY_BAD.label: {\n        this.props.handleChangesetModifyHarmful(\n          this.props.changesetId,\n          this.props.currentChangeset,\n          true\n        );\n        break;\n      }\n      case VERIFY_CLEAR.label: {\n        this.props.handleChangesetModifyHarmful(\n          this.props.changesetId,\n          this.props.currentChangeset,\n          -1\n        );\n        break;\n      }\n      case VERIFY_GOOD.label: {\n        this.props.handleChangesetModifyHarmful(\n          this.props.changesetId,\n          this.props.currentChangeset,\n          false\n        );\n        break;\n      }\n      case OPEN_IN_JOSM.label: {\n        if (!this.props.changesetId) return;\n        const url = `http://127.0.0.1:8111/import?url=https://www.openstreetmap.org/api/0.6/changeset/${this.props.changesetId}/download`;\n        window.open(url, '_blank');\n        break;\n      }\n      case OPEN_IN_ID.label: {\n        if (!this.props.changesetId || !this.props.currentChangeset) return;\n        const coordinates = this.props.currentChangeset.getIn([\n          'geometry',\n          'coordinates',\n          0,\n          0\n        ]);\n        const url = `https://www.openstreetmap.org/edit?changeset=${\n          this.props.changesetId\n        }#map=15/${coordinates && coordinates.get('1')}/${coordinates &&\n          coordinates.get('0')}`;\n        window.open(url, '_blank');\n        break;\n      }\n      case OPEN_IN_OSM.label: {\n        if (!this.props.changesetId) return;\n        const url = `https://www.openstreetmap.org/changeset/${this.props.changesetId}`;\n        window.open(url, '_blank');\n        break;\n      }\n      case OPEN_IN_LEVEL0.label: {\n        if (!this.props.changesetId) return;\n        const url = `http://level0.osmz.ru/?url=changeset/${this.props.changesetId}`;\n        window.open(url, '_blank');\n        break;\n      }\n      case OPEN_IN_ACHAVI.label: {\n        if (!this.props.changesetId) return;\n        const url = `https://overpass-api.de/achavi/?changeset=${this.props.changesetId}`;\n        window.open(url, '_blank');\n        break;\n      }\n      case OPEN_IN_HDYC.label: {\n        const user: string = this.props.currentChangeset.getIn(\n          ['properties', 'user'],\n          ''\n        );\n        const url = `https://hdyc.neis-one.org/?${user}`;\n        window.open(url, '_blank');\n        break;\n      }\n      default: {\n        return;\n      }\n    }\n  }\n\n  handleVerify = (arr: Array<Object>) => {\n    if (arr.length === 1) {\n      this.props.handleChangesetModifyHarmful(\n        this.props.changesetId,\n        this.props.currentChangeset,\n        arr[0].value // whether harmful is true or false\n      );\n    } else if (arr.length > 1) {\n      throw new Error('verify array is big');\n    }\n  };\n\n  handleVerifyClear = () => {\n    this.props.handleChangesetModifyHarmful(\n      this.props.changesetId,\n      this.props.currentChangeset,\n      -1\n    );\n  };\n\n  isChecked = () =>\n    this.props.currentChangeset &&\n    this.props.currentChangeset.getIn(['properties', 'checked']);\n\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <Navbar\n        className={`bg-gray-faint color-gray border-b border--gray-light border--1 ${\n          mobile ? '' : 'px30'\n        }`}\n        title={\n          <div\n            className={`flex-parent flex-parent--row flex-parent--wrap ${\n              mobile ? 'align-items--center' : ''\n            }`}\n          >\n            {mobile && (\n              <Link\n                to={{\n                  search: window.location.search,\n                  pathname: '/'\n                }}\n                style={mobile ? { fontSize: '1.4em' } : { fontSize: '1.7em' }}\n                className=\"color-gray mr3\"\n              >\n                <button\n                  style={{ fontSize: mobile && '1.1em' }}\n                  className=\"btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition pt0 pb6 pl6 pr6 mr2\"\n                >\n                  ☰\n                </button>{' '}\n              </Link>\n            )}\n            {!mobile && (\n              <>\n                <div className=\"txt-l color-gray--dark\">\n                  <strong>Changeset:</strong> {this.props.changesetId}\n                  <span className=\"mr6\">\n                    <span\n                      className=\"txt--s pl6 pointer\"\n                      onClick={e =>\n                        navigator.clipboard.writeText(\n                          `${API_URL.replace('/api/v1', '')}/changesets/${\n                            this.props.changesetId\n                          }`\n                        )\n                      }\n                      title=\"Copy OSMCha Changeset URL\"\n                    >\n                      <svg className=\"icon icon--s mt-neg3 ml3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition\">\n                        <use xlinkHref=\"#icon-link\" />\n                      </svg>\n                    </span>\n                    <a\n                      href={`https://www.openstreetmap.org/changeset/${this.props.changesetId}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title=\"See on OSM\"\n                    >\n                      <svg className=\"icon icon--s mt-neg3 ml3 inline-block align-middle bg-gray-faint color-darken25 color-darken50-on-hover transition\">\n                        <use xlinkHref=\"#icon-share\" />\n                      </svg>\n                    </a>\n                  </span>\n                </div>\n              </>\n            )}\n            <OpenIn\n              changesetId={this.props.changesetId}\n              coordinates={\n                this.props.currentChangeset &&\n                this.props.currentChangeset.getIn([\n                  'geometry',\n                  'coordinates',\n                  0,\n                  0\n                ])\n              }\n              display={\n                mobile\n                  ? `${this.isChecked() ? '' : 'Changeset'} ${\n                      this.props.changesetId\n                    }`\n                  : 'Open with'\n              }\n            />\n          </div>\n        }\n        buttonsClassName=\"flex-parent\"\n        buttons={\n          this.props.currentChangeset && (\n            <>\n              {this.props.currentChangeset.getIn([\n                'properties',\n                'check_user'\n              ]) && (\n                <Tags\n                  changesetId={this.props.changesetId}\n                  currentChangeset={this.props.currentChangeset}\n                  disabled={false}\n                  handleChangesetModifyTag={this.props.handleChangesetModifyTag}\n                />\n              )}\n              <Verify\n                changeset={this.props.currentChangeset}\n                placeholder=\"Verify\"\n                value={[]}\n                onChange={this.handleVerify}\n                onClear={this.handleVerifyClear}\n                username={this.props.username}\n                checkUser={this.props.currentChangeset.getIn([\n                  'properties',\n                  'check_user'\n                ])}\n                options={[\n                  {\n                    value: false,\n                    label: 'Good'\n                  },\n                  {\n                    value: true,\n                    label: 'Bad'\n                  }\n                ]}\n                className=\"select--s\"\n              />\n            </>\n          )\n        }\n      />\n    );\n  }\n}\n\nNavbarChangeset = keyboardToggleEnhancer(\n  false,\n  [\n    VERIFY_BAD,\n    VERIFY_GOOD,\n    VERIFY_CLEAR,\n    OPEN_IN_JOSM,\n    OPEN_IN_ID,\n    OPEN_IN_OSM,\n    OPEN_IN_LEVEL0,\n    OPEN_IN_ACHAVI,\n    OPEN_IN_HDYC\n  ],\n  NavbarChangeset\n);\n\nNavbarChangeset = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    changesetId: parseInt(state.changeset.get('changesetId'), 10),\n    currentChangeset: state.changeset.getIn([\n      'changesets',\n      parseInt(state.changeset.get('changesetId'), 10)\n    ]),\n    username: state.auth.getIn(['userDetails', 'username'])\n  }),\n  { handleChangesetModifyTag, handleChangesetModifyHarmful }\n)(NavbarChangeset);\n\nexport { NavbarChangeset };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\nimport { Link } from 'react-router-dom';\nimport { push } from 'react-router-redux';\n\nimport { Button } from '../components/button';\nimport { Navbar } from '../components/navbar';\nimport { Dropdown } from '../components/dropdown';\n\nimport { createPopup } from '../utils/create_popup';\nimport { handlePopupCallback, isMobile } from '../utils';\nimport { osmAuthUrl } from '../config/constants';\nimport { isDev, isLocal } from '../config';\n\nimport {\n  getOAuthToken,\n  getFinalToken,\n  logUserOut\n} from '../store/auth_actions';\n\nimport type { RootStateType } from '../store';\n\nclass NavbarSidebar extends React.PureComponent {\n  props: {\n    location: Object,\n    uid: ?string,\n    username: ?string,\n    token: ?string,\n    oAuthToken: ?string,\n    getOAuthToken: () => mixed,\n    getFinalToken: string => mixed,\n    logUserOut: () => mixed,\n    push: any => any\n  };\n\n  handleLoginClick = () => {\n    var oAuthToken = this.props.oAuthToken;\n    if (!oAuthToken) return;\n\n    let url;\n    if (isDev || isLocal) {\n      url = `/local-landing.html#${oAuthToken}`;\n    } else {\n      url = `${osmAuthUrl}?oauth_token=${oAuthToken}`;\n    }\n\n    createPopup('oauth_popup', url);\n    handlePopupCallback().then(oAuthObj => {\n      this.props.getFinalToken(oAuthObj.oauth_verifier);\n    });\n  };\n\n  onUserMenuSelect = (arr: Array<Object>) => {\n    const username = this.props.username;\n    const uid = this.props.uid;\n\n    if (arr.length === 1) {\n      if (arr[0].url === '/logout') {\n        this.props.logUserOut();\n        return;\n      }\n      if (arr[0].url === '/my-changesets') {\n        this.props.push({\n          ...this.props.location,\n          search: `filters={\"uids\":[{\"label\":\"${uid}\",\"value\":\"${uid}\"}],\"date__gte\":[{\"label\":\"\",\"value\":\"\"}]}`,\n          pathname: '/'\n        });\n        return;\n      }\n      if (arr[0].url === '/my-reviews') {\n        this.props.push({\n          ...this.props.location,\n          search: `filters={\"checked_by\":[{\"label\":\"${username}\",\"value\":\"${username}\"}],\"date__gte\":[{\"label\":\"\",\"value\":\"\"}]}`,\n          pathname: '/'\n        });\n        return;\n      }\n      this.props.push({\n        ...this.props.location,\n        search: this.props.location.search,\n        pathname: arr[0].url\n      });\n    } else if (arr.length > 1) {\n      throw new Error('filter select array is big');\n    }\n  };\n\n  renderUserMenuOptions() {\n    const username = this.props.username;\n\n    return (\n      <Dropdown\n        display={\n          username ? (\n            <span className=\"wmax180 align-middle inline-block txt-truncate\">\n              {username}\n            </span>\n          ) : (\n            'User'\n          )\n        }\n        options={[\n          { label: 'Account settings', url: '/user' },\n          {\n            label: 'My Changesets',\n            url: '/my-changesets'\n          },\n          {\n            label: 'My Reviews',\n            url: '/my-reviews'\n          },\n          { label: 'My Saved Filters', url: '/saved-filters' },\n          { label: 'My Teams', url: '/teams' },\n          { label: 'My Trusted Users List', url: '/trusted-users' },\n          { label: 'My Watchlist', url: '/watchlist' },\n          { label: 'Logout', url: '/logout' }\n        ]}\n        onChange={this.onUserMenuSelect}\n        value={[]}\n        onAdd={() => {}}\n        onRemove={() => {}}\n        position=\"right\"\n      />\n    );\n  }\n\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <>\n        <Navbar\n          className=\"navbar-logo bg-gray-faint border-b border--gray-light border--1\"\n          title={\n            <Link\n              to={{\n                search: window.location.search,\n                pathname: '/'\n              }}\n              style={mobile ? { fontSize: '1.4em' } : { fontSize: '1.7em' }}\n              className=\"color-gray\"\n            >\n              <strong className=\"color-blue\">OSM</strong>\n              Cha\n            </Link>\n          }\n          buttons={\n            <div className=\"flex-parent flex-parent--row\">\n              <Link\n                className=\"pr3 pointer\"\n                to={{\n                  search: window.location.search,\n                  pathname: '/about'\n                }}\n              >\n                <svg className=\"icon icon--m inline-block align-middle color-darken25 color-darken50-on-hover transition\">\n                  <use xlinkHref=\"#icon-question\" />\n                </svg>\n              </Link>\n              {this.props.token ? (\n                <div className=\"pointer\">{this.renderUserMenuOptions()}</div>\n              ) : (\n                <Button\n                  onClick={this.handleLoginClick}\n                  disable={!this.props.oAuthToken}\n                  iconName=\"osm\"\n                >\n                  Sign in\n                </Button>\n              )}\n            </div>\n          }\n        />\n      </>\n    );\n  }\n}\n\nNavbarSidebar = connect(\n  (state: RootStateType, props) => ({\n    location: state.routing.location,\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    username: state.auth.getIn(['userDetails', 'username']),\n    uid: state.auth.getIn(['userDetails', 'uid'])\n  }),\n  {\n    getOAuthToken,\n    getFinalToken,\n    logUserOut,\n    push\n  }\n)(NavbarSidebar);\n\nexport { NavbarSidebar };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport Notify from 'react-notification-system';\n\nimport type { RootStateType } from '../store';\n\nimport {\n  dismissModalCallback,\n  activateModalCallback\n} from '../store/modal_actions';\n\nclass Modal extends React.PureComponent {\n  props: {\n    title: ?string,\n    description: ?string,\n    kind: 'error' | 'success',\n    dismiss: ?boolean,\n    autoDismiss: ?boolean,\n    dismissModalCallback: number => any,\n    activateModalCallback: number => any,\n    position: ?string,\n    callbackLabel: ?string,\n    error: Object,\n    uid: number\n  };\n  static defaultProps = {\n    title: 'Error',\n    description: 'Oops there was a problem. Please reload the app.',\n    autoDismiss: 5,\n    dismiss: true,\n    position: 'tr',\n    kind: 'error'\n  };\n  ref = null;\n  componentDidMount() {\n    if (this.props.error) {\n      this.sendNotification(this.props);\n    }\n  }\n  componentWillUpdate(nextProps: Object) {\n    this.sendNotification(nextProps);\n  }\n  sendNotification = nextProps => {\n    const uid = nextProps.uid;\n    if (!this.ref) return;\n    this.ref.addNotification({\n      uid,\n      title: nextProps.title,\n      message:\n        (nextProps.error && nextProps.error.message) || nextProps.description,\n      level: nextProps.kind,\n      autoDismiss: nextProps.autoDismiss,\n      position: nextProps.position,\n      dismissible: nextProps.dismiss,\n      action: nextProps.callbackLabel && {\n        label: nextProps.callbackLabel,\n        callback: () => nextProps.activateModalCallback(uid)\n      },\n      onRemove: () => {\n        nextProps.dismissModalCallback(uid);\n      }\n    });\n  };\n  addRef = r => {\n    this.ref = r;\n  };\n  render() {\n    return <Notify ref={this.addRef} />;\n  }\n}\nModal = connect(\n  (state: RootStateType) => ({\n    error: state.modal.get('error'),\n    callback: state.modal.get('callback'),\n    callbackLabel: state.modal.get('callbackLabel'),\n    title: state.modal.get('title'),\n    description: state.modal.get('description'),\n    dismiss: state.modal.get('dismiss'),\n    position: state.modal.get('position'),\n    autoDismiss: state.modal.get('autoDismiss'),\n    kind: state.modal.get('kind'),\n    uid: state.modal.get('uid')\n  }),\n  { dismissModalCallback, activateModalCallback }\n)(Modal);\n\nexport { Modal };\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\n\nimport { Button } from '../button';\nimport { applyUpdateUserDetails } from '../../store/auth_actions';\nimport type { RootStateType } from '../../store';\nimport thumbsUp from '../../assets/thumbs-up.svg';\nimport thumbsDown from '../../assets/thumbs-down.svg';\n\nclass EditUserDetails extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      message_good: props.userDetails.get('message_good'),\n      message_bad: props.userDetails.get('message_bad'),\n      comment_feature: props.userDetails.get('comment_feature')\n    };\n  }\n  componentWillReceiveProps(nextProps) {\n    this.setState({ message_good: nextProps.userDetails.get('message_good') });\n    this.setState({ message_bad: nextProps.userDetails.get('message_bad') });\n    this.setState({\n      comment_feature: nextProps.userDetails.get('comment_feature')\n    });\n  }\n  onChangeMessageGood = (event: any) => {\n    this.setState({ message_good: event.target.value });\n  };\n  onChangeMessageBad = (event: any) => {\n    this.setState({ message_bad: event.target.value });\n  };\n  handleSubmit = event => {\n    this.props.applyUpdateUserDetails(\n      this.state.message_good,\n      this.state.message_bad,\n      this.state.comment_feature\n    );\n  };\n  renderGoodBadImg(isGood) {\n    return (\n      <img\n        src={isGood ? thumbsUp : thumbsDown}\n        alt={`${isGood ? 'good' : 'bad'}`}\n        className=\"icon inline-block mt3\"\n      />\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <span className=\"ml12 flex-parent flex-parent--row my3 pt12\">\n          <p className=\"flex-child txt-m\">\n            Default comment for changesets reviewed as GOOD{' '}\n            {this.renderGoodBadImg(true)}:\n          </p>\n        </span>\n        <textarea\n          placeholder=\"Define a default message to the changesets you review as good. You can edit it before post a comment.\"\n          className=\"textarea ml12\"\n          value={this.state.message_good}\n          onChange={this.onChangeMessageGood}\n        />\n        <span className=\"ml12 flex-parent flex-parent--row my3 pt18\">\n          <p className=\"flex-child txt-m\">\n            Default comment for changesets reviewed as BAD{' '}\n            {this.renderGoodBadImg()}:\n          </p>\n        </span>\n        <textarea\n          placeholder=\"Define a default message to the changesets you review as bad. You can edit it before post a comment.\"\n          className=\"textarea ml12\"\n          value={this.state.message_bad}\n          onChange={this.onChangeMessageBad}\n        />\n        <Button className=\"input wmax180 ml12 mt6\" onClick={this.handleSubmit}>\n          Save Preferences\n        </Button>\n      </div>\n    );\n  }\n}\nEditUserDetails = connect(\n  (state: RootStateType, props) => ({\n    userDetails: state.auth.getIn(['userDetails'], Map())\n  }),\n  {\n    applyUpdateUserDetails\n  }\n)(EditUserDetails);\n\nexport { EditUserDetails };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\nimport { push } from 'react-router-redux';\n\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport type { filtersType } from '../components/filters';\nimport { Avatar } from '../components/avatar';\nimport { Button } from '../components/button';\nimport { EditUserDetails } from '../components/user/details';\nimport { isMobile } from '../utils';\nimport type { RootStateType } from '../store';\n\ntype propsType = {\n  avatar: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  filters: filtersType,\n  userDetails: Map<string, any>,\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any\n};\nclass User extends React.PureComponent<any, propsType, any> {\n  state = {\n    userValues: null\n  };\n  onUserChange = (value: ?Array<Object>) => {\n    if (Array.isArray(value) && value.length === 0)\n      return this.setState({ userValues: null });\n    this.setState({\n      userValues: value\n    });\n  };\n  render() {\n    const userDetails = this.props.userDetails;\n    const mobile = isMobile();\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <header className=\"h55 hmin55 flex-parent px30 bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1\">\n          <span className=\"txt-l txt-bold color-gray--dark\">\n            <span>Account Settings</span>\n          </span>\n\n          <span className=\"txt-l color-gray--dark\">\n            <Button\n              onClick={this.props.logUserOut}\n              className=\"bg-white-on-hover\"\n            >\n              Logout\n            </Button>\n          </span>\n        </header>\n        <div className=\"px30 flex-child  pb60  filters-scroll\">\n          <span className=\"flex-parent flex-parent--row align justify--space-between  mr6 txt-bold mt24\">\n            <Avatar size={72} url={this.props.avatar} />\n            <span\n              className=\"flex-child flex-child--grow pl24  pt18\"\n              style={{ alignSelf: 'center' }}\n            >\n              <h2 className=\"txt-xl\">\n                Welcome,{' '}\n                {userDetails.get('username')\n                  ? userDetails.get('username')\n                  : 'stranger'}\n                !\n              </h2>\n              <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n            </span>\n          </span>\n          <div className=\"flex-parent flex-parent--column align justify--space-between\">\n            <h2 className=\"pl12 txt-xl mr6 txt-bold mt24 mb12 border-b border--gray-light border--1\">\n              Info\n            </h2>\n            <span className=\"ml12 flex-parent flex-parent--row my3\">\n              <p className=\"flex-child txt-bold w120\">OSMCha ID: </p>\n              <p className=\"flex-child\">{userDetails.get('id')}</p>\n            </span>\n            <span className=\"ml12 flex-parent flex-parent--row my3\">\n              <p className=\"flex-child txt-bold w120\">OSM ID: </p>\n              <p className=\"flex-child\">{userDetails.get('uid')}</p>\n            </span>\n            <span className=\"ml12 flex-parent flex-parent--row my3\">\n              <p className=\"flex-child txt-bold w120\">Username: </p>\n              <p className=\"flex-child\">{userDetails.get('username')}</p>\n            </span>\n            {userDetails.get('is_staff') && (\n              <span className=\"ml12 flex-parent flex-parent--row my3\">\n                <p className=\"flex-child txt-bold w120\">Staff: </p>\n                <p className=\"flex-child\">Yes</p>\n              </span>\n            )}\n            <span className=\"ml12 flex-parent flex-parent--row my3\">\n              <p className=\"flex-child txt-bold w120\">API key: </p>\n              <p className=\"flex-child\">\n                <span className=\"pre pb6 pt6\">Token {this.props.token}</span>\n                <div\n                  className=\"txt--s pl6 pointer inline\"\n                  onClick={e =>\n                    navigator.clipboard.writeText(`Token ${this.props.token}`)\n                  }\n                  title=\"Copy Authorization Token\"\n                >\n                  <svg className=\"icon icon--m mt-neg3 inline-block align-middle color-darken25 color-darken50-on-hover transition\">\n                    <use xlinkHref=\"#icon-clipboard\" />\n                  </svg>\n                </div>\n              </p>\n            </span>\n\n            {this.props.token && (\n              <div>\n                <div className=\"mt24 mb12\">\n                  <h2 className=\"pl12 txt-xl mr6 txt-bold border-b border--gray-light border--1\">\n                    Review Comments Template\n                  </h2>\n                  <EditUserDetails />\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nUser = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    changesetId: parseInt(state.changeset.get('changesetId'), 10),\n    currentChangeset: state.changeset.getIn([\n      'changesets',\n      parseInt(state.changeset.get('changesetId'), 10)\n    ]),\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map()),\n    avatar: state.auth.getIn(['userDetails', 'avatar'])\n  }),\n  {\n    logUserOut,\n    modal,\n    push\n  }\n)(User);\n\nexport { User };\n","import React from 'react';\n\nimport { isMobile } from '../utils';\nimport { Avatar } from './avatar';\n\nexport function SecondaryPagesHeader({ title, avatar }) {\n  const mobile = isMobile();\n\n  return (\n    <header\n      className={`h55 hmin55 flex-parent ${\n        mobile ? 'px12' : 'px30'\n      } bg-gray-faint flex-parent--center-cross justify--space-between color-gray border-b border--gray-light border--1`}\n    >\n      <span className=\"txt-l txt-bold color-gray--dark\">\n        <span className=\"fl\">\n          <Avatar size={36} url={avatar} />\n        </span>\n        <span className=\"pl6 line45\">{title}</span>\n      </span>\n    </header>\n  );\n}\n","import React from 'react';\n\nexport function CustomURL({\n  href,\n  children,\n  iconName,\n  className,\n  title\n}: Object) {\n  return (\n    <a\n      href={href}\n      className={`${className ||\n        ''} btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken5 bg-lighten25-on-hover color-gray transition`}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      title={title}\n    >\n      {iconName && (\n        <svg className={'icon txt-m mb3 inline-block align-middle'}>\n          <use xlinkHref={`#icon-${iconName}`} />\n        </svg>\n      )}\n      {children}\n    </a>\n  );\n}\n","import React from 'react';\n\nexport const BlockMarkup = ({ children }) => (\n  <div className=\"flex-child flex-child--grow bg-gray-faint mx12 round p12 my6\">\n    <div className=\"flex-parent flex-parent--row justify--space-between\">\n      {children}\n    </div>\n  </div>\n);\n","// @flow\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport { push } from 'react-router-redux';\nimport { connect } from 'react-redux';\nimport { Map, List } from 'immutable';\n\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport { applyFilters } from '../store/filters_actions';\nimport { cancelablePromise, isMobile } from '../utils';\nimport { fetchAllAOIs } from '../network/aoi';\nimport { createAOI, deleteAOI } from '../network/aoi';\nimport { withFetchDataSilent } from '../components/fetch_data_enhancer';\nimport { SecondaryPagesHeader } from '../components/secondary_pages_header';\nimport { Button } from '../components/button';\nimport { CustomURL } from '../components/customURL';\nimport { BlockMarkup } from '../components/user/block_markup';\nimport type { filtersType } from '../components/filters';\nimport type { RootStateType } from '../store';\nimport { API_URL } from '../config';\n\nclass SaveButton extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editing: false\n    };\n  }\n  ref;\n  clicked = false;\n  onClick = event => {\n    this.clicked = true;\n    this.setState({ editing: true });\n  };\n  onChange = (event: any) => {\n    this.setState({ value: event.target.value });\n  };\n  onKeyDown = event => {\n    if (event.keyCode === 13) {\n      this.setState({\n        editing: false\n      });\n      this.props.onCreate(this.state.value);\n    } else if (event.keyCode === 27) {\n      this.setState({\n        editing: false\n      });\n      this.clicked = false;\n    }\n  };\n\n  onSave = event => {\n    this.setState({\n      editing: false\n    });\n    this.props.onCreate(this.state.value);\n  };\n\n  render() {\n    return (\n      <span>\n        {this.state.editing ? (\n          <span className=\"flex-parent flex-parent--row \">\n            <input\n              placeholder={this.props.placeholder}\n              className=\"input wmax120 ml12\"\n              ref={r => {\n                if (this.clicked) {\n                  r && r.select();\n                  this.clicked = false;\n                }\n              }}\n              value={this.state.value}\n              onChange={this.onChange}\n              onKeyDown={this.onKeyDown}\n            />\n            <Button className=\"input wmax120 ml6\" onClick={this.onSave}>\n              Save\n            </Button>\n          </span>\n        ) : (\n          <Button className=\"input wmax120 ml12 mt12\" onClick={this.onClick}>\n            Save Filter\n          </Button>\n        )}\n      </span>\n    );\n  }\n}\n\nconst AOIsBlock = ({ data, activeAoiId, removeAoi }) => (\n  <BlockMarkup>\n    <Link\n      className=\"mx3\"\n      to={{\n        search: `aoi=${data.getIn(['id'])}`,\n        pathname: '/filters'\n      }}\n    >\n      <span className=\"txt-bold\">\n        {data.getIn(['properties', 'name'])}\n        {activeAoiId === data.getIn(['id']) && (\n          <span class=\"ml12 btn btn--s px6 py0 bg-darken25 events-none\">\n            Active\n          </span>\n        )}\n      </span>\n    </Link>\n    <span>\n      <CustomURL\n        href={`${API_URL}/aoi/${data.getIn(['id'])}/changesets/feed/`}\n        className=\"mr3\"\n        iconName=\"rss\"\n      >\n        RSS Feed\n      </CustomURL>\n      <Button\n        className=\"mr3 bg-transparent border--0\"\n        onClick={() => removeAoi(data.getIn(['id']))}\n      >\n        <svg className={'icon txt-m mb3 inline-block align-middle color-gray'}>\n          <use xlinkHref=\"#icon-trash\" />\n        </svg>\n        Delete\n      </Button>\n    </span>\n  </BlockMarkup>\n);\n\nconst ListFortified = ({\n  onAdd,\n  onRemove,\n  data,\n  TargetBlock,\n  propsToPass,\n  SaveComp\n}) => (\n  <div>\n    {data.map((e, i) => (\n      <TargetBlock key={i} data={e} {...propsToPass} />\n    ))}\n    {SaveComp}\n  </div>\n);\n\ntype propsType = {\n  avatar: ?string,\n  aoiId: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  filters: filtersType,\n  userDetails: Map<string, any>,\n  applyFilters: (filtersType, path?: string) => mixed, // base\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any\n};\nclass SavedFilters extends React.PureComponent<any, propsType, any> {\n  createAOIPromise;\n  state = {\n    userValues: null\n  };\n  componentWillUnmount() {\n    this.createAOIPromise && this.createAOIPromise.cancel();\n  }\n\n  addToWatchList = ({ username, uid }: { username: string, uid: string }) => {\n    if (!username || !uid) return;\n    this.props.addToWatchlist({ username, uid });\n  };\n  removeFromWatchList = (uid: number) => {\n    if (!uid) return;\n    this.props.removeFromWatchlist(uid);\n  };\n  addToTrustedList = ({ username }: { username: string }) => {\n    if (!username) return;\n    this.props.addToTrustedlist(username);\n  };\n  removeFromTrustedList = (username: string) => {\n    if (!username) return;\n    this.props.removeFromTrustedlist(username);\n  };\n  // aoi\n  loadAoiId = (aoiId: ?string) => {\n    if (!aoiId) return;\n    this.props.push({\n      ...this.props.location,\n      search: `aoi=${aoiId}`,\n      path: '/filters'\n    });\n  };\n  createAOI = (name: string) => {\n    if (name === '' || !name) return;\n    this.createAOIPromise = cancelablePromise(\n      createAOI(this.props.token, name, this.props.filters)\n    );\n\n    this.createAOIPromise.promise\n      .then(r => r && this.loadAoiId(r.id))\n      .catch(e => console.error(e));\n  };\n  removeAOI = (aoiId: string) => {\n    if (!aoiId) return;\n    deleteAOI(this.props.token, aoiId)\n      .then(r => {\n        if (aoiId === this.props.aoiId) {\n          this.props.applyFilters(new Map(), '/user');\n        } else {\n          // const location = {\n          //   ...this.props.location, //  clone it\n          //   pathname: '/user'\n          // };\n          this.props.reloadData();\n        }\n        this.props.modal({\n          kind: 'success',\n          title: 'Filter Deleted ',\n          description: `The ${aoiId} was deleted`\n        });\n      })\n      .catch(e => {\n        this.props.reloadData();\n        this.props.modal({\n          kind: 'error',\n          title: 'Deletion failed ',\n          error: e\n        });\n      });\n  };\n  onUserChange = (value: ?Array<Object>) => {\n    if (Array.isArray(value) && value.length === 0)\n      return this.setState({ userValues: null });\n    this.setState({\n      userValues: value\n    });\n  };\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <SecondaryPagesHeader\n          title=\"Saved Filters\"\n          avatar={this.props.avatar}\n        />\n        <div className=\"px30 flex-child  pb60  filters-scroll\">\n          <div className=\"flex-parent flex-parent--column align justify--space-between\">\n            {this.props.token && (\n              <div>\n                <div className=\"mt24 mb12\">\n                  <ListFortified\n                    data={this.props.data.getIn(['aoi', 'features'], List())}\n                    TargetBlock={AOIsBlock}\n                    propsToPass={{\n                      activeAoiId: this.props.aoiId,\n                      removeAoi: this.removeAOI\n                    }}\n                    SaveComp={<SaveButton onCreate={this.createAOI} />}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n/**\n * Never use props not required by the Basecomponent in HOCs\n */\nSavedFilters = withFetchDataSilent(\n  (props: propsType) => ({\n    aoi: cancelablePromise(fetchAllAOIs(props.token))\n  }),\n  (nextProps: propsType, props: propsType) => true,\n  SavedFilters\n);\n\nSavedFilters = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    filters: state.filters.get('filters'),\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map()),\n    avatar: state.auth.getIn(['userDetails', 'avatar']),\n    aoiId: state.aoi.getIn(['aoi', 'id'], null)\n  }),\n  {\n    applyFilters,\n    logUserOut,\n    modal,\n    push\n  }\n)(SavedFilters);\n\nexport { SavedFilters };\n","// @flow\nimport React from 'react';\nimport { Button } from '../button';\nimport { handleErrors } from '../../network/aoi';\n\nexport class WatchListUser extends React.Component {\n  state = {\n    username: '',\n    uid: '',\n    isValidUsername: true,\n    isValidUid: true,\n    verified: false\n  };\n  setUsername = (event: any) => {\n    const target = event.target;\n    const value = target.value;\n    this.setState({ username: value, isValidUsername: true, verified: false });\n  };\n  setUid = (event: any) => {\n    const target = event.target;\n    const value = target.value;\n    this.setState({ uid: value, isValidUid: true, verified: false });\n  };\n  fetchUsername = (username: string) =>\n    fetch(\n      `https://www.openstreetmap.org/api/0.6/changesets.json?display_name=${this.state.username}`\n    )\n      .then(handleErrors)\n      .then(r => r.json())\n      .then(r => {\n        try {\n          return r.changesets[0].uid;\n        } catch (e) {\n          handleErrors();\n        }\n      });\n\n  fetchUid = (uid: string) =>\n    fetch(`https://www.openstreetmap.org/api/0.6/user/${uid}.json`)\n      .then(handleErrors)\n      .then(r => r.json());\n\n  verifyInput = () => {\n    if (this.state.uid.length > 0 && this.state.username.length === 0) {\n      this.fetchUid(this.state.uid)\n        .then(r => ({\n          uid: r.user.id.toString(),\n          username: r.user.display_name\n        }))\n        .then(r =>\n          this.setState({\n            username: r.username,\n            uid: r.uid,\n            verified: true,\n            isValidUsername: true,\n            isValidUid: true\n          })\n        )\n        .catch(r => this.setState({ isValidUid: false, verified: false }));\n    } else if (this.state.username.length > 0 && this.state.uid.length === 0) {\n      this.fetchUsername(this.state.username)\n        .then(r => ({\n          uid: r.toString(),\n          username: this.state.username\n        }))\n        .then(x => {\n          return x;\n        })\n        .then(r =>\n          this.setState({\n            username: r.username,\n            uid: r.uid,\n            verified: true,\n            isValidUsername: true,\n            isValidUid: true\n          })\n        )\n        .catch(r => this.setState({ isValidUsername: false, verified: false }));\n    } else if (this.state.uid.length > 0 && this.state.username.length > 0) {\n      Promise.all([\n        this.fetchUid(this.state.uid).then(r => ({\n          uid: r.id,\n          username: r.name\n        })),\n        this.fetchUsername(this.state.username).then(r => ({\n          uid: r.id,\n          username: r.name\n        }))\n      ])\n        .then(resp => {\n          if (\n            resp[0].uid === resp[1].uid &&\n            resp[0].username === resp[1].username\n          ) {\n            window.alert('The user is valid');\n            this.setState({ verified: true });\n          } else {\n            this.setState({ isValidUsername: false, isValidUid: false });\n          }\n        })\n        .catch(e =>\n          this.setState({ isValidUsername: false, isValidUid: false })\n        );\n    }\n  };\n  onAdd = () => {\n    const username = this.state.username;\n    const uid = this.state.uid;\n    if (username && username.length > 0 && uid && uid.length > 0) {\n      this.props.onSave(username, uid);\n    } else {\n      this.setState({ isValidUsername: false, isValidUid: false });\n    }\n  };\n\n  render() {\n    const errorClass = 'border border--1 border--red';\n    return (\n      <span className=\"flex-parent flex-parent--row\">\n        <input\n          className={`input ${this.state.isValidUsername ? '' : errorClass}`}\n          style={{ marginRight: '6px !important' }}\n          value={this.state.username}\n          onChange={this.setUsername}\n          placeholder=\"Username\"\n          type=\"text\"\n        />\n        <input\n          className={`input ${this.state.isValidUid ? '' : errorClass}`}\n          value={this.state.uid}\n          onChange={this.setUid}\n          placeholder=\"UID\"\n          type=\"text\"\n        />\n        <Button\n          className={'wmax180 ml12 bg-transparent border--0'}\n          onClick={this.verifyInput}\n        >\n          {this.state.verified ? 'Verified' : 'Verify'}\n        </Button>\n        <Button\n          className={`btn wmax120 ml12 ${\n            this.state.verified ? 'btn--green' : ''\n          }`}\n          onClick={this.onAdd}\n        >\n          Add\n        </Button>\n      </span>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { Button } from '../button';\n\nexport class TrustedListUser extends React.Component {\n  state = {\n    username: ''\n  };\n\n  onAdd = () => {\n    const username = this.state.username;\n    if (username && username.length > 0) {\n      this.props.onSave(username);\n      this.setState({ username: '' });\n    }\n  };\n\n  render() {\n    return (\n      <span className=\"flex-parent flex-parent--row\">\n        <input\n          className=\"input\"\n          onChange={e => this.setState({ username: e.target.value })}\n          placeholder=\"Username\"\n          type=\"text\"\n        />\n        <Button className=\"btn wmax120 ml12\" onClick={this.onAdd}>\n          Add\n        </Button>\n      </span>\n    );\n  }\n}\n","import React from 'react';\n\nimport { Button } from '../button';\nimport { WatchListUser } from './watchlist_user';\nimport { TrustedListUser } from './trustedlist_user';\n\nexport class SaveUser extends React.PureComponent {\n  state = {\n    showInput: false\n  };\n  onSave = (username, uid) => {\n    if (this.props.forWatchlist) {\n      if (!username || !uid) return;\n      this.props.onCreate({ username, uid });\n      this.setState({ showInput: false });\n    } else {\n      if (!username) return;\n      this.props.onCreate({ username });\n      this.setState({ showInput: false });\n    }\n  };\n  render() {\n    return (\n      <span>\n        {this.state.showInput ? (\n          <span className=\"flex-parent flex-parent--row \">\n            {this.props.forWatchlist ? (\n              <WatchListUser onSave={this.onSave} />\n            ) : (\n              <TrustedListUser onSave={this.onSave} />\n            )}\n          </span>\n        ) : (\n          <Button\n            className=\"input wmax120 ml12 mt12\"\n            onClick={() => this.setState({ showInput: true })}\n          >\n            <svg className={'icon txt-m mb3 inline-block align-middle'}>\n              <use xlinkHref=\"#icon-plus\" />\n            </svg>\n            Add User\n          </Button>\n        )}\n      </span>\n    );\n  }\n}\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map, List } from 'immutable';\nimport { push } from 'react-router-redux';\nimport { Link } from 'react-router-dom';\n\nimport { getObjAsQueryParam, isMobile } from '../utils';\nimport { BlockMarkup } from '../components/user/block_markup';\nimport { SaveUser } from '../components/user/save_user';\nimport { SecondaryPagesHeader } from '../components/secondary_pages_header';\nimport {\n  addToTrustedlist,\n  removeFromTrustedlist\n} from '../store/trustedlist_actions';\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport { Button } from '../components/button';\nimport type { RootStateType } from '../store';\n\nconst TrustedListBlock = ({ data, removeFromTrustedList }) => (\n  <BlockMarkup>\n    <span>\n      <span>{data}</span>\n    </span>\n    <span>\n      <Link\n        className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n        to={{\n          search: getObjAsQueryParam('filters', {\n            users: [\n              {\n                label: data,\n                value: data\n              }\n            ]\n          })\n        }}\n      >\n        Changesets\n      </Link>\n      <Button\n        className=\"mr3 bg-transparent border--0\"\n        onClick={() => removeFromTrustedList(data)}\n      >\n        <svg className={'icon txt-m mb3 inline-block align-middle'}>\n          <use xlinkHref=\"#icon-trash\" />\n        </svg>\n        Remove\n      </Button>\n    </span>\n  </BlockMarkup>\n);\n\nconst ListFortified = ({\n  onAdd,\n  onRemove,\n  data,\n  TargetBlock,\n  propsToPass,\n  SaveComp\n}) => (\n  <div>\n    {data.map((e, i) => (\n      <TargetBlock key={i} data={e} {...propsToPass} />\n    ))}\n    {SaveComp}\n  </div>\n);\n\ntype propsType = {\n  avatar: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  userDetails: Map<string, any>,\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any,\n  trustedList: Map<string, *>,\n  addToTrustedlist: string => void,\n  removeFromTrustedlist: string => void\n};\nclass TrustedUsers extends React.PureComponent<any, propsType, any> {\n  state = {\n    userValues: null\n  };\n  addToTrustedList = ({ username }: { username: string }) => {\n    if (!username) return;\n    this.props.addToTrustedlist(username);\n  };\n  removeFromTrustedList = (username: string) => {\n    if (!username) return;\n    this.props.removeFromTrustedlist(username);\n  };\n  onUserChange = (value: ?Array<Object>) => {\n    if (Array.isArray(value) && value.length === 0)\n      return this.setState({ userValues: null });\n    this.setState({\n      userValues: value\n    });\n  };\n\n  render() {\n    let trustedUsers = this.props.trustedList ? this.props.trustedList : List();\n    trustedUsers = trustedUsers.sortBy(\n      a => a,\n      (a: string, b: string) => a.localeCompare(b)\n    );\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white${\n          mobile ? ' viewport-full' : ''\n        }`}\n      >\n        <SecondaryPagesHeader\n          title=\"Trusted Users\"\n          avatar={this.props.avatar}\n        />\n        <div className=\"px30 flex-child  pb60  filters-scroll\">\n          <div className=\"flex-parent flex-parent--column align justify--space-between\">\n            {this.props.token && (\n              <div>\n                <div className=\"mt24 mb12\">\n                  <ListFortified\n                    data={trustedUsers}\n                    TargetBlock={TrustedListBlock}\n                    propsToPass={{\n                      removeFromTrustedList: this.removeFromTrustedList\n                    }}\n                    SaveComp={<SaveUser onCreate={this.addToTrustedList} />}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nTrustedUsers = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    trustedList: state.trustedlist.get('trustedlist'),\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map()),\n    avatar: state.auth.getIn(['userDetails', 'avatar'])\n  }),\n  {\n    logUserOut,\n    modal,\n    push,\n    addToTrustedlist,\n    removeFromTrustedlist\n  }\n)(TrustedUsers);\n\nexport { TrustedUsers };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map, List } from 'immutable';\nimport { push } from 'react-router-redux';\nimport { Link } from 'react-router-dom';\n\nimport { getObjAsQueryParam, isMobile } from '../utils';\nimport { BlockMarkup } from '../components/user/block_markup';\nimport { SaveUser } from '../components/user/save_user';\nimport {\n  addToWatchlist,\n  removeFromWatchlist\n} from '../store/watchlist_actions';\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport { Button } from '../components/button';\nimport { SecondaryPagesHeader } from '../components/secondary_pages_header';\nimport type { RootStateType } from '../store';\n\nconst WatchListBlock = ({ data, removeFromWatchList }) => (\n  <BlockMarkup>\n    <span>\n      <span>{data.getIn(['username'])}</span>\n      <span className=\"txt-em color-gray pl6\">({data.getIn(['uid'])})</span>\n    </span>\n    <span>\n      <Link\n        className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n        to={{\n          search: getObjAsQueryParam('filters', {\n            users: [\n              {\n                label: data.getIn(['username']),\n                value: data.getIn(['username'])\n              }\n            ]\n          })\n        }}\n      >\n        Changesets\n      </Link>\n      <Button\n        className=\"mr3 bg-transparent border--0\"\n        onClick={() => removeFromWatchList(data.getIn(['uid']))}\n      >\n        <svg className={'icon txt-m mb3 inline-block align-middle'}>\n          <use xlinkHref=\"#icon-trash\" />\n        </svg>\n        Remove\n      </Button>\n    </span>\n  </BlockMarkup>\n);\n\nconst ListFortified = ({\n  onAdd,\n  onRemove,\n  data,\n  TargetBlock,\n  propsToPass,\n  SaveComp\n}) => (\n  <div>\n    {data.map((e, i) => (\n      <TargetBlock key={i} data={e} {...propsToPass} />\n    ))}\n    {SaveComp}\n  </div>\n);\n\ntype propsType = {\n  avatar: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  userDetails: Map<string, any>,\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any,\n  watchlisted: Map<object, *>,\n  addToWatchlist: string => void,\n  removeFromWatchlist: string => void\n};\nclass Watchlist extends React.PureComponent<any, propsType, any> {\n  state = {\n    userValues: null\n  };\n  // blacklist\n  addToWatchList = ({ username, uid }: { username: string, uid: string }) => {\n    if (!username || !uid) return;\n    this.props.addToWatchlist({ username, uid });\n  };\n  removeFromWatchList = (uid: number) => {\n    if (!uid) return;\n    this.props.removeFromWatchlist(uid);\n  };\n  onUserChange = (value: ?Array<Object>) => {\n    if (Array.isArray(value) && value.length === 0)\n      return this.setState({ userValues: null });\n    this.setState({\n      userValues: value\n    });\n  };\n  render() {\n    let watchList = this.props.watchlisted ? this.props.watchlisted : List();\n    watchList = watchList.sortBy(\n      a => a.get('username'),\n      (a: string, b: string) => a.localeCompare(b)\n    );\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white ${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <SecondaryPagesHeader title=\"Watchlist\" avatar={this.props.avatar} />\n        <div\n          className={`${\n            mobile ? 'px12' : 'px30'\n          } flex-child pb60 filters-scroll`}\n        >\n          <div className=\"flex-parent flex-parent--column align justify--space-between\">\n            {this.props.token && (\n              <div>\n                <div className=\"mt24 mb12\">\n                  <ListFortified\n                    data={watchList}\n                    TargetBlock={WatchListBlock}\n                    propsToPass={{\n                      removeFromWatchList: this.removeFromWatchList\n                    }}\n                    SaveComp={\n                      <SaveUser\n                        onCreate={this.addToWatchList}\n                        forWatchlist={true}\n                      />\n                    }\n                  />\n                </div>\n              </div>\n            )}\n            {this.props.token && (\n              <span>\n                <Link\n                  className=\"input wmax180 ml12 btn btn--s border border--1 border--lighten25 border--lighten50-on-hover round bg-darken5 bg-lighten25-on-hover color-gray transition\"\n                  to={{\n                    search: getObjAsQueryParam('filters', {\n                      blacklist: [{ label: 'Yes', value: 'True' }]\n                    })\n                  }}\n                >\n                  <svg className={'icon txt-m mb3 inline-block align-middle'}>\n                    <use xlinkHref=\"#icon-filter\" />\n                  </svg>\n                  Watchlist's changesets\n                </Link>\n              </span>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nWatchlist = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    watchlisted: state.watchlist.get('watchlist'),\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map()),\n    avatar: state.auth.getIn(['userDetails', 'avatar'])\n  }),\n  {\n    logUserOut,\n    modal,\n    push,\n    addToWatchlist,\n    removeFromWatchlist\n  }\n)(Watchlist);\n\nexport { Watchlist };\n","import { API_URL } from '../config';\nimport { handleErrors } from './aoi';\n\nexport function createMappingTeam(token: string, name: string, users: string) {\n  return fetch(`${API_URL}/mapping-team/`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      name,\n      users\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function fetchMappingTeam(token: string, id: number) {\n  return fetch(`${API_URL}/mapping-team/${id}/`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\nexport function deleteMappingTeam(token: string, id: number) {\n  return fetch(`${API_URL}/mapping-team/${id}/`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  }).then(handleErrors);\n}\n\nexport function fetchUserMappingTeams(token: string, owner: string) {\n  return fetch(`${API_URL}/mapping-team/?owner=${owner}`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function fetchTrustedMappingTeams(token: string) {\n  return fetch(`${API_URL}/mapping-team/?trusted=true`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    }\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n\nexport function updateMappingTeam(\n  token: string,\n  id: number,\n  name: ?string,\n  users: ?object\n) {\n  return fetch(`${API_URL}/mapping-team/${id}`, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: token ? `Token ${token}` : ''\n    },\n    body: JSON.stringify({\n      name,\n      users\n    })\n  })\n    .then(handleErrors)\n    .then(res => {\n      return res.json();\n    });\n}\n","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { format } from 'date-fns';\nimport DatePicker from 'react-datepicker';\nimport 'react-datepicker/dist/react-datepicker.css';\n\nimport { Button } from '../button';\n\nconst NewTeam = props => {\n  const [teamName, setTeamName] = useState('');\n  const [teamUsers, setTeamUsers] = useState([{}]);\n  const [editing, setEditing] = useState(props.editing || false);\n  const [validationErrorMessage, setValidationErrorMessage] = useState('');\n\n  useEffect(() => {\n    if (props.activeTeam) {\n      setTeamName(props.activeTeam.get('name'));\n      let users = [];\n      props.activeTeam.get('users').map(user =>\n        users.push({\n          username: user.get('username'),\n          uid: user.get('uid'),\n          joined: user.get('joined'),\n          left: user.get('left')\n        })\n      );\n      let cleanedUsers = [];\n      users.forEach((user, k) => {\n        let u = Object.fromEntries(\n          Object.entries(user).filter(([_, v]) => v !== undefined)\n        );\n        cleanedUsers.push(u);\n      });\n      setTeamUsers([...cleanedUsers]);\n    }\n  }, [props.activeTeam]);\n\n  const onClickRemoveUser = idx => {\n    let teamUsersToUpdate = [...teamUsers];\n    teamUsersToUpdate.splice(idx, 1);\n    setTeamUsers(teamUsersToUpdate);\n  };\n\n  const onClickAddAnotherUser = () => setTeamUsers([...teamUsers, {}]);\n\n  const onChangeInput = (property, value, idx) => {\n    let teamUsersToUpdate = [...teamUsers];\n    teamUsersToUpdate[idx] = { ...teamUsersToUpdate[idx], [property]: value };\n    setTeamUsers(teamUsersToUpdate);\n  };\n\n  const validateData = () => {\n    if (!teamName) {\n      return { valid: false, error: 'Team name cannot be empty.' };\n    }\n    if (teamUsers) {\n      try {\n        if (\n          teamUsers.filter(i => i.hasOwnProperty('username')).length ===\n          teamUsers.length\n        ) {\n          return { valid: true };\n        } else {\n          return {\n            valid: false,\n            error: 'The username field should not be empty.'\n          };\n        }\n      } catch (err) {\n        return {\n          valid: false,\n          error: 'Verify if there is some wrong user information.'\n        };\n      }\n    } else {\n      return { valid: false, error: 'Users cannot be empty' };\n    }\n  };\n\n  const onSave = e => {\n    const validation = validateData();\n\n    if (validation.valid) {\n      if (props.activeTeam) {\n        props.onChange(props.activeTeam.get('id'), teamName, teamUsers);\n        setValidationErrorMessage('');\n      } else {\n        props.onCreate(teamName, teamUsers);\n        setEditing(false);\n        setValidationErrorMessage('');\n      }\n    } else {\n      setValidationErrorMessage(validation.error);\n    }\n  };\n\n  return (\n    <div className=\"px12\">\n      {editing ? (\n        <>\n          {props.activeTeam ? (\n            <></>\n          ) : (\n            <h3 className=\"txt-h4 txt-bold pt12\">Add a new mapping team</h3>\n          )}\n          <>\n            <label className=\"txt-truncate pt6 txt-bold\">\n              Name<span className=\"color-red txt-s\">*</span>\n              <input\n                required\n                placeholder=\"New team name\"\n                className=\"input wmax180 mx3\"\n                value={teamName}\n                onChange={e => setTeamName(e.target.value)}\n                disabled={!props.userIsOwner}\n              />\n            </label>\n            <strong className=\"txt-truncate pt6\">Users</strong>\n            {teamUsers.map((user, k) => (\n              <form key={k} className=\"grid mb3\">\n                <label className=\"px3 col w-1/5\">\n                  Username<span className=\"color-red txt-s\">*</span>\n                  <input\n                    className=\"input\"\n                    type=\"text\"\n                    required\n                    id=\"username\"\n                    placeholder=\"Username\"\n                    value={user.username || ''}\n                    onChange={e =>\n                      onChangeInput(e.target.id, e.target.value, k)\n                    }\n                    disabled={!props.userIsOwner}\n                  />\n                </label>\n                <label className=\"px3 col w-1/5\">\n                  UID\n                  <input\n                    className=\"input\"\n                    type=\"text\"\n                    id=\"uid\"\n                    placeholder=\"User UID\"\n                    value={user.uid || ''}\n                    onChange={e =>\n                      onChangeInput(e.target.id, e.target.value, k)\n                    }\n                    disabled={!props.userIsOwner}\n                  />\n                </label>\n                <label className=\"px3 col w-1/5\">\n                  <span className=\"block\">Joined the team</span>\n                  <DatePicker\n                    className=\"input block date-width-full\"\n                    dateFormat=\"yyyy-MM-dd\"\n                    isClearable={true}\n                    placeholderText=\"When user joined the team\"\n                    selected={user.joined ? Date.parse(user.joined) : null}\n                    onChange={date =>\n                      onChangeInput(\n                        'joined',\n                        date ? format(date, 'yyyy-MM-dd') : null,\n                        k\n                      )\n                    }\n                    disabled={!props.userIsOwner}\n                  />\n                </label>\n                <label className=\"px3 col w-1/5\">\n                  Left the team\n                  <DatePicker\n                    className=\"input block date-width-full\"\n                    dateFormat=\"yyyy-MM-dd\"\n                    isClearable={true}\n                    placeholderText=\"When user left the team\"\n                    selected={user.left ? Date.parse(user.left) : null}\n                    onChange={date =>\n                      onChangeInput(\n                        'left',\n                        date ? format(date, 'yyyy-MM-dd') : null,\n                        k\n                      )\n                    }\n                    disabled={!props.userIsOwner}\n                  />\n                </label>\n                <div className=\"px3\">\n                  <br />\n                  <Button\n                    disabled={teamUsers.length === 1}\n                    onClick={e => {\n                      e.preventDefault();\n                      onClickRemoveUser(k);\n                    }}\n                    className=\"mt3 bg-transparent border--0 col w-1/5\"\n                    title=\"Remove user\"\n                  >\n                    <svg className=\"icon w24 h24\">\n                      <use xlinkHref=\"#icon-trash\" />\n                    </svg>\n                  </Button>\n                </div>\n              </form>\n            ))}\n            <Button className=\"mt6 mb2\" onClick={onClickAddAnotherUser}>\n              <svg className=\"icon txt-m mb3 inline-block align-middle\">\n                <use xlinkHref=\"#icon-plus\" />\n              </svg>\n              Add user\n            </Button>\n\n            <p className=\"txt-light txt-truncate pt6\">\n              The mapping team members are <strong>public</strong> and can be\n              visualized by any logged in OSMCha user.\n            </p>\n\n            {validationErrorMessage && (\n              <span className=\"flex-parent flex-parent--row mt12 color-red-dark txt-bold\">\n                {validationErrorMessage}\n              </span>\n            )}\n\n            <span className=\"flex-parent flex-parent--row mt12\">\n              {props.userIsOwner && (\n                <Button className=\"input wmax120\" onClick={onSave}>\n                  Save\n                </Button>\n              )}\n              {props.activeTeam ? (\n                <Link\n                  to={{ pathname: '/teams' }}\n                  className=\"input mx3 wmax120 bg-transparent border--white btn btn--s border--1-on-hover border--darken5 border--darken25-on-hover round bg-darken5-on-hover color-gray transition\"\n                >\n                  Back to teams\n                </Link>\n              ) : (\n                <Button\n                  className=\"input wmax120 ml6\"\n                  onClick={() => setEditing(false)}\n                >\n                  Cancel\n                </Button>\n              )}\n            </span>\n          </>\n        </>\n      ) : (\n        <>\n          <Button\n            className=\"input wmax120 mt12\"\n            onClick={() => setEditing(true)}\n          >\n            <svg className={'icon txt-m mb3 inline-block align-middle'}>\n              <use xlinkHref=\"#icon-plus\" />\n            </svg>\n            New team\n          </Button>\n        </>\n      )}\n    </div>\n  );\n};\n\nNewTeam.propTypes = {\n  teamUsers: PropTypes.arrayOf(PropTypes.object),\n  teamName: PropTypes.string,\n  editing: PropTypes.bool,\n  validationErrorMessage: PropTypes.string,\n  onClickRemoveUser: PropTypes.func,\n  onClickAddAnotherUser: PropTypes.func,\n  onChangeInput: PropTypes.func,\n  onSave: PropTypes.func,\n  validateData: PropTypes.func\n};\n\nexport default NewTeam;\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map, List } from 'immutable';\nimport { push } from 'react-router-redux';\n\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport { cancelablePromise, isMobile } from '../utils';\nimport {\n  createMappingTeam,\n  fetchUserMappingTeams,\n  deleteMappingTeam\n} from '../network/mapping_team';\nimport { Link } from 'react-router-dom';\nimport { withFetchDataSilent } from '../components/fetch_data_enhancer';\nimport { Button } from '../components/button';\nimport { SecondaryPagesHeader } from '../components/secondary_pages_header';\nimport { BlockMarkup } from '../components/user/block_markup';\nimport type { RootStateType } from '../store';\n\nimport NewTeam from '../components/teams/new_team';\n\nexport type teamsOptionsType = Map<'label' | 'value', ?string>;\nexport type teamType = List<filterOptionsType>;\nexport type teamsType = Map<string, filterType>;\n\nconst TeamsBlock = ({ data, removeTeam, editTeam }) => (\n  <BlockMarkup>\n    <span>\n      <span>{data.get('name')}</span>\n    </span>\n    <span>\n      <Link\n        className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken10 bg-darken5-on-hover color-gray transition\"\n        to={{\n          search: `filters={\"mapping_teams\":[{\"label\":\"${data.getIn([\n            'name'\n          ])}\",\"value\":\"${data.getIn(['name'])}\"}]}`,\n          pathname: '/filters'\n        }}\n      >\n        Changesets\n      </Link>\n      <Link\n        className=\"mx3 btn btn--s border border--1 border--darken5 border--darken25-on-hover round bg-darken5 bg-lighten25-on-hover color-gray transition\"\n        to={{ pathname: `/teams/${data.getIn(['id'])}` }}\n      >\n        Edit\n      </Link>\n      <Button\n        className=\"mr3 bg-transparent border--0\"\n        onClick={() => removeTeam(data.getIn(['id']))}\n      >\n        <svg className={'icon txt-m mb3 inline-block align-middle'}>\n          <use xlinkHref=\"#icon-trash\" />\n        </svg>\n        Delete\n      </Button>\n    </span>\n  </BlockMarkup>\n);\n\nconst ListFortified = ({\n  onAdd,\n  onRemove,\n  data,\n  TargetBlock,\n  propsToPass,\n  SaveComp\n}) => (\n  <div>\n    {data.map((e, i) => (\n      <TargetBlock key={i} data={e} {...propsToPass} />\n    ))}\n    {SaveComp}\n  </div>\n);\n\ntype propsType = {\n  avatar: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  userDetails: Map<string, any>,\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any\n};\n\nclass MappingTeams extends React.PureComponent<any, propsType, any> {\n  createTeamPromise;\n  state = {\n    userValues: null,\n    addingTeam: false\n  };\n\n  componentWillUnmount() {\n    this.createTeamPromise && this.createTeamPromise.cancel();\n  }\n\n  createTeam = (name: string, users: object) => {\n    if (name === '' || !name || !users) return;\n    this.setState({ addingTeam: true });\n    this.createTeamPromise = cancelablePromise(\n      createMappingTeam(this.props.token, name, users)\n    );\n    this.createTeamPromise.promise\n      .then(r => {\n        this.props.modal({\n          kind: 'success',\n          title: 'Team Created ',\n          description: `The team ${name} was created successfully!`\n        });\n        this.props.reloadData();\n        this.setState({ addingTeam: false });\n      })\n      .catch(e => console.error(e));\n  };\n\n  removeTeam = (teamId: string) => {\n    if (!teamId) return;\n    deleteMappingTeam(this.props.token, teamId)\n      .then(r => {\n        this.props.modal({\n          kind: 'success',\n          title: 'Team Deleted ',\n          description: `The team with id ${teamId} was deleted`\n        });\n        this.props.reloadData();\n      })\n      .catch(e => {\n        this.props.reloadData();\n        this.props.modal({\n          kind: 'error',\n          title: 'Deletion failed ',\n          error: e\n        });\n      });\n  };\n\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <SecondaryPagesHeader\n          title=\"Teams\"\n          avatar={this.props.userDetails.get('avatar')}\n        />\n        <div className=\"px30 flex-child  pb60  filters-scroll\">\n          <div className=\"flex-parent flex-parent--column align justify--space-between\">\n            {this.props.token && (\n              <div>\n                <div className=\"mt24 mb12\">\n                  <ListFortified\n                    data={this.props.data.getIn(['teams'], List())}\n                    TargetBlock={TeamsBlock}\n                    propsToPass={{\n                      removeTeam: this.removeTeam\n                    }}\n                    SaveComp={\n                      <NewTeam\n                        onCreate={this.createTeam}\n                        editing={this.state.addingTeam}\n                        userIsOwner={true}\n                      />\n                    }\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n/**\n * Never use props not required by the Basecomponent in HOCs\n */\nMappingTeams = withFetchDataSilent(\n  (props: propsType) => ({\n    teams: cancelablePromise(\n      fetchUserMappingTeams(props.token, props.userDetails.get('username'))\n    )\n  }),\n  (nextProps: propsType, props: propsType) => true,\n  MappingTeams\n);\n\nMappingTeams = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map())\n  }),\n  {\n    modal,\n    logUserOut,\n    push\n  }\n)(MappingTeams);\n\nexport { MappingTeams };\n","// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { Map } from 'immutable';\nimport { push } from 'react-router-redux';\n\nimport { modal } from '../store/modal_actions';\nimport { logUserOut } from '../store/auth_actions';\nimport { cancelablePromise } from '../utils/promise';\nimport {\n  fetchMappingTeam,\n  updateMappingTeam,\n  deleteMappingTeam\n} from '../network/mapping_team';\nimport { withFetchDataSilent } from '../components/fetch_data_enhancer';\nimport { SecondaryPagesHeader } from '../components/secondary_pages_header';\nimport { SignIn } from '../components/sign_in';\nimport type { RootStateType } from '../store';\nimport NewTeam from '../components/teams/new_team';\nimport { isMobile } from '../utils';\n\ntype propsType = {\n  avatar: ?string,\n  token: string,\n  data: Map<string, any>,\n  location: Object,\n  userDetails: Map<string, any>,\n  reloadData: () => any,\n  logUserOut: () => any,\n  push: any => any,\n  modal: any => any\n};\nclass EditMappingTeam extends React.PureComponent<any, propsType, any> {\n  updateTeamPromise;\n  state = {\n    userValues: null\n  };\n\n  componentWillUnmount() {\n    this.createTeamPromise && this.createTeamPromise.cancel();\n  }\n\n  editTeam = (id: string, name: string, users: object) => {\n    if (name === '' || !name || !users) return;\n    this.updateTeamPromise = cancelablePromise(\n      updateMappingTeam(this.props.token, id, name, users)\n    );\n    this.updateTeamPromise.promise\n      .then(r => {\n        this.props.modal({\n          kind: 'success',\n          title: 'Team Updated ',\n          description: `The team ${name} was updated successfully!`\n        });\n        this.props.reloadData();\n      })\n      .catch(e => {\n        this.props.modal({\n          kind: 'error',\n          title: 'Update failed ',\n          error: e\n        });\n        console.error(e);\n      });\n  };\n\n  removeTeam = (teamId: string) => {\n    if (!teamId) return;\n    deleteMappingTeam(this.props.token, teamId)\n      .then(r => {\n        this.props.modal({\n          kind: 'success',\n          title: 'Team Deleted ',\n          description: `The team with id ${teamId} was deleted`\n        });\n        this.props.reloadData();\n      })\n      .catch(e => {\n        this.props.reloadData();\n        this.props.modal({\n          kind: 'error',\n          title: 'Deletion failed ',\n          error: e\n        });\n      });\n  };\n\n  render() {\n    const mobile = isMobile();\n\n    return (\n      <div\n        className={`flex-parent flex-parent--column changesets-filters bg-white${\n          mobile ? 'viewport-full' : ''\n        }`}\n      >\n        <SecondaryPagesHeader\n          title=\"Edit team\"\n          avatar={this.props.userDetails.get('avatar')}\n        />\n        {this.props.token ? (\n          <div className=\"px30 flex-child  pb60  filters-scroll\">\n            <div className=\"flex-parent flex-parent--column align justify--space-between\">\n              <div>\n                <div className=\"mt24 mb12\">\n                  <h2 className=\"pl12 txt-xl mr6 border-b border--gray-light border--1\">\n                    <strong>Editing mapping team: </strong>\n                    {this.props.data.getIn(['team', 'name'])}\n                  </h2>\n                  <NewTeam\n                    onChange={this.editTeam}\n                    editing={true}\n                    activeTeam={this.props.data.get('team')}\n                    userIsOwner={\n                      this.props.data.getIn(['team', 'owner']) ===\n                      this.props.userDetails.get('username')\n                    }\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <SignIn />\n        )}\n      </div>\n    );\n  }\n}\n/**\n * Never use props not required by the Basecomponent in HOCs\n */\nEditMappingTeam = withFetchDataSilent(\n  (props: propsType) => ({\n    team: cancelablePromise(fetchMappingTeam(props.token, props.teamId))\n  }),\n  (nextProps: propsType, props: propsType) => true,\n  EditMappingTeam\n);\n\nEditMappingTeam = connect(\n  (state: RootStateType, props) => ({\n    location: props.location,\n    teamId: parseInt(props.match.params.id, 10),\n    oAuthToken: state.auth.get('oAuthToken'),\n    token: state.auth.get('token'),\n    userDetails: state.auth.getIn(['userDetails'], Map())\n  }),\n  {\n    modal,\n    logUserOut,\n    push\n  }\n)(EditMappingTeam);\n\nexport { EditMappingTeam };\n","import React from 'react';\nimport { Route } from 'react-router-dom';\n\nimport { Changeset } from './views/changeset';\nimport { About } from './views/about';\nimport { Stats } from './views/stats';\nimport { Filters } from './views/filters';\nimport { ChangesetsList } from './views/changesets_list';\nimport { CMap } from './views/map';\nimport { NavbarChangeset } from './views/navbar_changeset';\nimport { NavbarSidebar } from './views/navbar_sidebar';\n// import { Home } from './views/home';\nimport { Modal } from './views/modal';\nimport { User } from './views/user';\nimport { SavedFilters } from './views/saved_filters';\nimport { TrustedUsers } from './views/trusted_users';\nimport { Watchlist } from './views/watchlist';\nimport { MappingTeams } from './views/teams';\nimport { EditMappingTeam } from './views/edit_team';\n\nexport const AppMobile = () => {\n  return (\n    <>\n      <div className=\"col\">\n        <NavbarSidebar />\n        <Route exact path=\"/\" component={ChangesetsList} />\n        <Route path=\"/changesets\" component={NavbarChangeset} />\n        <Route\n          path=\"/changesets\"\n          // Need to use render to avoid unmounting of\n          // CMap Ref: https://reacttraining.com/react-router/web/api/Route/render-func\n          // CMap and views/changeset.js are clubbed so they can be\n          // loaded on demand in future.\n          render={() => <CMap className=\"z0 fixed bottom right\" />}\n        />\n        <Route path={'/changesets/:id'} component={Changeset} />\n        <Route path=\"/about\" component={About} />\n        <Route path=\"/stats\" component={Stats} />\n        <Route path=\"/filters\" component={Filters} />\n        <Route path=\"/user\" component={User} />\n        <Route path=\"/saved-filters\" component={SavedFilters} />\n        <Route path=\"/trusted-users\" component={TrustedUsers} />\n        <Route path=\"/watchlist\" component={Watchlist} />\n        <Route exact path=\"/teams\" component={MappingTeams} />\n        <Route path={'/teams/:id'} component={EditMappingTeam} />\n      </div>\n      <Modal />\n    </>\n  );\n};\n","// @flow\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { appVersion, isDev, isStaging, isLocal } from '../config';\nimport banner from '../assets/banner.png';\nimport work_flow from '../assets/work_flow.png';\n\nexport function Home() {\n  return (\n    <div className=\"flex-parent flex-parent--column flex-parent--center-cross h-full\">\n      <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n      <div className=\"flex-parent flex-parent--column flex-parent--center-cross \">\n        <img src={banner} className=\"osmcha-logo\" alt=\"OSMCHA\" />\n        <img\n          src={work_flow}\n          className=\"pt36 workflow-img\"\n          alt=\"Validation tool for OpenStreetmap\"\n        />\n      </div>\n      <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n      <div className=\"flex-parent flex-parent--column align-center txt-l\">\n        <div className=\"txt-xl\">\n          v{appVersion}\n          {isDev && ' Dev'}\n          {isStaging && ' Staging'}\n          {isLocal && ' Local'}\n        </div>\n        <div className=\"flex-parent flex-parent--row flex-parent--center-main\">\n          <Link\n            className=\"link link--gray flex-parent flex-parent--row flex-parent--center-cross mx6\"\n            to=\"/about\"\n          >\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-info\" />\n            </svg>{' '}\n            <span>Guide</span>\n          </Link>{' '}\n          |{' '}\n          <a\n            target=\"__blank\"\n            className=\"link link--gray  flex-parent flex-parent--row flex-parent--center-cross mx6\"\n            href=\"https://github.com/mapbox/osmcha-frontend/blob/master/CONTRIBUTING.md\"\n          >\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-github\" />\n            </svg>{' '}\n            <span>GitHub</span>\n          </a>{' '}\n          |{' '}\n          <a\n            target=\"__blank\"\n            className=\"link link--gray  flex-parent flex-parent--row flex-parent--center-cross mx6\"\n            href=\"https://github.com/mapbox/osmcha-frontend/issues\"\n          >\n            <svg className=\"icon\">\n              <use xlinkHref=\"#icon-bug\" />\n            </svg>{' '}\n            <span>File an issue</span>\n          </a>\n        </div>\n      </div>\n      <div className=\"flex-child flex-child--grow\">&nbsp;</div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { Route } from 'react-router-dom';\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup';\n\nimport { Changeset } from './views/changeset';\nimport { About } from './views/about';\nimport { Stats } from './views/stats';\nimport { Filters } from './views/filters';\nimport { ChangesetsList } from './views/changesets_list';\nimport { CMap } from './views/map';\nimport { NavbarChangeset } from './views/navbar_changeset';\nimport { NavbarSidebar } from './views/navbar_sidebar';\nimport { Home } from './views/home';\nimport { Modal } from './views/modal';\nimport { User } from './views/user';\nimport { SavedFilters } from './views/saved_filters';\nimport { TrustedUsers } from './views/trusted_users';\nimport { Watchlist } from './views/watchlist';\nimport { MappingTeams } from './views/teams';\nimport { EditMappingTeam } from './views/edit_team';\n\nexport const AppDesktop = () => {\n  return (\n    <>\n      <div className=\"grid\">\n        <div className=\"col col--3-mxl col--4-ml bg-gray--faint border-r border--gray-light border--1\">\n          <NavbarSidebar />\n          <ChangesetsList />\n        </div>\n        <div className=\"col col--9-mxl col--8-ml col--12-mm\">\n          <Route\n            render={({ location }) => (\n              <CSSTransitionGroup\n                transitionName=\"filters\"\n                transitionEnterTimeout={300}\n                transitionLeaveTimeout={300}\n              >\n                <Route exact path=\"/\" component={Home} />\n                <Route\n                  location={location}\n                  path=\"/filters\"\n                  component={Filters}\n                  key={location.key}\n                />\n                <Route path=\"/changesets\" component={NavbarChangeset} />\n                <Route\n                  path=\"/changesets\"\n                  // Need to use render to avoid unmounting of\n                  // CMap Ref: https://reacttraining.com/react-router/web/api/Route/render-func\n                  // CMap and views/changeset.js are clubbed so they can be\n                  // loaded on demand in future.\n                  render={() => <CMap className=\"z0 fixed bottom right\" />}\n                />\n                <Route path=\"/changesets/:id\" component={Changeset} />\n                <Route path=\"/about\" component={About} />\n                <Route path=\"/stats\" component={Stats} />\n                <Route path=\"/user\" component={User} />\n                <Route exact path=\"/teams\" component={MappingTeams} />\n                <Route path=\"/teams/:id\" component={EditMappingTeam} />\n                <Route path=\"/saved-filters\" component={SavedFilters} />\n                <Route path=\"/trusted-users\" component={TrustedUsers} />\n                <Route path=\"/watchlist\" component={Watchlist} />\n              </CSSTransitionGroup>\n            )}\n          />\n        </div>\n      </div>\n      <Modal />\n    </>\n  );\n};\n","// @flow\nimport React, { Component } from 'react';\nimport { Map } from 'immutable';\n\nimport { isMobile } from './utils';\nimport { AppMobile } from './AppMobile';\nimport { AppDesktop } from './AppDesktop';\n\nimport { gaPageView } from './utils/analytics';\nimport { getSearchObj } from './utils/query_params';\n\nexport class App extends Component {\n  resize = null;\n  componentDidMount() {\n    if (document && document.body) {\n      var filters = getSearchObj(window.location.search).getIn(\n        ['filters'],\n        Map()\n      );\n      if (filters && filters.size > 0) {\n        filters = filters\n          .keySeq()\n          .sort((a, b) => a.localeCompare(b))\n          .join(',');\n        gaPageView({\n          page: `/?filters=${filters}`,\n          title: 'Filters',\n          hitType: 'pageview'\n        });\n      } else {\n        gaPageView({ page: '/', title: 'Home', hitType: 'pageview' });\n      }\n    }\n  }\n  render() {\n    const mobile = isMobile();\n    if (mobile) {\n      return <AppMobile />;\n    } else {\n      return <AppDesktop />;\n    }\n  }\n}\n","// @flow\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ConnectedRouter } from 'react-router-redux';\nimport { Provider } from 'react-redux';\nimport ReactGA from 'react-ga4';\nimport Raven from 'raven-js';\nimport { history } from './store/history';\nimport { store } from './store';\nimport { isDev, stack, appVersion } from './config';\nimport { unregisterServiceWorker } from './serviceworker';\n\nimport './assets/index.css';\nimport 'animate.css/animate.css';\nimport '@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw.css';\nimport 'react-select/dist/react-select.css';\n\nimport { App } from './app';\n\nReactGA.initialize([\n  {\n    trackingId: 'G-05Y4GLDM03',\n    gaOptions: {\n      anonymizeIp: true,\n      screenResolution: `${window.screen.availWidth}X${window.screen.availHeight}`,\n      appName: stack\n    }\n  }\n]);\n\nif (process.env.NODE_ENV === 'production') {\n  Raven.config('https://5637ef87f5794e2fb9e1e5fe9119688d@sentry.io/175926', {\n    release: appVersion,\n    environment: process.env.NODE_ENV,\n    debug: isDev\n  }).install();\n}\n// if (process.env.NODE_ENV !== 'production') {\n// const { whyDidYouUpdate } = require('why-did-you-update');\n// whyDidYouUpdate(React);\n// }\nReactDOM.render(\n  <Provider store={store}>\n    <ConnectedRouter history={history}>\n      <App />\n    </ConnectedRouter>\n  </Provider>,\n  document.getElementById('root')\n);\nunregisterServiceWorker();\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nexport function registerServiceWorker() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n      navigator.serviceWorker\n        .register(swUrl)\n        .then(registration => {\n          registration.onupdatefound = () => {\n            const installingWorker = registration.installing;\n            installingWorker.onstatechange = () => {\n              if (installingWorker.state === 'installed') {\n                if (navigator.serviceWorker.controller) {\n                  // At this point, the old content will have been purged and\n                  // the fresh content will have been added to the cache.\n                  // It's the perfect time to display a \"New content is\n                  // available; please refresh\" message in your web app.\n                  const r = window.confirm(\n                    'New version of OSMCha is available. Would you like to reload?'\n                  );\n                  if (r) {\n                    window.location.reload();\n                  }\n                } else {\n                  // At this point, everything has been precached.\n                  // It's the perfect time to display a\n                  // \"Content is cached for offline use.\" message.\n                  console.log('Content is cached for offline use.');\n                }\n              }\n            };\n          };\n        })\n        .catch(error => {\n          console.error('Error during service worker registration:', error);\n        });\n    });\n  }\n}\n\nexport function unregisterServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","module.exports = __webpack_public_path__ + \"static/media/thumbs-up.13d765c5.svg\";","module.exports = __webpack_public_path__ + \"static/media/thumbs-down.7e04a82a.svg\";","module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gIcSUNDX1BST0ZJTEUAAQEAAAIMbGNtcwIQAABtbnRyUkdCIFhZWiAH3AABABkAAwApADlhY3NwQVBQTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLWxjbXMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApkZXNjAAAA/AAAAF5jcHJ0AAABXAAAAAt3dHB0AAABaAAAABRia3B0AAABfAAAABRyWFlaAAABkAAAABRnWFlaAAABpAAAABRiWFlaAAABuAAAABRyVFJDAAABzAAAAEBnVFJDAAABzAAAAEBiVFJDAAABzAAAAEBkZXNjAAAAAAAAAANjMgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0ZXh0AAAAAElYAABYWVogAAAAAAAA9tYAAQAAAADTLVhZWiAAAAAAAAADFgAAAzMAAAKkWFlaIAAAAAAAAG+iAAA49QAAA5BYWVogAAAAAAAAYpkAALeFAAAY2lhZWiAAAAAAAAAkoAAAD4QAALbPY3VydgAAAAAAAAAaAAAAywHJA2MFkghrC/YQPxVRGzQh8SmQMhg7kkYFUXdd7WtwegWJsZp8rGm/fdPD6TD////bAEMAAgMDAwQDBAUFBAYGBgYGCAgHBwgIDQkKCQoJDRMMDgwMDgwTERQRDxEUER4YFRUYHiMdHB0jKiUlKjUyNUVFXP/bAEMBAgMDAwQDBAUFBAYGBgYGCAgHBwgIDQkKCQoJDRMMDgwMDgwTERQRDxEUER4YFRUYHiMdHB0jKiUlKjUyNUVFXP/AABEIAEAAQAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AP2YooooAKKz7u8ito9z9T0UdSa4eXWb1z8pCD0Az+poA9IorzeLWb1D8xDj0Ix+oruLS8iuY9ydR1U9QaANCiiigAooooA8v1Scy3snPCHaPwrHq3d/8fU//XRv51UoAK2NLnMV7Hzw52n8ax6t2n/H1B/10X+dAHrtFFFABRRTHdEUszBQO5OBQBwOs2jJOZgPlfr7N/8AXrmK9En1ixAK4MgPUAcH8689JBY4GBk4FADa6fRrRnnExHyp092/+tXNAgMMjIyMivQoNYsSAuDGB0BHA/KgDpKKYjo6hlYMD3ByKfQBmX17Haxbjyx4VfU/4V5rcXM1w+6Rs+g7D6CtLWJGe+cHogCj+dYVABRRRQAUUUUAW7e5mt33Rtj1HY/UV6VY3sd1FuHDDhl9D/hXlVbujyMl8gHRwVP86AP/2Q==\""],"sourceRoot":""}